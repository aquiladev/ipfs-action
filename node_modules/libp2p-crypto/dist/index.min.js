(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2pCrypto = factory()}(typeof self !== 'undefined' ? self : this, function () {
var Libp2pCrypto=(()=>{var ya=Object.defineProperty;var lu=t=>ya(t,"__esModule",{value:!0});var X=(t,e)=>()=>(t&&(e=t(t=0)),e);var C=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),At=(t,e)=>{lu(t);for(var r in e)ya(t,r,{get:e[r],enumerable:!0})};var gr=C(ga=>{"use strict";ga.get=(t=globalThis)=>{let e=t.crypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var va=C((ny,xa)=>{"use strict";xa.exports={SHA1:20,SHA256:32,SHA512:64}});var Qn=C(ba=>{"use strict";var ma=gr(),pu=va(),du={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},yu=async(t,e)=>{let r=await ma.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,r.byteOffset,r.byteLength)};ba.create=async function(t,e){let r=du[t],n=await ma.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return yu(n,i)},length:pu[t]}}});var Z=C((ay,wa)=>{wa.exports={options:{usePureJavaScript:!1}}});var Ba=C((sy,Ea)=>{var Xn={};Ea.exports=Xn;var Sa={};Xn.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=gu(t,e);else{var i=0,a=e.length,s=e.charAt(0),o=[0];for(i=0;i<t.length;++i){for(var u=0,c=t[i];u<o.length;++u)c+=o[u]<<8,o[u]=c%a,c=c/a|0;for(;c>0;)o.push(c%a),c=c/a|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=s;for(i=o.length-1;i>=0;--i)n+=e[o[i]]}if(r){var f=new RegExp(".{1,"+r+"}","g");n=n.match(f).join(`\r
`)}return n};Xn.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=Sa[e];if(!r){r=Sa[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,a=e.charAt(0),s=[0],n=0;n<t.length;n++){var o=r[t.charCodeAt(n)];if(o===void 0)return;for(var u=0,c=o;u<s.length;++u)c+=s[u]*i,s[u]=c&255,c>>=8;for(;c>0;)s.push(c&255),c>>=8}for(var f=0;t[f]===a&&f<t.length-1;++f)s.push(0);return typeof Buffer!="undefined"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function gu(t,e){var r=0,n=e.length,i=e.charAt(0),a=[0];for(r=0;r<t.length();++r){for(var s=0,o=t.at(r);s<a.length;++s)o+=a[s]<<8,a[s]=o%n,o=o/n|0;for(;o>0;)a.push(o%n),o=o/n|0}var u="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)u+=i;for(r=a.length-1;r>=0;--r)u+=e[a[r]];return u}});var ut=C((oy,Ia)=>{var Aa=Z(),Ca=Ba(),y=Ia.exports=Aa.util=Aa.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){y.nextTick=process.nextTick,typeof setImmediate=="function"?y.setImmediate=setImmediate:y.setImmediate=y.nextTick;return}if(typeof setImmediate=="function"){y.setImmediate=function(){return setImmediate.apply(void 0,arguments)},y.nextTick=function(o){return setImmediate(o)};return}if(y.setImmediate=function(o){setTimeout(o,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let o=function(u){if(u.source===window&&u.data===t){u.stopPropagation();var c=e.slice();e.length=0,c.forEach(function(f){f()})}};var s=o,t="forge.setImmediate",e=[];y.setImmediate=function(u){e.push(u),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver!="undefined"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var u=e.slice();e.length=0,u.forEach(function(c){c()})}).observe(i,{attributes:!0});var a=y.setImmediate;y.setImmediate=function(u){Date.now()-r>15?(r=Date.now(),a(u)):(e.push(u),e.length===1&&i.setAttribute("a",n=!n))}}y.nextTick=y.setImmediate})();y.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;y.globalScope=function(){return y.isNodejs?globalThis:typeof self=="undefined"?window:self}();y.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};y.isArrayBuffer=function(t){return typeof ArrayBuffer!="undefined"&&t instanceof ArrayBuffer};y.isArrayBufferView=function(t){return t&&y.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function xr(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}y.ByteBuffer=Jn;function Jn(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(y.isArrayBuffer(t)||y.isArrayBufferView(t))if(typeof Buffer!="undefined"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch(n){for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Jn||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}y.ByteStringBuffer=Jn;var xu=4096;y.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>xu&&(this.data.substr(0,1),this._constructedStringLength=0)};y.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};y.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};y.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};y.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};y.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};y.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(y.encodeUtf8(t))};y.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};y.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};y.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};y.ByteStringBuffer.prototype.putInt=function(t,e){xr(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};y.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};y.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};y.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};y.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};y.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};y.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};y.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};y.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};y.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};y.ByteStringBuffer.prototype.getInt=function(t){xr(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};y.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};y.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};y.ByteStringBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};y.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};y.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};y.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};y.ByteStringBuffer.prototype.copy=function(){var t=y.createBuffer(this.data);return t.read=this.read,t};y.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};y.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};y.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};y.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};y.ByteStringBuffer.prototype.toString=function(){return y.decodeUtf8(this.bytes())};function vu(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=y.isArrayBuffer(t),n=y.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}y.DataBuffer=vu;y.DataBuffer.prototype.length=function(){return this.write-this.read};y.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};y.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};y.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};y.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};y.DataBuffer.prototype.putBytes=function(t,e){if(y.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(y.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof y.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&y.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof y.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var a;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.hex.decode(t,a,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.base64.decode(t,a,this.write),this;if(e==="utf8"&&(t=y.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.raw.decode(a),this;if(e==="utf16")return this.accommodate(t.length*2),a=new Uint16Array(this.data.buffer,this.write),this.write+=y.text.utf16.encode(a),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};y.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};y.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};y.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};y.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};y.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};y.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};y.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};y.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};y.DataBuffer.prototype.putInt=function(t,e){xr(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};y.DataBuffer.prototype.putSignedInt=function(t,e){return xr(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};y.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};y.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};y.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};y.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};y.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};y.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};y.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};y.DataBuffer.prototype.getInt=function(t){xr(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};y.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};y.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};y.DataBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};y.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};y.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};y.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};y.DataBuffer.prototype.copy=function(){return new y.DataBuffer(this)};y.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};y.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};y.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};y.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};y.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return y.binary.raw.encode(e);if(t==="hex")return y.binary.hex.encode(e);if(t==="base64")return y.binary.base64.encode(e);if(t==="utf8")return y.text.utf8.decode(e);if(t==="utf16")return y.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};y.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=y.encodeUtf8(t)),new y.ByteBuffer(t)};y.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};y.xorBytes=function(t,e,r){for(var n="",i="",a="",s=0,o=0;r>0;--r,++s)i=t.charCodeAt(s)^e.charCodeAt(s),o>=10&&(n+=a,a="",o=0),a+=String.fromCharCode(i),++o;return n+=a,n};y.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};y.bytesToHex=function(t){return y.createBuffer(t).toHex()};y.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var ye="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ge=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Ta="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";y.encode64=function(t,e){for(var r="",n="",i,a,s,o=0;o<t.length;)i=t.charCodeAt(o++),a=t.charCodeAt(o++),s=t.charCodeAt(o++),r+=ye.charAt(i>>2),r+=ye.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=ye.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":ye.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};y.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,a,s=0;s<t.length;)r=ge[t.charCodeAt(s++)-43],n=ge[t.charCodeAt(s++)-43],i=ge[t.charCodeAt(s++)-43],a=ge[t.charCodeAt(s++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),a!==64&&(e+=String.fromCharCode((i&3)<<6|a)));return e};y.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};y.decodeUtf8=function(t){return decodeURIComponent(escape(t))};y.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Ca.encode,decode:Ca.decode}};y.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};y.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};y.binary.hex.encode=y.bytesToHex;y.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,a=r;for(t.length&1&&(i=1,n[a++]=parseInt(t[0],16));i<t.length;i+=2)n[a++]=parseInt(t.substr(i,2),16);return e?a-r:n};y.binary.base64.encode=function(t,e){for(var r="",n="",i,a,s,o=0;o<t.byteLength;)i=t[o++],a=t[o++],s=t[o++],r+=ye.charAt(i>>2),r+=ye.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=ye.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":ye.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};y.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,a,s,o,u=0,c=r;u<t.length;)i=ge[t.charCodeAt(u++)-43],a=ge[t.charCodeAt(u++)-43],s=ge[t.charCodeAt(u++)-43],o=ge[t.charCodeAt(u++)-43],n[c++]=i<<2|a>>4,s!==64&&(n[c++]=(a&15)<<4|s>>2,o!==64&&(n[c++]=(s&3)<<6|o));return e?c-r:n.subarray(0,c)};y.binary.base58.encode=function(t,e){return y.binary.baseN.encode(t,Ta,e)};y.binary.base58.decode=function(t,e){return y.binary.baseN.decode(t,Ta,e)};y.text={utf8:{},utf16:{}};y.text.utf8.encode=function(t,e,r){t=y.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};y.text.utf8.decode=function(t){return y.decodeUtf8(String.fromCharCode.apply(null,t))};y.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var a=r,s=r,o=0;o<t.length;++o)i[s++]=t.charCodeAt(o),a+=2;return e?a-r:n};y.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};y.deflate=function(t,e,r){if(e=y.decode64(t.deflate(y.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};y.inflate=function(t,e,r){var n=t.inflate(y.encode64(e)).rval;return n===null?null:y.decode64(n)};var ti=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=y.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n!="undefined"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},ei=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(y.decode64(r))),r},mu=function(t,e,r,n){var i=ei(t,e);i===null&&(i={}),i[r]=n,ti(t,e,i)},bu=function(t,e,r){var n=ei(t,e);return n!==null&&(n=r in n?n[r]:null),n},wu=function(t,e,r){var n=ei(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var a in n){i=!1;break}i&&(n=null),ti(t,e,n)}},Su=function(t,e){ti(t,e,null)},Xr=function(t,e,r){var n=null;typeof r=="undefined"&&(r=["web","flash"]);var i,a=!1,s=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),a=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),a=!0)}catch(u){s=u}if(a)break}if(!a)throw s;return n};y.setItem=function(t,e,r,n,i){Xr(mu,arguments,i)};y.getItem=function(t,e,r,n){return Xr(bu,arguments,n)};y.removeItem=function(t,e,r,n){Xr(wu,arguments,n)};y.clearItems=function(t,e,r){Xr(Su,arguments,r)};y.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};y.format=function(t){for(var e=/%./g,r,n,i=0,a=[],s=0;r=e.exec(t);){n=t.substring(s,e.lastIndex-2),n.length>0&&a.push(n),s=e.lastIndex;var o=r[0][1];switch(o){case"s":case"o":i<arguments.length?a.push(arguments[i+++1]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+o+"?>")}}return a.push(t.substring(s)),a.join("")};y.formatNumber=function(t,e,r,n){var i=t,a=isNaN(e=Math.abs(e))?2:e,s=r===void 0?",":r,o=n===void 0?".":n,u=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",f=c.length>3?c.length%3:0;return u+(f?c.substr(0,f)+o:"")+c.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+o)+(a?s+Math.abs(i-c).toFixed(a).slice(2):"")};y.formatSize=function(t){return t>=1073741824?t=y.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=y.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=y.formatNumber(t/1024,0)+" KiB":t=y.formatNumber(t,0)+" bytes",t};y.bytesFromIP=function(t){return t.indexOf(".")!==-1?y.bytesFromIPv4(t):t.indexOf(":")!==-1?y.bytesFromIPv6(t):null};y.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=y.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};y.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(s){return s.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=y.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var a=y.hexToBytes(t[i]);a.length<2&&n.putByte(0),n.putBytes(a)}return n.getBytes()};y.bytesToIP=function(t){return t.length===4?y.bytesToIPv4(t):t.length===16?y.bytesToIPv6(t):null};y.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};y.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var a=y.bytesToHex(t[i]+t[i+1]);a[0]==="0"&&a!=="0";)a=a.substr(1);if(a==="0"){var s=r[r.length-1],o=e.length;!s||o!==s.end+1?r.push({start:o,end:o}):(s.end=o,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(a)}if(r.length>0){var u=r[n];u.end-u.start>0&&(e.splice(u.start,u.end-u.start+1,""),u.start===0&&e.unshift(""),u.end===7&&e.push(""))}return e.join(":")};y.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in y&&!t.update)return e(null,y.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return y.cores=navigator.hardwareConcurrency,e(null,y.cores);if(typeof Worker=="undefined")return y.cores=1,e(null,y.cores);if(typeof Blob=="undefined")return y.cores=2,e(null,y.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var o=Date.now(),u=o+4;Date.now()<u;);self.postMessage({st:o,et:u})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,o,u){if(o===0){var c=Math.floor(s.reduce(function(f,h){return f+h},0)/s.length);return y.cores=Math.max(1,c),URL.revokeObjectURL(r),e(null,y.cores)}i(u,function(f,h){s.push(a(u,h)),n(s,o-1,u)})}function i(s,o){for(var u=[],c=[],f=0;f<s;++f){var h=new Worker(r);h.addEventListener("message",function(l){if(c.push(l.data),c.length===s){for(var d=0;d<s;++d)u[d].terminate();o(null,c)}}),u.push(h)}for(var f=0;f<s;++f)u[f].postMessage(f)}function a(s,o){for(var u=[],c=0;c<s;++c)for(var f=o[c],h=u[c]=[],l=0;l<s;++l)if(c!==l){var d=o[l];(f.st>d.st&&f.st<d.et||d.st>f.st&&d.st<f.et)&&h.push(l)}return u.reduce(function(p,g){return Math.max(p,g.length)},0)}}});var ni=C((cy,_a)=>{var yt=Z();ut();_a.exports=yt.cipher=yt.cipher||{};yt.cipher.algorithms=yt.cipher.algorithms||{};yt.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=yt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new yt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};yt.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=yt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new yt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};yt.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),yt.cipher.algorithms[t]=e};yt.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in yt.cipher.algorithms?yt.cipher.algorithms[t]:null};var ri=yt.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};ri.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=yt.util.createBuffer(),this.output=t.output||yt.util.createBuffer(),this.mode.start(e)};ri.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};ri.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var ai=C((uy,Ra)=>{var gt=Z();ut();gt.cipher=gt.cipher||{};var O=Ra.exports=gt.cipher.modes=gt.cipher.modes||{};O.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};O.ecb.prototype.start=function(t){};O.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};O.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};O.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};O.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};O.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};O.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Jr(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};O.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};O.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};O.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};O.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};O.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=gt.util.createBuffer(),this._partialBytes=0};O.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Jr(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=gt.util.createBuffer(),this._partialBytes=0};O.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Jr(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.ofb.prototype.decrypt=O.ofb.prototype.encrypt;O.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=gt.util.createBuffer(),this._partialBytes=0};O.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Jr(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}tn(this._inBlock)};O.ctr.prototype.decrypt=O.ctr.prototype.encrypt;O.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=gt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};O.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=gt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=gt.util.createBuffer(t.additionalData):r=gt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=gt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(ii(n*8)))}this._inBlock=this._j0.slice(0),tn(this._inBlock),this._partialBytes=0,r=gt.util.createBuffer(r),this._aDataLength=ii(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};O.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),tn(this._inBlock)};O.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),tn(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};O.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=gt.util.createBuffer();var n=this._aDataLength.concat(ii(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var a=0;a<this._ints;++a)this.tag.putInt32(this._s[a]^i[a]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};O.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var a=t[i/32|0]&1<<31-i%32;a&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};O.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};O.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,a=this._m[r][i];e[0]^=a[0],e[1]^=a[1],e[2]^=a[2],e[3]^=a[3]}return e};O.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};O.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,a=new Array(i),s=0;s<i;++s){var o=[0,0,0,0],u=s/n|0,c=(n-1-s%n)*e;o[u]=1<<e-1<<c,a[s]=this.generateSubHashTable(this.multiply(o,t),e)}return a};O.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var a=n>>>1;a>0;)this.pow(i[2*a],i[a]=[]),a>>=1;for(a=2;a<n;){for(var s=1;s<a;++s){var o=i[a],u=i[s];i[a+s]=[o[0]^u[0],o[1]^u[1],o[2]^u[2],o[3]^u[3]]}a*=2}for(i[0]=[0,0,0,0],a=n+1;a<r;++a){var c=i[a^n];i[a]=[t[0]^c[0],t[1]^c[1],t[2]^c[2],t[3]^c[3]]}return i};function Jr(t,e){if(typeof t=="string"&&(t=gt.util.createBuffer(t)),gt.util.isArray(t)&&t.length>4){var r=t;t=gt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!gt.util.isArray(t)){for(var i=[],a=e/4,n=0;n<a;++n)i.push(t.getInt32());t=i}return t}function tn(t){t[t.length-1]=t[t.length-1]+1&4294967295}function ii(t){return[t/4294967296|0,t&4294967295]}});var rn=C((fy,Pa)=>{var et=Z();ni();ai();ut();Pa.exports=et.aes=et.aes||{};et.aes.startEncrypting=function(t,e,r,n){var i=en({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};et.aes.createEncryptionCipher=function(t,e){return en({key:t,output:null,decrypt:!1,mode:e})};et.aes.startDecrypting=function(t,e,r,n){var i=en({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};et.aes.createDecryptionCipher=function(t,e){return en({key:t,output:null,decrypt:!0,mode:e})};et.aes.Algorithm=function(t,e){si||ka();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return ci(r._w,n,i,!1)},decrypt:function(n,i){return ci(r._w,n,i,!0)}}}),r._init=!1};et.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=et.util.createBuffer(e);else if(et.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=et.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!et.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!et.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var a=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(a)!==-1;this._w=Na(e,t.decrypt&&!s),this._init=!0}};et.aes._expandKey=function(t,e){return si||ka(),Na(t,e)};et.aes._updateBlock=ci;Xe("AES-ECB",et.cipher.modes.ecb);Xe("AES-CBC",et.cipher.modes.cbc);Xe("AES-CFB",et.cipher.modes.cfb);Xe("AES-OFB",et.cipher.modes.ofb);Xe("AES-CTR",et.cipher.modes.ctr);Xe("AES-GCM",et.cipher.modes.gcm);function Xe(t,e){var r=function(){return new et.aes.Algorithm(t,e)};et.cipher.registerAlgorithm(t,r)}var si=!1,Je=4,Ct,oi,Da,Pe,Vt;function ka(){si=!0,Da=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Ct=new Array(256),oi=new Array(256),Pe=new Array(4),Vt=new Array(4);for(var e=0;e<4;++e)Pe[e]=new Array(256),Vt[e]=new Array(256);for(var r=0,n=0,i,a,s,o,u,c,f,e=0;e<256;++e){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,Ct[r]=o,oi[o]=r,u=t[o],i=t[r],a=t[i],s=t[a],c=u<<24^o<<16^o<<8^(o^u),f=(i^a^s)<<24^(r^s)<<16^(r^a^s)<<8^(r^i^s);for(var h=0;h<4;++h)Pe[h][r]=c,Vt[h][o]=f,c=c<<24|c>>>8,f=f<<24|f>>>8;r===0?r=n=1:(r=i^t[t[t[i^s]]],n^=t[t[n]])}}function Na(t,e){for(var r=t.slice(0),n,i=1,a=r.length,s=a+6+1,o=Je*s,u=a;u<o;++u)n=r[u-1],u%a==0?(n=Ct[n>>>16&255]<<24^Ct[n>>>8&255]<<16^Ct[n&255]<<8^Ct[n>>>24]^Da[i]<<24,i++):a>6&&u%a==4&&(n=Ct[n>>>24]<<24^Ct[n>>>16&255]<<16^Ct[n>>>8&255]<<8^Ct[n&255]),r[u]=r[u-a]^n;if(e){var c,f=Vt[0],h=Vt[1],l=Vt[2],d=Vt[3],p=r.slice(0);o=r.length;for(var u=0,g=o-Je;u<o;u+=Je,g-=Je)if(u===0||u===o-Je)p[u]=r[g],p[u+1]=r[g+3],p[u+2]=r[g+2],p[u+3]=r[g+1];else for(var v=0;v<Je;++v)c=r[g+v],p[u+(3&-v)]=f[Ct[c>>>24]]^h[Ct[c>>>16&255]]^l[Ct[c>>>8&255]]^d[Ct[c&255]];r=p}return r}function ci(t,e,r,n){var i=t.length/4-1,a,s,o,u,c;n?(a=Vt[0],s=Vt[1],o=Vt[2],u=Vt[3],c=oi):(a=Pe[0],s=Pe[1],o=Pe[2],u=Pe[3],c=Ct);var f,h,l,d,p,g,v;f=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],d=e[n?1:3]^t[3];for(var m=3,E=1;E<i;++E)p=a[f>>>24]^s[h>>>16&255]^o[l>>>8&255]^u[d&255]^t[++m],g=a[h>>>24]^s[l>>>16&255]^o[d>>>8&255]^u[f&255]^t[++m],v=a[l>>>24]^s[d>>>16&255]^o[f>>>8&255]^u[h&255]^t[++m],d=a[d>>>24]^s[f>>>16&255]^o[h>>>8&255]^u[l&255]^t[++m],f=p,h=g,l=v;r[0]=c[f>>>24]<<24^c[h>>>16&255]<<16^c[l>>>8&255]<<8^c[d&255]^t[++m],r[n?3:1]=c[h>>>24]<<24^c[l>>>16&255]<<16^c[d>>>8&255]<<8^c[f&255]^t[++m],r[2]=c[l>>>24]<<24^c[d>>>16&255]<<16^c[f>>>8&255]<<8^c[h&255]^t[++m],r[n?1:3]=c[d>>>24]<<24^c[f>>>16&255]<<16^c[h>>>8&255]<<8^c[l&255]^t[++m]}function en(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=et.cipher.createDecipher(r,t.key):n=et.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof et.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});function Eu(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var a=t.charAt(i),s=a.charCodeAt(0);if(r[s]!==255)throw new TypeError(a+" is ambiguous");r[s]=i}var o=t.length,u=t.charAt(0),c=Math.log(o)/Math.log(256),f=Math.log(256)/Math.log(o);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,v=0,m=0,E=p.length;m!==E&&p[m]===0;)m++,g++;for(var A=(E-m)*f+1>>>0,N=new Uint8Array(A);m!==E;){for(var I=p[m],_=0,q=A-1;(I!==0||_<v)&&q!==-1;q--,_++)I+=256*N[q]>>>0,N[q]=I%o>>>0,I=I/o>>>0;if(I!==0)throw new Error("Non-zero carry");v=_,m++}for(var z=A-v;z!==A&&N[z]===0;)z++;for(var dt=u.repeat(g);z<A;++z)dt+=t.charAt(N[z]);return dt}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var v=0,m=0;p[g]===u;)v++,g++;for(var E=(p.length-g)*c+1>>>0,A=new Uint8Array(E);p[g];){var N=r[p.charCodeAt(g)];if(N===255)return;for(var I=0,_=E-1;(N!==0||I<m)&&_!==-1;_--,I++)N+=o*A[_]>>>0,A[_]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");m=I,g++}if(p[g]!==" "){for(var q=E-m;q!==E&&A[q]===0;)q++;for(var z=new Uint8Array(v+(E-q)),dt=v;q!==E;)z[dt++]=A[q++];return z}}}function d(p){var g=l(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var Bu,Au,La,Ka=X(()=>{Bu=Eu,Au=Bu,La=Au});var ly,Ua,oe,qa,Oa,xe=X(()=>{ly=new Uint8Array(0),Ua=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},oe=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},qa=t=>new TextEncoder().encode(t),Oa=t=>new TextDecoder().decode(t)});var Ma,Va,za,Ha,Ga,nn,ve,Cu,Tu,ot,Yt=X(()=>{Ka();xe();Ma=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Va=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseDecode=n}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){return Ha(this,e)}},za=class{constructor(e){this.decoders=e}or(e){return Ha(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Ha=(t,e)=>new za({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Ga=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Ma(e,r,n),this.decoder=new Va(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},nn=({name:t,prefix:e,encode:r,decode:n})=>new Ga(t,e,r,n),ve=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=La(r,e);return nn({prefix:t,name:e,encode:n,decode:a=>oe(i(a))})},Cu=(t,e,r,n)=>{let i={};for(let f=0;f<e.length;++f)i[e[f]]=f;let a=t.length;for(;t[a-1]==="=";)--a;let s=new Uint8Array(a*r/8|0),o=0,u=0,c=0;for(let f=0;f<a;++f){let h=i[t[f]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<r|h,o+=r,o>=8&&(o-=8,s[c++]=255&u>>o)}if(o>=r||255&u<<8-o)throw new SyntaxError("Unexpected end of data");return s},Tu=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,a="",s=0,o=0;for(let u=0;u<t.length;++u)for(o=o<<8|t[u],s+=8;s>r;)s-=r,a+=e[i&o>>s];if(s&&(a+=e[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a},ot=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>nn({prefix:e,name:t,encode(i){return Tu(i,n,r)},decode(i){return Cu(i,n,r,t)}})});var ui={};At(ui,{identity:()=>Iu});var Iu,Wa=X(()=>{Yt();xe();Iu=nn({prefix:"\0",name:"identity",encode:t=>Oa(t),decode:t=>qa(t)})});var fi={};At(fi,{base2:()=>_u});var _u,Ya=X(()=>{Yt();_u=ot({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var hi={};At(hi,{base8:()=>Ru});var Ru,ja=X(()=>{Yt();Ru=ot({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var li={};At(li,{base10:()=>Du});var Du,$a=X(()=>{Yt();Du=ve({prefix:"9",name:"base10",alphabet:"0123456789"})});var pi={};At(pi,{base16:()=>ku,base16upper:()=>Nu});var ku,Nu,Za=X(()=>{Yt();ku=ot({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Nu=ot({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var di={};At(di,{base32:()=>tr,base32hex:()=>Uu,base32hexpad:()=>Ou,base32hexpadupper:()=>Fu,base32hexupper:()=>qu,base32pad:()=>Lu,base32padupper:()=>Ku,base32upper:()=>Pu,base32z:()=>Mu});var tr,Pu,Lu,Ku,Uu,qu,Ou,Fu,Mu,yi=X(()=>{Yt();tr=ot({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Pu=ot({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Lu=ot({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ku=ot({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Uu=ot({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),qu=ot({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ou=ot({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Fu=ot({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Mu=ot({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var gi={};At(gi,{base36:()=>Vu,base36upper:()=>zu});var Vu,zu,Qa=X(()=>{Yt();Vu=ve({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),zu=ve({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var an={};At(an,{base58btc:()=>jt,base58flickr:()=>Hu});var jt,Hu,sn=X(()=>{Yt();jt=ve({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Hu=ve({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var vr={};At(vr,{base64:()=>Gu,base64pad:()=>Wu,base64url:()=>Yu,base64urlpad:()=>ju});var Gu,Wu,Yu,ju,on=X(()=>{Yt();Gu=ot({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Wu=ot({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Yu=ot({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ju=ot({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});function Ja(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Xu;)e[r++]=t&255|Xa,t/=128;for(;t&Qu;)e[r++]=t&255|Xa,t>>>=7;return e[r]=t|0,Ja.bytes=r-n+1,e}function xi(t,e){var r=0,e=e||0,n=0,i=e,a,s=t.length;do{if(i>=s)throw xi.bytes=0,new RangeError("Could not decode varint");a=t[i++],r+=n<28?(a&ts)<<n:(a&ts)*Math.pow(2,n),n+=7}while(a>=tf);return xi.bytes=i-e,r}var $u,Xa,Zu,Qu,Xu,Ju,tf,ts,ef,rf,nf,af,sf,of,cf,uf,ff,hf,lf,pf,mr,es=X(()=>{$u=Ja,Xa=128,Zu=127,Qu=~Zu,Xu=Math.pow(2,31);Ju=xi,tf=128,ts=127;ef=Math.pow(2,7),rf=Math.pow(2,14),nf=Math.pow(2,21),af=Math.pow(2,28),sf=Math.pow(2,35),of=Math.pow(2,42),cf=Math.pow(2,49),uf=Math.pow(2,56),ff=Math.pow(2,63),hf=function(t){return t<ef?1:t<rf?2:t<nf?3:t<af?4:t<sf?5:t<of?6:t<cf?7:t<uf?8:t<ff?9:10},lf={encode:$u,decode:Ju,encodingLength:hf},pf=lf,mr=pf});var br,er,rr,cn=X(()=>{es();br=t=>[mr.decode(t),mr.decode.bytes],er=(t,e,r=0)=>(mr.encode(t,e,r),e),rr=t=>mr.encodingLength(t)});var Le,ns,is,wr,Sr=X(()=>{xe();cn();Le=(t,e)=>{let r=e.byteLength,n=rr(t),i=n+rr(r),a=new Uint8Array(i+r);return er(t,a,0),er(r,a,n),a.set(e,i),new wr(t,r,e,a)},ns=t=>{let e=oe(t),[r,n]=br(e),[i,a]=br(e.subarray(n)),s=e.subarray(n+a);if(s.byteLength!==i)throw new Error("Incorrect length");return new wr(r,i,s,e)},is=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&Ua(t.bytes,e.bytes),wr=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}});var vi,ss,mi=X(()=>{Sr();vi=({name:t,code:e,encode:r})=>new ss(t,e,r),ss=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Le(this.code,r):r.then(n=>Le(this.code,n))}else throw Error("Unknown type, must be binary type")}}});var Ke={};At(Ke,{sha256:()=>df,sha512:()=>yf});var cs,df,yf,nr=X(()=>{mi();cs=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),df=vi({name:"sha2-256",code:18,encode:cs("SHA-256")}),yf=vi({name:"sha2-512",code:19,encode:cs("SHA-512")})});var un={};At(un,{identity:()=>vf});var us,gf,xf,vf,bi=X(()=>{xe();Sr();us=0,gf="identity",xf=t=>Le(us,oe(t)),vf={code:us,name:gf,digest:xf}});var fs=X(()=>{xe()});var Ly,Ky,hs=X(()=>{Ly=new TextEncoder,Ky=new TextDecoder});var xt,wf,Sf,Ef,Er,Bf,ls,ps,fn,hn,Af,Cf,Tf,ds=X(()=>{cn();Sr();sn();yi();xe();xt=class{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:hn,byteLength:hn,code:fn,version:fn,multihash:fn,bytes:fn,_baseCache:hn,asCID:hn})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==Er)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Bf)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return xt.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Le(e,r);return xt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&is(this.multihash,e.multihash)}toString(e){let{bytes:r,version:n,_baseCache:i}=this;switch(n){case 0:return Sf(r,i,e||jt.encoder);default:return Ef(r,i,e||tr.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return Cf(/^0\.0/,Tf),!!(e&&(e[ps]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof xt)return e;if(e!=null&&e.asCID===e){let{version:r,code:n,multihash:i,bytes:a}=e;return new xt(r,n,i,a||ls(r,n,i.bytes))}else if(e!=null&&e[ps]===!0){let{version:r,multihash:n,code:i}=e,a=ns(n);return xt.create(r,i,a)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==Er)throw new Error(`Version 0 CID must use dag-pb (code: ${Er}) block encoding`);return new xt(e,r,n,n.bytes)}case 1:{let i=ls(e,r,n.bytes);return new xt(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return xt.create(0,Er,e)}static createV1(e,r){return xt.create(1,e,r)}static decode(e){let[r,n]=xt.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=xt.inspectBytes(e),n=r.size-r.multihashSize,i=oe(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let a=i.subarray(r.multihashSize-r.digestSize),s=new wr(r.multihashCode,r.digestSize,a,i);return[r.version===0?xt.createV0(s):xt.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=br(e.subarray(r));return r+=l,h},i=n(),a=Er;if(i===18?(i=0,r=0):i===1&&(a=n()),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,o=n(),u=n(),c=r+u,f=c-s;return{version:i,codec:a,multihashCode:o,digestSize:u,multihashSize:f,size:c}}static parse(e,r){let[n,i]=wf(e,r),a=xt.decode(i);return a._baseCache.set(n,e),a}},wf=(t,e)=>{switch(t[0]){case"Q":{let r=e||jt;return[jt.prefix,r.decode(`${jt.prefix}${t}`)]}case jt.prefix:{let r=e||jt;return[jt.prefix,r.decode(t)]}case tr.prefix:{let r=e||tr;return[tr.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},Sf=(t,e,r)=>{let{prefix:n}=r;if(n!==jt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let a=r.encode(t).slice(1);return e.set(n,a),a}else return i},Ef=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let a=r.encode(t);return e.set(n,a),a}else return i},Er=112,Bf=18,ls=(t,e,r)=>{let n=rr(t),i=n+rr(e),a=new Uint8Array(i+r.byteLength);return er(t,a,0),er(e,a,n),a.set(r,i),a},ps=Symbol.for("@ipld/js-cid/CID"),fn={writable:!1,configurable:!1,enumerable:!0},hn={writable:!1,enumerable:!1,configurable:!1},Af="0.0.0-dev",Cf=(t,e)=>{if(t.test(Af))console.warn(e);else throw new Error(e)},Tf=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var ys=X(()=>{ds();cn();xe();mi();Sr()});var wi,Wy,gs=X(()=>{Wa();Ya();ja();$a();Za();yi();Qa();sn();on();nr();bi();fs();hs();ys();wi={...ui,...fi,...hi,...li,...pi,...di,...gi,...an,...vr},Wy={...Ke,...un}});function xs(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var vs,Si,If,ln,Ei=X(()=>{gs();vs=xs("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),Si=xs("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),If={utf8:vs,"utf-8":vs,hex:wi.base16,latin1:Si,ascii:Si,binary:Si,...wi},ln=If});var me={};At(me,{toString:()=>_f});function _f(t,e="utf8"){let r=ln[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}var be=X(()=>{Ei()});var we={};At(we,{fromString:()=>Rf});function Rf(t,e="utf8"){let r=ln[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}var Se=X(()=>{Ei()});var ws=C((Xy,bs)=>{"use strict";rn();var pn=Z(),{toString:ir}=(be(),me),{fromString:ms}=(Se(),we);bs.exports={createCipheriv:(t,e,r)=>{let n=pn.cipher.createCipher("AES-CTR",ir(e,"ascii"));return n.start({iv:ir(r,"ascii")}),{update:i=>(n.update(pn.util.createBuffer(ir(i,"ascii"))),ms(n.output.getBytes(),"ascii"))}},createDecipheriv:(t,e,r)=>{let n=pn.cipher.createDecipher("AES-CTR",ir(e,"ascii"));return n.start({iv:ir(r,"ascii")}),{update:i=>(n.update(pn.util.createBuffer(ir(i,"ascii"))),ms(n.output.getBytes(),"ascii"))}}}});var Pt=C((Jy,Es)=>{"use strict";function Ss(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function Df(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return Ss(t,r)}catch(n){r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),Ss(new i,r)}}Es.exports=Df});var Cs=C((t1,As)=>{"use strict";var kf=Pt(),Bs={16:"aes-128-ctr",32:"aes-256-ctr"};As.exports=function(t){let e=Bs[t.length];if(!e){let r=Object.entries(Bs).map(([n,i])=>`${n} (${i})`).join(" / ");throw kf(new Error(`Invalid key length ${t.length} bytes. Must be ${r}`),"ERR_INVALID_KEY_LENGTH")}return e}});var _s=C(Is=>{"use strict";var Ts=ws(),Nf=Cs();Is.create=async function(t,e){let r=Nf(t),n=Ts.createCipheriv(r,t,e),i=Ts.createDecipheriv(r,t,e);return{async encrypt(s){return n.update(s)},async decrypt(s){return i.update(s)}}}});var Ds=C((r1,Rs)=>{"use strict";Rs.exports=Pf;function Pf(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,a=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(o,u){r[n]=function(f){if(a)if(a=!1,f)u(f);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];o.apply(null,h)}};try{t.apply(e||null,r)}catch(c){a&&(a=!1,u(c))}})}});var Ls=C(Ps=>{"use strict";var dn=Ps;dn.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var ar=new Array(64),ks=new Array(123);for(zt=0;zt<64;)ks[ar[zt]=zt<26?zt+65:zt<52?zt+71:zt<62?zt-4:zt-59|43]=zt++;var zt;dn.encode=function(e,r,n){for(var i=null,a=[],s=0,o=0,u;r<n;){var c=e[r++];switch(o){case 0:a[s++]=ar[c>>2],u=(c&3)<<4,o=1;break;case 1:a[s++]=ar[u|c>>4],u=(c&15)<<2,o=2;break;case 2:a[s++]=ar[u|c>>6],a[s++]=ar[c&63],o=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),s=0)}return o&&(a[s++]=ar[u],a[s++]=61,o===1&&(a[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,a.slice(0,s))),i.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var Ns="invalid encoding";dn.decode=function(e,r,n){for(var i=n,a=0,s,o=0;o<e.length;){var u=e.charCodeAt(o++);if(u===61&&a>1)break;if((u=ks[u])===void 0)throw Error(Ns);switch(a){case 0:s=u,a=1;break;case 1:r[n++]=s<<2|(u&48)>>4,s=u,a=2;break;case 2:r[n++]=(s&15)<<4|(u&60)>>2,s=u,a=3;break;case 3:r[n++]=(s&3)<<6|u,a=0;break}}if(a===1)throw Error(Ns);return n-i};dn.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Us=C((i1,Ks)=>{"use strict";Ks.exports=yn;function yn(){this._listeners={}}yn.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};yn.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};yn.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var Hs=C((a1,zs)=>{"use strict";zs.exports=qs(qs);function qs(t){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(u,c,f){e[0]=u,c[f]=r[0],c[f+1]=r[1],c[f+2]=r[2],c[f+3]=r[3]}function a(u,c,f){e[0]=u,c[f]=r[3],c[f+1]=r[2],c[f+2]=r[1],c[f+3]=r[0]}t.writeFloatLE=n?i:a,t.writeFloatBE=n?a:i;function s(u,c){return r[0]=u[c],r[1]=u[c+1],r[2]=u[c+2],r[3]=u[c+3],e[0]}function o(u,c){return r[3]=u[c],r[2]=u[c+1],r[1]=u[c+2],r[0]=u[c+3],e[0]}t.readFloatLE=n?s:o,t.readFloatBE=n?o:s}():function(){function e(n,i,a,s){var o=i<0?1:0;if(o&&(i=-i),i===0)n(1/i>0?0:2147483648,a,s);else if(isNaN(i))n(2143289344,a,s);else if(i>34028234663852886e22)n((o<<31|2139095040)>>>0,a,s);else if(i<11754943508222875e-54)n((o<<31|Math.round(i/1401298464324817e-60))>>>0,a,s);else{var u=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-u)*8388608)&8388607;n((o<<31|u+127<<23|c)>>>0,a,s)}}t.writeFloatLE=e.bind(null,Os),t.writeFloatBE=e.bind(null,Fs);function r(n,i,a){var s=n(i,a),o=(s>>31)*2+1,u=s>>>23&255,c=s&8388607;return u===255?c?NaN:o*(1/0):u===0?o*1401298464324817e-60*c:o*Math.pow(2,u-150)*(c+8388608)}t.readFloatLE=r.bind(null,Ms),t.readFloatBE=r.bind(null,Vs)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(u,c,f){e[0]=u,c[f]=r[0],c[f+1]=r[1],c[f+2]=r[2],c[f+3]=r[3],c[f+4]=r[4],c[f+5]=r[5],c[f+6]=r[6],c[f+7]=r[7]}function a(u,c,f){e[0]=u,c[f]=r[7],c[f+1]=r[6],c[f+2]=r[5],c[f+3]=r[4],c[f+4]=r[3],c[f+5]=r[2],c[f+6]=r[1],c[f+7]=r[0]}t.writeDoubleLE=n?i:a,t.writeDoubleBE=n?a:i;function s(u,c){return r[0]=u[c],r[1]=u[c+1],r[2]=u[c+2],r[3]=u[c+3],r[4]=u[c+4],r[5]=u[c+5],r[6]=u[c+6],r[7]=u[c+7],e[0]}function o(u,c){return r[7]=u[c],r[6]=u[c+1],r[5]=u[c+2],r[4]=u[c+3],r[3]=u[c+4],r[2]=u[c+5],r[1]=u[c+6],r[0]=u[c+7],e[0]}t.readDoubleLE=n?s:o,t.readDoubleBE=n?o:s}():function(){function e(n,i,a,s,o,u){var c=s<0?1:0;if(c&&(s=-s),s===0)n(0,o,u+i),n(1/s>0?0:2147483648,o,u+a);else if(isNaN(s))n(0,o,u+i),n(2146959360,o,u+a);else if(s>17976931348623157e292)n(0,o,u+i),n((c<<31|2146435072)>>>0,o,u+a);else{var f;if(s<22250738585072014e-324)f=s/5e-324,n(f>>>0,o,u+i),n((c<<31|f/4294967296)>>>0,o,u+a);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),f=s*Math.pow(2,-h),n(f*4503599627370496>>>0,o,u+i),n((c<<31|h+1023<<20|f*1048576&1048575)>>>0,o,u+a)}}}t.writeDoubleLE=e.bind(null,Os,0,4),t.writeDoubleBE=e.bind(null,Fs,4,0);function r(n,i,a,s,o){var u=n(s,o+i),c=n(s,o+a),f=(c>>31)*2+1,h=c>>>20&2047,l=4294967296*(c&1048575)+u;return h===2047?l?NaN:f*(1/0):h===0?f*5e-324*l:f*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,Ms,0,4),t.readDoubleBE=r.bind(null,Vs,4,0)}(),t}function Os(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Fs(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function Ms(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function Vs(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var Gs=C((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var Ys=C(Ws=>{"use strict";var Bi=Ws;Bi.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)==55296&&(e.charCodeAt(i+1)&64512)==56320?(++i,r+=4):r+=3;return r};Bi.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var a=null,s=[],o=0,u;r<n;)u=e[r++],u<128?s[o++]=u:u>191&&u<224?s[o++]=(u&31)<<6|e[r++]&63:u>239&&u<365?(u=((u&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,s[o++]=55296+(u>>10),s[o++]=56320+(u&1023)):s[o++]=(u&15)<<12|(e[r++]&63)<<6|e[r++]&63,o>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,s)),o=0);return a?(o&&a.push(String.fromCharCode.apply(String,s.slice(0,o))),a.join("")):String.fromCharCode.apply(String,s.slice(0,o))};Bi.write=function(e,r,n){for(var i=n,a,s,o=0;o<e.length;++o)a=e.charCodeAt(o),a<128?r[n++]=a:a<2048?(r[n++]=a>>6|192,r[n++]=a&63|128):(a&64512)==55296&&((s=e.charCodeAt(o+1))&64512)==56320?(a=65536+((a&1023)<<10)+(s&1023),++o,r[n++]=a>>18|240,r[n++]=a>>12&63|128,r[n++]=a>>6&63|128,r[n++]=a&63|128):(r[n++]=a>>12|224,r[n++]=a>>6&63|128,r[n++]=a&63|128);return n-i}});var $s=C((o1,js)=>{"use strict";js.exports=Lf;function Lf(t,e,r){var n=r||8192,i=n>>>1,a=null,s=n;return function(u){if(u<1||u>i)return t(u);s+u>n&&(a=t(n),s=0);var c=e.call(a,s,s+=u);return s&7&&(s=(s|7)+1),c}}});var Qs=C((c1,Zs)=>{"use strict";Zs.exports=vt;var Br=Be();function vt(t,e){this.lo=t>>>0,this.hi=e>>>0}var Ue=vt.zero=new vt(0,0);Ue.toNumber=function(){return 0};Ue.zzEncode=Ue.zzDecode=function(){return this};Ue.length=function(){return 1};var Kf=vt.zeroHash="\0\0\0\0\0\0\0\0";vt.fromNumber=function(e){if(e===0)return Ue;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new vt(n,i)};vt.from=function(e){if(typeof e=="number")return vt.fromNumber(e);if(Br.isString(e))if(Br.Long)e=Br.Long.fromString(e);else return vt.fromNumber(parseInt(e,10));return e.low||e.high?new vt(e.low>>>0,e.high>>>0):Ue};vt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};vt.prototype.toLong=function(e){return Br.Long?new Br.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Ee=String.prototype.charCodeAt;vt.fromHash=function(e){return e===Kf?Ue:new vt((Ee.call(e,0)|Ee.call(e,1)<<8|Ee.call(e,2)<<16|Ee.call(e,3)<<24)>>>0,(Ee.call(e,4)|Ee.call(e,5)<<8|Ee.call(e,6)<<16|Ee.call(e,7)<<24)>>>0)};vt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};vt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};vt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};vt.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Be=C(Ai=>{"use strict";var k=Ai;k.asPromise=Ds();k.base64=Ls();k.EventEmitter=Us();k.float=Hs();k.inquire=Gs();k.utf8=Ys();k.pool=$s();k.LongBits=Qs();k.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);k.global=k.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||Ai;k.emptyArray=Object.freeze?Object.freeze([]):[];k.emptyObject=Object.freeze?Object.freeze({}):{};k.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};k.isString=function(e){return typeof e=="string"||e instanceof String};k.isObject=function(e){return e&&typeof e=="object"};k.isset=k.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};k.Buffer=function(){try{var t=k.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(e){return null}}();k._Buffer_from=null;k._Buffer_allocUnsafe=null;k.newBuffer=function(e){return typeof e=="number"?k.Buffer?k._Buffer_allocUnsafe(e):new k.Array(e):k.Buffer?k._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};k.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;k.Long=k.global.dcodeIO&&k.global.dcodeIO.Long||k.global.Long||k.inquire("long");k.key2Re=/^true|false|0|1$/;k.key32Re=/^-?(?:0|[1-9][0-9]*)$/;k.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;k.longToHash=function(e){return e?k.LongBits.from(e).toHash():k.LongBits.zeroHash};k.longFromHash=function(e,r){var n=k.LongBits.fromHash(e);return k.Long?k.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function Xs(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}k.merge=Xs;k.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Js(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Xs(this,n)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}k.newError=Js;k.ProtocolError=Js("ProtocolError");k.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),a=i.length-1;a>-1;--a)if(r[i[a]]===1&&this[i[a]]!==void 0&&this[i[a]]!==null)return i[a]}};k.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};k.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};k._configure=function(){var t=k.Buffer;if(!t){k._Buffer_from=k._Buffer_allocUnsafe=null;return}k._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},k._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var ki=C((f1,n0)=>{"use strict";n0.exports=H;var Lt=Be(),Ci,gn=Lt.LongBits,t0=Lt.base64,e0=Lt.utf8;function Ar(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Ti(){}function Uf(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function H(){this.len=0,this.head=new Ar(Ti,0,0),this.tail=this.head,this.states=null}var r0=function(){return Lt.Buffer?function(){return(H.create=function(){return new Ci})()}:function(){return new H}};H.create=r0();H.alloc=function(e){return new Lt.Array(e)};Lt.Array!==Array&&(H.alloc=Lt.pool(H.alloc,Lt.Array.prototype.subarray));H.prototype._push=function(e,r,n){return this.tail=this.tail.next=new Ar(e,r,n),this.len+=r,this};function Ii(t,e,r){e[r]=t&255}function qf(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function _i(t,e){this.len=t,this.next=void 0,this.val=e}_i.prototype=Object.create(Ar.prototype);_i.prototype.fn=qf;H.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new _i((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};H.prototype.int32=function(e){return e<0?this._push(Ri,10,gn.fromNumber(e)):this.uint32(e)};H.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Ri(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}H.prototype.uint64=function(e){var r=gn.from(e);return this._push(Ri,r.length(),r)};H.prototype.int64=H.prototype.uint64;H.prototype.sint64=function(e){var r=gn.from(e).zzEncode();return this._push(Ri,r.length(),r)};H.prototype.bool=function(e){return this._push(Ii,1,e?1:0)};function Di(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}H.prototype.fixed32=function(e){return this._push(Di,4,e>>>0)};H.prototype.sfixed32=H.prototype.fixed32;H.prototype.fixed64=function(e){var r=gn.from(e);return this._push(Di,4,r.lo)._push(Di,4,r.hi)};H.prototype.sfixed64=H.prototype.fixed64;H.prototype.float=function(e){return this._push(Lt.float.writeFloatLE,4,e)};H.prototype.double=function(e){return this._push(Lt.float.writeDoubleLE,8,e)};var Of=Lt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};H.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Ii,1,0);if(Lt.isString(e)){var n=H.alloc(r=t0.length(e));t0.decode(e,n,0),e=n}return this.uint32(r)._push(Of,r,e)};H.prototype.string=function(e){var r=e0.length(e);return r?this.uint32(r)._push(e0.write,r,e):this._push(Ii,1,0)};H.prototype.fork=function(){return this.states=new Uf(this),this.head=this.tail=new Ar(Ti,0,0),this.len=0,this};H.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Ar(Ti,0,0),this.len=0),this};H.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};H.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};H._configure=function(t){Ci=t,H.create=r0(),Ci._configure()}});var s0=C((h1,a0)=>{"use strict";a0.exports=$t;var i0=ki();($t.prototype=Object.create(i0.prototype)).constructor=$t;var Ae=Be();function $t(){i0.call(this)}$t._configure=function(){$t.alloc=Ae._Buffer_allocUnsafe,$t.writeBytesBuffer=Ae.Buffer&&Ae.Buffer.prototype instanceof Uint8Array&&Ae.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};$t.prototype.bytes=function(e){Ae.isString(e)&&(e=Ae._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push($t.writeBytesBuffer,r,e),this};function Ff(t,e,r){t.length<40?Ae.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}$t.prototype.string=function(e){var r=Ae.Buffer.byteLength(e);return this.uint32(r),r&&this._push(Ff,r,e),this};$t._configure()});var Li=C((l1,h0)=>{"use strict";h0.exports=ft;var Zt=Be(),Ni,o0=Zt.LongBits,Mf=Zt.utf8;function Ht(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function ft(t){this.buf=t,this.pos=0,this.len=t.length}var c0=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new ft(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new ft(e);throw Error("illegal buffer")},u0=function(){return Zt.Buffer?function(r){return(ft.create=function(i){return Zt.Buffer.isBuffer(i)?new Ni(i):c0(i)})(r)}:c0};ft.create=u0();ft.prototype._slice=Zt.Array.prototype.subarray||Zt.Array.prototype.slice;ft.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Ht(this,10);return e}}();ft.prototype.int32=function(){return this.uint32()|0};ft.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Pi(){var t=new o0(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Ht(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Ht(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}ft.prototype.bool=function(){return this.uint32()!==0};function xn(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}ft.prototype.fixed32=function(){if(this.pos+4>this.len)throw Ht(this,4);return xn(this.buf,this.pos+=4)};ft.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Ht(this,4);return xn(this.buf,this.pos+=4)|0};function f0(){if(this.pos+8>this.len)throw Ht(this,8);return new o0(xn(this.buf,this.pos+=4),xn(this.buf,this.pos+=4))}ft.prototype.float=function(){if(this.pos+4>this.len)throw Ht(this,4);var e=Zt.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};ft.prototype.double=function(){if(this.pos+8>this.len)throw Ht(this,4);var e=Zt.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};ft.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw Ht(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};ft.prototype.string=function(){var e=this.bytes();return Mf.read(e,0,e.length)};ft.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Ht(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Ht(this);while(this.buf[this.pos++]&128);return this};ft.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!=4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};ft._configure=function(t){Ni=t,ft.create=u0(),Ni._configure();var e=Zt.Long?"toLong":"toNumber";Zt.merge(ft.prototype,{int64:function(){return Pi.call(this)[e](!1)},uint64:function(){return Pi.call(this)[e](!0)},sint64:function(){return Pi.call(this).zzDecode()[e](!1)},fixed64:function(){return f0.call(this)[e](!0)},sfixed64:function(){return f0.call(this)[e](!1)}})}});var y0=C((p1,d0)=>{"use strict";d0.exports=qe;var l0=Li();(qe.prototype=Object.create(l0.prototype)).constructor=qe;var p0=Be();function qe(t){l0.call(this,t)}qe._configure=function(){p0.Buffer&&(qe.prototype._slice=p0.Buffer.prototype.slice)};qe.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};qe._configure()});var x0=C((d1,g0)=>{"use strict";g0.exports=Cr;var Ki=Be();(Cr.prototype=Object.create(Ki.EventEmitter.prototype)).constructor=Cr;function Cr(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");Ki.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}Cr.prototype.rpcCall=function t(e,r,n,i,a){if(!i)throw TypeError("request must be specified");var s=this;if(!a)return Ki.asPromise(t,s,e,r,n,i);if(!s.rpcImpl){setTimeout(function(){a(Error("already ended"))},0);return}try{return s.rpcImpl(e,r[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(u,c){if(u)return s.emit("error",u,e),a(u);if(c===null){s.end(!0);return}if(!(c instanceof n))try{c=n[s.responseDelimited?"decodeDelimited":"decode"](c)}catch(f){return s.emit("error",f,e),a(f)}return s.emit("data",c,e),a(null,c)})}catch(o){s.emit("error",o,e),setTimeout(function(){a(o)},0);return}};Cr.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var m0=C(v0=>{"use strict";var Vf=v0;Vf.Service=x0()});var w0=C((g1,b0)=>{"use strict";b0.exports={}});var B0=C(E0=>{"use strict";var Rt=E0;Rt.build="minimal";Rt.Writer=ki();Rt.BufferWriter=s0();Rt.Reader=Li();Rt.BufferReader=y0();Rt.util=Be();Rt.rpc=m0();Rt.roots=w0();Rt.configure=S0;function S0(){Rt.util._configure(),Rt.Writer._configure(Rt.BufferWriter),Rt.Reader._configure(Rt.BufferReader)}S0()});var C0=C((v1,A0)=>{"use strict";A0.exports=B0()});var mn=C((m1,I0)=>{"use strict";var Oe=C0(),vn=Oe.Reader,T0=Oe.Writer,wt=Oe.util,Kt=Oe.roots["libp2p-crypto-keys"]||(Oe.roots["libp2p-crypto-keys"]={});Kt.KeyType=function(){var t={},e=Object.create(t);return e[t[0]="RSA"]=0,e[t[1]="Ed25519"]=1,e[t[2]="Secp256k1"]=2,e}();Kt.PublicKey=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Type=0,t.prototype.Data=wt.newBuffer([]),t.encode=function(r,n){return n||(n=T0.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},t.decode=function(r,n){r instanceof vn||(r=vn.create(r));for(var i=n===void 0?r.len:r.pos+n,a=new Kt.PublicKey;r.pos<i;){var s=r.uint32();switch(s>>>3){case 1:a.Type=r.int32();break;case 2:a.Data=r.bytes();break;default:r.skipType(s&7);break}}if(!a.hasOwnProperty("Type"))throw wt.ProtocolError("missing required 'Type'",{instance:a});if(!a.hasOwnProperty("Data"))throw wt.ProtocolError("missing required 'Data'",{instance:a});return a},t.fromObject=function(r){if(r instanceof Kt.PublicKey)return r;var n=new Kt.PublicKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?wt.base64.decode(r.Data,n.Data=wt.newBuffer(wt.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=wt.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?Kt.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?wt.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Oe.util.toJSONOptions)},t}();Kt.PrivateKey=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Type=0,t.prototype.Data=wt.newBuffer([]),t.encode=function(r,n){return n||(n=T0.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},t.decode=function(r,n){r instanceof vn||(r=vn.create(r));for(var i=n===void 0?r.len:r.pos+n,a=new Kt.PrivateKey;r.pos<i;){var s=r.uint32();switch(s>>>3){case 1:a.Type=r.int32();break;case 2:a.Data=r.bytes();break;default:r.skipType(s&7);break}}if(!a.hasOwnProperty("Type"))throw wt.ProtocolError("missing required 'Type'",{instance:a});if(!a.hasOwnProperty("Data"))throw wt.ProtocolError("missing required 'Data'",{instance:a});return a},t.fromObject=function(r){if(r instanceof Kt.PrivateKey)return r;var n=new Kt.PrivateKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?wt.base64.decode(r.Data,n.Data=wt.newBuffer(wt.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=wt.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?Kt.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?wt.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Oe.util.toJSONOptions)},t}();I0.exports=Kt});var bn=C((b1,_0)=>{var Tr=Z();Tr.pki=Tr.pki||{};var Ui=_0.exports=Tr.pki.oids=Tr.oids=Tr.oids||{};function B(t,e){Ui[t]=e,Ui[e]=t}function j(t,e){Ui[t]=e}B("1.2.840.113549.1.1.1","rsaEncryption");B("1.2.840.113549.1.1.4","md5WithRSAEncryption");B("1.2.840.113549.1.1.5","sha1WithRSAEncryption");B("1.2.840.113549.1.1.7","RSAES-OAEP");B("1.2.840.113549.1.1.8","mgf1");B("1.2.840.113549.1.1.9","pSpecified");B("1.2.840.113549.1.1.10","RSASSA-PSS");B("1.2.840.113549.1.1.11","sha256WithRSAEncryption");B("1.2.840.113549.1.1.12","sha384WithRSAEncryption");B("1.2.840.113549.1.1.13","sha512WithRSAEncryption");B("1.3.101.112","EdDSA25519");B("1.2.840.10040.4.3","dsa-with-sha1");B("1.3.14.3.2.7","desCBC");B("1.3.14.3.2.26","sha1");B("1.3.14.3.2.29","sha1WithRSASignature");B("2.16.840.1.101.3.4.2.1","sha256");B("2.16.840.1.101.3.4.2.2","sha384");B("2.16.840.1.101.3.4.2.3","sha512");B("1.2.840.113549.2.5","md5");B("1.2.840.113549.1.7.1","data");B("1.2.840.113549.1.7.2","signedData");B("1.2.840.113549.1.7.3","envelopedData");B("1.2.840.113549.1.7.4","signedAndEnvelopedData");B("1.2.840.113549.1.7.5","digestedData");B("1.2.840.113549.1.7.6","encryptedData");B("1.2.840.113549.1.9.1","emailAddress");B("1.2.840.113549.1.9.2","unstructuredName");B("1.2.840.113549.1.9.3","contentType");B("1.2.840.113549.1.9.4","messageDigest");B("1.2.840.113549.1.9.5","signingTime");B("1.2.840.113549.1.9.6","counterSignature");B("1.2.840.113549.1.9.7","challengePassword");B("1.2.840.113549.1.9.8","unstructuredAddress");B("1.2.840.113549.1.9.14","extensionRequest");B("1.2.840.113549.1.9.20","friendlyName");B("1.2.840.113549.1.9.21","localKeyId");B("1.2.840.113549.1.9.22.1","x509Certificate");B("1.2.840.113549.1.12.10.1.1","keyBag");B("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");B("1.2.840.113549.1.12.10.1.3","certBag");B("1.2.840.113549.1.12.10.1.4","crlBag");B("1.2.840.113549.1.12.10.1.5","secretBag");B("1.2.840.113549.1.12.10.1.6","safeContentsBag");B("1.2.840.113549.1.5.13","pkcs5PBES2");B("1.2.840.113549.1.5.12","pkcs5PBKDF2");B("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");B("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");B("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");B("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");B("1.2.840.113549.2.7","hmacWithSHA1");B("1.2.840.113549.2.8","hmacWithSHA224");B("1.2.840.113549.2.9","hmacWithSHA256");B("1.2.840.113549.2.10","hmacWithSHA384");B("1.2.840.113549.2.11","hmacWithSHA512");B("1.2.840.113549.3.7","des-EDE3-CBC");B("2.16.840.1.101.3.4.1.2","aes128-CBC");B("2.16.840.1.101.3.4.1.22","aes192-CBC");B("2.16.840.1.101.3.4.1.42","aes256-CBC");B("2.5.4.3","commonName");B("2.5.4.4","surname");B("2.5.4.5","serialNumber");B("2.5.4.6","countryName");B("2.5.4.7","localityName");B("2.5.4.8","stateOrProvinceName");B("2.5.4.9","streetAddress");B("2.5.4.10","organizationName");B("2.5.4.11","organizationalUnitName");B("2.5.4.12","title");B("2.5.4.13","description");B("2.5.4.15","businessCategory");B("2.5.4.17","postalCode");B("2.5.4.42","givenName");B("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");B("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");B("2.16.840.1.113730.1.1","nsCertType");B("2.16.840.1.113730.1.13","nsComment");j("2.5.29.1","authorityKeyIdentifier");j("2.5.29.2","keyAttributes");j("2.5.29.3","certificatePolicies");j("2.5.29.4","keyUsageRestriction");j("2.5.29.5","policyMapping");j("2.5.29.6","subtreesConstraint");j("2.5.29.7","subjectAltName");j("2.5.29.8","issuerAltName");j("2.5.29.9","subjectDirectoryAttributes");j("2.5.29.10","basicConstraints");j("2.5.29.11","nameConstraints");j("2.5.29.12","policyConstraints");j("2.5.29.13","basicConstraints");B("2.5.29.14","subjectKeyIdentifier");B("2.5.29.15","keyUsage");j("2.5.29.16","privateKeyUsagePeriod");B("2.5.29.17","subjectAltName");B("2.5.29.18","issuerAltName");B("2.5.29.19","basicConstraints");j("2.5.29.20","cRLNumber");j("2.5.29.21","cRLReason");j("2.5.29.22","expirationDate");j("2.5.29.23","instructionCode");j("2.5.29.24","invalidityDate");j("2.5.29.25","cRLDistributionPoints");j("2.5.29.26","issuingDistributionPoint");j("2.5.29.27","deltaCRLIndicator");j("2.5.29.28","issuingDistributionPoint");j("2.5.29.29","certificateIssuer");j("2.5.29.30","nameConstraints");B("2.5.29.31","cRLDistributionPoints");B("2.5.29.32","certificatePolicies");j("2.5.29.33","policyMappings");j("2.5.29.34","policyConstraints");B("2.5.29.35","authorityKeyIdentifier");j("2.5.29.36","policyConstraints");B("2.5.29.37","extKeyUsage");j("2.5.29.46","freshestCRL");j("2.5.29.54","inhibitAnyPolicy");B("1.3.6.1.4.1.11129.2.4.2","timestampList");B("1.3.6.1.5.5.7.1.1","authorityInfoAccess");B("1.3.6.1.5.5.7.3.1","serverAuth");B("1.3.6.1.5.5.7.3.2","clientAuth");B("1.3.6.1.5.5.7.3.3","codeSigning");B("1.3.6.1.5.5.7.3.4","emailProtection");B("1.3.6.1.5.5.7.3.8","timeStamping")});var _r=C((w1,D0)=>{var nt=Z();ut();bn();var T=D0.exports=nt.asn1=nt.asn1||{};T.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};T.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};T.create=function(t,e,r,n,i){if(nt.util.isArray(n)){for(var a=[],s=0;s<n.length;++s)n[s]!==void 0&&a.push(n[s]);n=a}var o={tagClass:t,type:e,constructed:r,composed:r||nt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=T.copy(o)),o};T.copy=function(t,e){var r;if(nt.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(T.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:T.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};T.equals=function(t,e,r){if(nt.util.isArray(t)){if(!nt.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!T.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&T.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};T.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Ir(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var zf=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var a=r&127;Ir(t,e,a),n=t.getInt(a<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};T.fromDer=function(t,e){return e===void 0&&(e={strict:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=nt.util.createBuffer(t)),wn(t,t.length(),0,e)};function wn(t,e,r,n){var i;Ir(t,e,2);var a=t.getByte();e--;var s=a&192,o=a&31;i=t.length();var u=zf(t,e);if(e-=i-t.length(),u!==void 0&&u>e){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=t.length(),c.remaining=e,c.requested=u,c}u=e}var f,h,l=(a&32)==32;if(l)if(f=[],u===void 0)for(;;){if(Ir(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),f.push(wn(t,e,r+1,n)),e-=i-t.length()}else for(;u>0;)i=t.length(),f.push(wn(t,u,r+1,n)),e-=i-t.length(),u-=i-t.length();if(f===void 0&&s===T.Class.UNIVERSAL&&o===T.Type.BITSTRING&&(h=t.bytes(u)),f===void 0&&n.decodeBitStrings&&s===T.Class.UNIVERSAL&&o===T.Type.BITSTRING&&u>1){var d=t.read,p=e,g=0;if(o===T.Type.BITSTRING&&(Ir(t,e,1),g=t.getByte(),e--),g===0)try{i=t.length();var v={verbose:n.verbose,strict:!0,decodeBitStrings:!0},m=wn(t,e,r+1,v),E=i-t.length();e-=E,o==T.Type.BITSTRING&&E++;var A=m.tagClass;E===u&&(A===T.Class.UNIVERSAL||A===T.Class.CONTEXT_SPECIFIC)&&(f=[m])}catch(I){}f===void 0&&(t.read=d,e=p)}if(f===void 0){if(u===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");u=e}if(o===T.Type.BMPSTRING)for(f="";u>0;u-=2)Ir(t,e,2),f+=String.fromCharCode(t.getInt16()),e-=2;else f=t.getBytes(u)}var N=h===void 0?null:{bitStringContents:h};return T.create(s,o,l,f,N)}T.toDer=function(t){var e=nt.util.createBuffer(),r=t.tagClass|t.type,n=nt.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=T.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var a=0;a<t.value.length;++a)t.value[a]!==void 0&&n.putBuffer(T.toDer(t.value[a]))}else if(t.type===T.Type.BMPSTRING)for(var a=0;a<t.value.length;++a)n.putInt16(t.value.charCodeAt(a));else t.type===T.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)==0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)==128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var s=n.length(),o="";do o+=String.fromCharCode(s&255),s=s>>>8;while(s>0);e.putByte(o.length|128);for(var a=o.length-1;a>=0;--a)e.putByte(o.charCodeAt(a))}return e.putBuffer(n),e};T.oidToDer=function(t){var e=t.split("."),r=nt.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,a,s,o=2;o<e.length;++o){n=!0,i=[],a=parseInt(e[o],10);do s=a&127,a=a>>>7,n||(s|=128),i.push(s),n=!1;while(a>0);for(var u=i.length-1;u>=0;--u)r.putByte(i[u])}return r};T.derToOid=function(t){var e;typeof t=="string"&&(t=nt.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};T.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),a=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=0;if(t.length>11){var u=t.charAt(10),c=10;u!=="+"&&u!=="-"&&(o=parseInt(t.substr(10,2),10),c+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(a,s,o,0),c&&(u=t.charAt(c),u==="+"||u==="-")){var f=parseInt(t.substr(c+1,2),10),h=parseInt(t.substr(c+4,2),10),l=f*60+h;l*=6e4,u==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};T.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),s=parseInt(t.substr(10,2),10),o=parseInt(t.substr(12,2),10),u=0,c=0,f=!1;t.charAt(t.length-1)==="Z"&&(f=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var d=parseInt(t.substr(h+1,2),10),p=parseInt(t.substr(h+4,2),10);c=d*60+p,c*=6e4,l==="+"&&(c*=-1),f=!0}return t.charAt(14)==="."&&(u=parseFloat(t.substr(14),10)*1e3),f?(e.setUTCFullYear(r,n,i),e.setUTCHours(a,s,o,u),e.setTime(+e+c)):(e.setFullYear(r,n,i),e.setHours(a,s,o,u)),e};T.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};T.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};T.integerToDer=function(t){var e=nt.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};T.derToInteger=function(t){typeof t=="string"&&(t=nt.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};T.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(t.type===e.type||typeof e.type=="undefined"))if(t.constructed===e.constructed||typeof e.constructed=="undefined"){if(i=!0,e.value&&nt.util.isArray(e.value))for(var a=0,s=0;i&&s<e.value.length;++s)i=e.value[s].optional||!1,t.value[a]&&(i=T.validate(t.value[a],e.value[s],r,n),i?++a:e.value[s].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var o;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var u=t.bitStringContents.charCodeAt(0);if(u!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var R0=/[^\\u0000-\\u00ff]/;T.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",a=0;a<e*r;++a)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case T.Class.UNIVERSAL:n+="Universal:";break;case T.Class.APPLICATION:n+="Application:";break;case T.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case T.Class.PRIVATE:n+="Private:";break}if(t.tagClass===T.Class.UNIVERSAL)switch(n+=t.type,t.type){case T.Type.NONE:n+=" (None)";break;case T.Type.BOOLEAN:n+=" (Boolean)";break;case T.Type.INTEGER:n+=" (Integer)";break;case T.Type.BITSTRING:n+=" (Bit string)";break;case T.Type.OCTETSTRING:n+=" (Octet string)";break;case T.Type.NULL:n+=" (Null)";break;case T.Type.OID:n+=" (Object Identifier)";break;case T.Type.ODESC:n+=" (Object Descriptor)";break;case T.Type.EXTERNAL:n+=" (External or Instance of)";break;case T.Type.REAL:n+=" (Real)";break;case T.Type.ENUMERATED:n+=" (Enumerated)";break;case T.Type.EMBEDDED:n+=" (Embedded PDV)";break;case T.Type.UTF8:n+=" (UTF8)";break;case T.Type.ROID:n+=" (Relative Object Identifier)";break;case T.Type.SEQUENCE:n+=" (Sequence)";break;case T.Type.SET:n+=" (Set)";break;case T.Type.PRINTABLESTRING:n+=" (Printable String)";break;case T.Type.IA5String:n+=" (IA5String (ASCII))";break;case T.Type.UTCTIME:n+=" (UTC time)";break;case T.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case T.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var s=0,o="",a=0;a<t.value.length;++a)t.value[a]!==void 0&&(s+=1,o+=T.prettyPrint(t.value[a],e+1,r),a+1<t.value.length&&(o+=","));n+=i+"Sub values: "+s+o}else{if(n+=i+"Value: ",t.type===T.Type.OID){var u=T.derToOid(t.value);n+=u,nt.pki&&nt.pki.oids&&u in nt.pki.oids&&(n+=" ("+nt.pki.oids[u]+") ")}if(t.type===T.Type.INTEGER)try{n+=T.derToInteger(t.value)}catch(f){n+="0x"+nt.util.bytesToHex(t.value)}else if(t.type===T.Type.BITSTRING){if(t.value.length>1?n+="0x"+nt.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var c=t.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else t.type===T.Type.OCTETSTRING?(R0.test(t.value)||(n+="("+t.value+") "),n+="0x"+nt.util.bytesToHex(t.value)):t.type===T.Type.UTF8?n+=nt.util.decodeUtf8(t.value):t.type===T.Type.PRINTABLESTRING||t.type===T.Type.IA5String?n+=t.value:R0.test(t.value)?n+="0x"+nt.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var P0=C((S1,N0)=>{var it=Z();ni();ai();ut();N0.exports=it.des=it.des||{};it.des.startEncrypting=function(t,e,r,n){var i=Sn({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};it.des.createEncryptionCipher=function(t,e){return Sn({key:t,output:null,decrypt:!1,mode:e})};it.des.startDecrypting=function(t,e,r,n){var i=Sn({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};it.des.createDecryptionCipher=function(t,e){return Sn({key:t,output:null,decrypt:!0,mode:e})};it.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return k0(r._keys,n,i,!1)},decrypt:function(n,i){return k0(r._keys,n,i,!0)}}}),r._init=!1};it.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=it.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Xf(e),this._init=!0}};Qt("DES-ECB",it.cipher.modes.ecb);Qt("DES-CBC",it.cipher.modes.cbc);Qt("DES-CFB",it.cipher.modes.cfb);Qt("DES-OFB",it.cipher.modes.ofb);Qt("DES-CTR",it.cipher.modes.ctr);Qt("3DES-ECB",it.cipher.modes.ecb);Qt("3DES-CBC",it.cipher.modes.cbc);Qt("3DES-CFB",it.cipher.modes.cfb);Qt("3DES-OFB",it.cipher.modes.ofb);Qt("3DES-CTR",it.cipher.modes.ctr);function Qt(t,e){var r=function(){return new it.des.Algorithm(t,e)};it.cipher.registerAlgorithm(t,r)}var Hf=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Gf=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Wf=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Yf=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],jf=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],$f=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Zf=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Qf=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Xf(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],f=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,v=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,A,N=0;N<g;N++){var I=t.getInt32(),_=t.getInt32();A=(I>>>4^_)&252645135,_^=A,I^=A<<4,A=(_>>>-16^I)&65535,I^=A,_^=A<<-16,A=(I>>>2^_)&858993459,_^=A,I^=A<<2,A=(_>>>-16^I)&65535,I^=A,_^=A<<-16,A=(I>>>1^_)&1431655765,_^=A,I^=A<<1,A=(_>>>8^I)&16711935,I^=A,_^=A<<8,A=(I>>>1^_)&1431655765,_^=A,I^=A<<1,A=I<<8|_>>>20&240,I=_<<24|_<<8&16711680|_>>>8&65280|_>>>24&240,_=A;for(var q=0;q<m.length;++q){m[q]?(I=I<<2|I>>>26,_=_<<2|_>>>26):(I=I<<1|I>>>27,_=_<<1|_>>>27),I&=-15,_&=-15;var z=e[I>>>28]|r[I>>>24&15]|n[I>>>20&15]|i[I>>>16&15]|a[I>>>12&15]|s[I>>>8&15]|o[I>>>4&15],dt=u[_>>>28]|c[_>>>24&15]|f[_>>>20&15]|h[_>>>16&15]|l[_>>>12&15]|d[_>>>8&15]|p[_>>>4&15];A=(dt>>>16^z)&65535,v[E++]=z^A,v[E++]=dt^A<<16}}return v}function k0(t,e,r,n){var i=t.length===32?3:9,a;i===3?a=n?[30,-2,-2]:[0,32,2]:a=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,o=e[0],u=e[1];s=(o>>>4^u)&252645135,u^=s,o^=s<<4,s=(o>>>16^u)&65535,u^=s,o^=s<<16,s=(u>>>2^o)&858993459,o^=s,u^=s<<2,s=(u>>>8^o)&16711935,o^=s,u^=s<<8,s=(o>>>1^u)&1431655765,u^=s,o^=s<<1,o=o<<1|o>>>31,u=u<<1|u>>>31;for(var c=0;c<i;c+=3){for(var f=a[c+1],h=a[c+2],l=a[c];l!=f;l+=h){var d=u^t[l],p=(u>>>4|u<<28)^t[l+1];s=o,o=u,u=s^(Gf[d>>>24&63]|Yf[d>>>16&63]|$f[d>>>8&63]|Qf[d&63]|Hf[p>>>24&63]|Wf[p>>>16&63]|jf[p>>>8&63]|Zf[p&63])}s=o,o=u,u=s}o=o>>>1|o<<31,u=u>>>1|u<<31,s=(o>>>1^u)&1431655765,u^=s,o^=s<<1,s=(u>>>8^o)&16711935,o^=s,u^=s<<8,s=(u>>>2^o)&858993459,o^=s,u^=s<<2,s=(o>>>16^u)&65535,u^=s,o^=s<<16,s=(o>>>4^u)&252645135,u^=s,o^=s<<4,r[0]=o,r[1]=u}function Sn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=it.cipher.createDecipher(r,t.key):n=it.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof it.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});var Fe=C((E1,L0)=>{var En=Z();L0.exports=En.md=En.md||{};En.md.algorithms=En.md.algorithms||{}});var U0=C((B1,K0)=>{var ce=Z();Fe();ut();var Jf=K0.exports=ce.hmac=ce.hmac||{};Jf.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(a,s){if(a!==null)if(typeof a=="string")if(a=a.toLowerCase(),a in ce.md.algorithms)e=ce.md.algorithms[a].create();else throw new Error('Unknown hash algorithm "'+a+'"');else e=a;if(s===null)s=t;else{if(typeof s=="string")s=ce.util.createBuffer(s);else if(ce.util.isArray(s)){var o=s;s=ce.util.createBuffer();for(var u=0;u<o.length;++u)s.putByte(o[u])}var c=s.length();c>e.blockLength&&(e.start(),e.update(s.bytes()),s=e.digest()),r=ce.util.createBuffer(),n=ce.util.createBuffer(),c=s.length();for(var u=0;u<c;++u){var o=s.at(u);r.putByte(54^o),n.putByte(92^o)}if(c<e.blockLength)for(var o=e.blockLength-c,u=0;u<o;++u)r.putByte(54),n.putByte(92);t=s,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(a){e.update(a)},i.getMac=function(){var a=e.digest().bytes();return e.start(),e.update(n),e.update(a),e.digest()},i.digest=i.getMac,i}});var sr=C(()=>{});var qi=C((T1,q0)=>{var Tt=Z();U0();Fe();ut();var th=Tt.pkcs5=Tt.pkcs5||{},ue;Tt.util.isNodejs&&!Tt.options.usePureJavaScript&&(ue=sr());q0.exports=Tt.pbkdf2=th.pbkdf2=function(t,e,r,n,i,a){if(typeof i=="function"&&(a=i,i=null),Tt.util.isNodejs&&!Tt.options.usePureJavaScript&&ue.pbkdf2&&(i===null||typeof i!="object")&&(ue.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),a?ue.pbkdf2Sync.length===4?ue.pbkdf2(t,e,r,n,function(A,N){if(A)return a(A);a(null,N.toString("binary"))}):ue.pbkdf2(t,e,r,n,i,function(A,N){if(A)return a(A);a(null,N.toString("binary"))}):ue.pbkdf2Sync.length===4?ue.pbkdf2Sync(t,e,r,n).toString("binary"):ue.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i=="undefined"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Tt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Tt.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var o=new Error("Derived key is too long.");if(a)return a(o);throw o}var u=Math.ceil(n/s),c=n-(u-1)*s,f=Tt.hmac.create();f.start(i,t);var h="",l,d,p;if(!a){for(var g=1;g<=u;++g){f.start(null,null),f.update(e),f.update(Tt.util.int32ToBytes(g)),l=p=f.digest().getBytes();for(var v=2;v<=r;++v)f.start(null,null),f.update(p),d=f.digest().getBytes(),l=Tt.util.xorBytes(l,d,s),p=d;h+=g<u?l:l.substr(0,c)}return h}var g=1,v;function m(){if(g>u)return a(null,h);f.start(null,null),f.update(e),f.update(Tt.util.int32ToBytes(g)),l=p=f.digest().getBytes(),v=2,E()}function E(){if(v<=r)return f.start(null,null),f.update(p),d=f.digest().getBytes(),l=Tt.util.xorBytes(l,d,s),p=d,++v,Tt.util.setImmediate(E);h+=g<u?l:l.substr(0,c),++g,m()}m()}});var M0=C((I1,F0)=>{var Bn=Z();ut();var O0=F0.exports=Bn.pem=Bn.pem||{};O0.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=An(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=An(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=An(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=An(t.headers[i]);return t.procType&&(r+=`\r
`),r+=Bn.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};O0.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,a;a=r.exec(t),!!a;){var s=a[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var o={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Bn.util.decode64(a[3])};if(e.push(o),!!a[2]){for(var u=a[2].split(i),c=0;a&&c<u.length;){for(var f=u[c].replace(/\s+$/,""),h=c+1;h<u.length;++h){var l=u[h];if(!/\s/.test(l[0]))break;f+=l,c=h}if(a=f.match(n),a){for(var d={name:a[1],values:[]},p=a[2].split(","),g=0;g<p.length;++g)d.values.push(eh(p[g]));if(o.procType)if(!o.contentDomain&&d.name==="Content-Domain")o.contentDomain=p[0]||"";else if(!o.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:p[0],parameters:p[1]||null}}else o.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:p[0],type:p[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function An(t){for(var e=t.name+": ",r=[],n=function(u,c){return" "+c},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var a=0,s=-1,i=0;i<e.length;++i,++a)if(a>65&&s!==-1){var o=e[s];o===","?(++s,e=e.substr(0,s)+`\r
 `+e.substr(s)):e=e.substr(0,s)+`\r
`+o+e.substr(s+1),a=i-s-1,s=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(s=i);return e}function eh(t){return t.replace(/^\s+/,"")}});var Y0=C((_1,W0)=>{var Xt=Z();Fe();ut();var V0=W0.exports=Xt.sha256=Xt.sha256||{};Xt.md.sha256=Xt.md.algorithms.sha256=V0;V0.create=function(){z0||rh();var t=null,e=Xt.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=Xt.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=Xt.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),G0(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Xt.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(Oi.substr(0,n.blockLength-s));for(var o,u,c=n.fullMessageLength[0]*8,f=0;f<n.fullMessageLength.length-1;++f)o=n.fullMessageLength[f+1]*8,u=o/4294967296>>>0,c+=u,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};G0(h,r,i);var l=Xt.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var Oi=null,z0=!1,H0=null;function rh(){Oi=String.fromCharCode(128),Oi+=Xt.util.fillString(String.fromCharCode(0),64),H0=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],z0=!0}function G0(t,e,r){for(var n,i,a,s,o,u,c,f,h,l,d,p,g,v,m,E=r.length();E>=64;){for(c=0;c<16;++c)e[c]=r.getInt32();for(;c<64;++c)n=e[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[c]=n+e[c-7]+i+e[c-16]|0;for(f=t.h0,h=t.h1,l=t.h2,d=t.h3,p=t.h4,g=t.h5,v=t.h6,m=t.h7,c=0;c<64;++c)s=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),o=v^p&(g^v),a=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),u=f&h|l&(f^h),n=m+s+o+H0[c]+e[c],i=a+u,m=v,v=g,g=p,p=d+n>>>0,d=l,l=h,h=f,f=n+i>>>0;t.h0=t.h0+f|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+d|0,t.h4=t.h4+p|0,t.h5=t.h5+g|0,t.h6=t.h6+v|0,t.h7=t.h7+m|0,E-=64}}});var $0=C((R1,j0)=>{var Jt=Z();ut();var Cn=null;Jt.util.isNodejs&&!Jt.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Cn=sr());var nh=j0.exports=Jt.prng=Jt.prng||{};nh.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(c,f){if(!f)return e.generateSync(c);var h=e.plugin.cipher,l=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed,g=Jt.util.createBuffer();e.key=null,v();function v(m){if(m)return f(m);if(g.length()>=c)return f(null,g.getBytes(c));if(e.generated>1048575&&(e.key=null),e.key===null)return Jt.util.nextTick(function(){a(v)});var E=h(e.key,e.seed);e.generated+=E.length,g.putBytes(E),e.key=d(h(e.key,l(e.seed))),e.seed=p(h(e.key,e.seed)),Jt.util.setImmediate(v)}},e.generateSync=function(c){var f=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,d=e.plugin.formatSeed;e.key=null;for(var p=Jt.util.createBuffer();p.length()<c;){e.generated>1048575&&(e.key=null),e.key===null&&s();var g=f(e.key,e.seed);e.generated+=g.length,p.putBytes(g),e.key=l(f(e.key,h(e.seed))),e.seed=d(f(e.key,e.seed))}return p.getBytes(c)};function a(c){if(e.pools[0].messageLength>=32)return o(),c();var f=32-e.pools[0].messageLength<<5;e.seedFile(f,function(h,l){if(h)return c(h);e.collect(l),o(),c()})}function s(){if(e.pools[0].messageLength>=32)return o();var c=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(c)),o()}function o(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var c=e.plugin.md.create();c.update(e.keyBytes);for(var f=1,h=0;h<32;++h)e.reseeds%f==0&&(c.update(e.pools[h].digest().getBytes()),e.pools[h].start()),f=f<<1;e.keyBytes=c.digest().getBytes(),c.start(),c.update(e.keyBytes);var l=c.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function u(c){var f=null,h=Jt.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(f=function(I){return l.getRandomValues(I)});var d=Jt.util.createBuffer();if(f)for(;d.length()<c;){var p=Math.max(1,Math.min(c-d.length(),65536)/4),g=new Uint32Array(Math.floor(p));try{f(g);for(var v=0;v<g.length;++v)d.putInt32(g[v])}catch(I){if(!(typeof QuotaExceededError!="undefined"&&I instanceof QuotaExceededError))throw I}}if(d.length()<c)for(var m,E,A,N=Math.floor(Math.random()*65536);d.length()<c;){E=16807*(N&65535),m=16807*(N>>16),E+=(m&32767)<<16,E+=m>>15,E=(E&2147483647)+(E>>31),N=E&4294967295;for(var v=0;v<3;++v)A=N>>>(v<<3),A^=Math.floor(Math.random()*256),d.putByte(A&255)}return d.getBytes(c)}return Cn?(e.seedFile=function(c,f){Cn.randomBytes(c,function(h,l){if(h)return f(h);f(null,l.toString())})},e.seedFileSync=function(c){return Cn.randomBytes(c).toString()}):(e.seedFile=function(c,f){try{f(null,u(c))}catch(h){f(h)}},e.seedFileSync=u),e.collect=function(c){for(var f=c.length,h=0;h<f;++h)e.pools[e.pool].update(c.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(c,f){for(var h="",l=0;l<f;l+=8)h+=String.fromCharCode(c>>l&255);e.collect(h)},e.registerWorker=function(c){if(c===self)e.seedFile=function(h,l){function d(p){var g=p.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",d),l(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var f=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(d,p){c.postMessage({forge:{prng:{err:d,bytes:p}}})})};c.addEventListener("message",f)}},e}});var Rr=C((D1,Fi)=>{var mt=Z();rn();Y0();$0();ut();(function(){if(mt.random&&mt.random.getBytes){Fi.exports=mt.random;return}(function(t){var e={},r=new Array(4),n=mt.util.createBuffer();e.formatKey=function(h){var l=mt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),mt.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=mt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return mt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=mt.md.sha256;function i(){var h=mt.prng.create(e);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var a=i(),s=null,o=mt.util.globalScope,u=o.crypto||o.msCrypto;if(u&&u.getRandomValues&&(s=function(h){return u.getRandomValues(h)}),mt.options.usePureJavaScript||!mt.util.isNodejs&&!s){if(typeof window=="undefined"||window.document===void 0,a.collectInt(+new Date,32),typeof navigator!="undefined"){var c="";for(var f in navigator)try{typeof navigator[f]=="string"&&(c+=navigator[f])}catch(h){}a.collect(c),c=null}t&&(t().mousemove(function(h){a.collectInt(h.clientX,16),a.collectInt(h.clientY,16)}),t().keypress(function(h){a.collectInt(h.charCode,8)}))}if(!mt.random)mt.random=a;else for(var f in a)mt.random[f]=a[f];mt.random.createInstance=i,Fi.exports=mt.random})(typeof jQuery!="undefined"?jQuery:null)})()});var J0=C((k1,X0)=>{var Dt=Z();ut();var Mi=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Z0=[1,2,3,5],ih=function(t,e){return t<<e&65535|(t&65535)>>16-e},ah=function(t,e){return(t&65535)>>e|t<<16-e&65535};X0.exports=Dt.rc2=Dt.rc2||{};Dt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Dt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,a=Math.ceil(i/8),s=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(Mi[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-a,Mi[r.at(128-a)&s]),o=127-a;o>=0;o--)r.setAt(o,Mi[r.at(o+1)^r.at(o+a)]);return r};var Q0=function(t,e,r){var n=!1,i=null,a=null,s=null,o,u,c,f,h=[];for(t=Dt.rc2.expandKey(t,e),c=0;c<64;c++)h.push(t.getInt16Le());r?(o=function(p){for(c=0;c<4;c++)p[c]+=h[f]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),p[c]=ih(p[c],Z0[c]),f++},u=function(p){for(c=0;c<4;c++)p[c]+=h[p[(c+3)%4]&63]}):(o=function(p){for(c=3;c>=0;c--)p[c]=ah(p[c],Z0[c]),p[c]-=h[f]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),f--},u=function(p){for(c=3;c>=0;c--)p[c]-=h[p[(c+3)%4]&63]});var l=function(p){var g=[];for(c=0;c<4;c++){var v=i.getInt16Le();s!==null&&(r?v^=s.getInt16Le():s.putInt16Le(v)),g.push(v&65535)}f=r?0:63;for(var m=0;m<p.length;m++)for(var E=0;E<p[m][0];E++)p[m][1](g);for(c=0;c<4;c++)s!==null&&(r?s.putInt16Le(g[c]):g[c]^=s.getInt16Le()),a.putInt16Le(g[c])},d=null;return d={start:function(p,g){p&&typeof p=="string"&&(p=Dt.util.createBuffer(p)),n=!1,i=Dt.util.createBuffer(),a=g||new Dt.util.createBuffer,s=p,d.output=a},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,o],[1,u],[6,o],[1,u],[5,o]])},finish:function(p){var g=!0;if(r)if(p)g=p(8,i,!r);else{var v=i.length()===8?8:8-i.length();i.fillWithByte(v,v)}if(g&&(n=!0,d.update()),!r&&(g=i.length()===0,g))if(p)g=p(8,a,!r);else{var m=a.length(),E=a.at(m-1);E>m?g=!1:a.truncate(E)}return g}},d};Dt.rc2.startEncrypting=function(t,e,r){var n=Dt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Dt.rc2.createEncryptionCipher=function(t,e){return Q0(t,e,!0)};Dt.rc2.startDecrypting=function(t,e,r){var n=Dt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Dt.rc2.createDecryptionCipher=function(t,e){return Q0(t,e,!1)}});var _n=C((N1,oo)=>{var Vi=Z();oo.exports=Vi.jsbn=Vi.jsbn||{};var fe,sh=244837814094590,to=(sh&16777215)==15715070;function S(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}Vi.jsbn.BigInteger=S;function G(){return new S(null)}function oh(t,e,r,n,i,a){for(;--a>=0;){var s=e*this.data[t++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function ch(t,e,r,n,i,a){for(var s=e&32767,o=e>>15;--a>=0;){var u=this.data[t]&32767,c=this.data[t++]>>15,f=o*u+c*s;u=s*u+((f&32767)<<15)+r.data[n]+(i&1073741823),i=(u>>>30)+(f>>>15)+o*c+(i>>>30),r.data[n++]=u&1073741823}return i}function eo(t,e,r,n,i,a){for(var s=e&16383,o=e>>14;--a>=0;){var u=this.data[t]&16383,c=this.data[t++]>>14,f=o*u+c*s;u=s*u+((f&16383)<<14)+r.data[n]+i,i=(u>>28)+(f>>14)+o*c,r.data[n++]=u&268435455}return i}typeof navigator=="undefined"?(S.prototype.am=eo,fe=28):to&&navigator.appName=="Microsoft Internet Explorer"?(S.prototype.am=ch,fe=30):to&&navigator.appName!="Netscape"?(S.prototype.am=oh,fe=26):(S.prototype.am=eo,fe=28);S.prototype.DB=fe;S.prototype.DM=(1<<fe)-1;S.prototype.DV=1<<fe;var zi=52;S.prototype.FV=Math.pow(2,zi);S.prototype.F1=zi-fe;S.prototype.F2=2*fe-zi;var uh="0123456789abcdefghijklmnopqrstuvwxyz",Tn=new Array,or,Ut;or="0".charCodeAt(0);for(Ut=0;Ut<=9;++Ut)Tn[or++]=Ut;or="a".charCodeAt(0);for(Ut=10;Ut<36;++Ut)Tn[or++]=Ut;or="A".charCodeAt(0);for(Ut=10;Ut<36;++Ut)Tn[or++]=Ut;function ro(t){return uh.charAt(t)}function no(t,e){var r=Tn[t.charCodeAt(e)];return r??-1}function fh(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function hh(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Ce(t){var e=G();return e.fromInt(t),e}function lh(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,a=0;--n>=0;){var s=r==8?t[n]&255:no(t,n);if(s<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,a==0?this.data[this.t++]=s:a+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this.data[this.t++]=s>>this.DB-a):this.data[this.t-1]|=s<<a,a+=r,a>=this.DB&&(a-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,a>0&&(this.data[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&S.ZERO.subTo(this,this)}function ph(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function dh(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,a="",s=this.t,o=this.DB-s*this.DB%e;if(s-- >0)for(o<this.DB&&(n=this.data[s]>>o)>0&&(i=!0,a=ro(n));s>=0;)o<e?(n=(this.data[s]&(1<<o)-1)<<e-o,n|=this.data[--s]>>(o+=this.DB-e)):(n=this.data[s]>>(o-=e)&r,o<=0&&(o+=this.DB,--s)),n>0&&(i=!0),i&&(a+=ro(n));return i?a:"0"}function yh(){var t=G();return S.ZERO.subTo(this,t),t}function gh(){return this.s<0?this.negate():this}function xh(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function In(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function vh(){return this.t<=0?0:this.DB*(this.t-1)+In(this.data[this.t-1]^this.s&this.DM)}function mh(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function bh(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function wh(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,a=Math.floor(t/this.DB),s=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)e.data[o+a+1]=this.data[o]>>n|s,s=(this.data[o]&i)<<r;for(o=a-1;o>=0;--o)e.data[o]=0;e.data[a]=s,e.t=this.t+a+1,e.s=this.s,e.clamp()}function Sh(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,a=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&a)<<i,e.data[s-r]=this.data[s]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&a)<<i),e.t=this.t-r,e.clamp()}function Eh(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function Bh(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&S.ZERO.subTo(e,e)}function Ah(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function Ch(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e!=null&&e.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=G());var a=G(),s=this.s,o=t.s,u=this.DB-In(n.data[n.t-1]);u>0?(n.lShiftTo(u,a),i.lShiftTo(u,r)):(n.copyTo(a),i.copyTo(r));var c=a.t,f=a.data[c-1];if(f!=0){var h=f*(1<<this.F1)+(c>1?a.data[c-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,g=r.t,v=g-c,m=e??G();for(a.dlShiftTo(v,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),S.ONE.dlShiftTo(c,m),m.subTo(a,a);a.t<c;)a.data[a.t++]=0;for(;--v>=0;){var E=r.data[--g]==f?this.DM:Math.floor(r.data[g]*l+(r.data[g-1]+p)*d);if((r.data[g]+=a.am(0,E,r,v,0,c))<E)for(a.dlShiftTo(v,m),r.subTo(m,r);r.data[g]<--E;)r.subTo(m,r)}e!=null&&(r.drShiftTo(c,e),s!=o&&S.ZERO.subTo(e,e)),r.t=c,r.clamp(),u>0&&r.rShiftTo(u,r),s<0&&S.ZERO.subTo(r,r)}}}function Th(t){var e=G();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(S.ZERO)>0&&t.subTo(e,e),e}function Me(t){this.m=t}function Ih(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function _h(t){return t}function Rh(t){t.divRemTo(this.m,null,t)}function Dh(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function kh(t,e){t.squareTo(e),this.reduce(e)}Me.prototype.convert=Ih;Me.prototype.revert=_h;Me.prototype.reduce=Rh;Me.prototype.mulTo=Dh;Me.prototype.sqrTo=kh;function Nh(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Ve(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Ph(t){var e=G();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(S.ZERO)>0&&this.m.subTo(e,e),e}function Lh(t){var e=G();return t.copyTo(e),this.reduce(e),e}function Kh(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function Uh(t,e){t.squareTo(e),this.reduce(e)}function qh(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Ve.prototype.convert=Ph;Ve.prototype.revert=Lh;Ve.prototype.reduce=Kh;Ve.prototype.mulTo=qh;Ve.prototype.sqrTo=Uh;function Oh(){return(this.t>0?this.data[0]&1:this.s)==0}function Fh(t,e){if(t>4294967295||t<1)return S.ONE;var r=G(),n=G(),i=e.convert(this),a=In(t)-1;for(i.copyTo(r);--a>=0;)if(e.sqrTo(r,n),(t&1<<a)>0)e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)}function Mh(t,e){var r;return t<256||e.isEven()?r=new Me(e):r=new Ve(e),this.exp(t,r)}S.prototype.copyTo=fh;S.prototype.fromInt=hh;S.prototype.fromString=lh;S.prototype.clamp=ph;S.prototype.dlShiftTo=mh;S.prototype.drShiftTo=bh;S.prototype.lShiftTo=wh;S.prototype.rShiftTo=Sh;S.prototype.subTo=Eh;S.prototype.multiplyTo=Bh;S.prototype.squareTo=Ah;S.prototype.divRemTo=Ch;S.prototype.invDigit=Nh;S.prototype.isEven=Oh;S.prototype.exp=Fh;S.prototype.toString=dh;S.prototype.negate=yh;S.prototype.abs=gh;S.prototype.compareTo=xh;S.prototype.bitLength=vh;S.prototype.mod=Th;S.prototype.modPowInt=Mh;S.ZERO=Ce(0);S.ONE=Ce(1);function Vh(){var t=G();return this.copyTo(t),t}function zh(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Hh(){return this.t==0?this.s:this.data[0]<<24>>24}function Gh(){return this.t==0?this.s:this.data[0]<<16>>16}function Wh(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Yh(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function jh(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Ce(r),i=G(),a=G(),s="";for(this.divRemTo(n,i,a);i.signum()>0;)s=(r+a.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,a);return a.intValue().toString(t)+s}function $h(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,a=0,s=0,o=0;o<t.length;++o){var u=no(t,o);if(u<0){t.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+u,++a>=r&&(this.dMultiply(n),this.dAddOffset(s,0),a=0,s=0)}a>0&&(this.dMultiply(Math.pow(e,a)),this.dAddOffset(s,0)),i&&S.ZERO.subTo(this,this)}function Zh(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(S.ONE.shiftLeft(t-1),Hi,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(S.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Qh(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function Xh(t){return this.compareTo(t)==0}function Jh(t){return this.compareTo(t)<0?this:t}function tl(t){return this.compareTo(t)>0?this:t}function el(t,e,r){var n,i,a=Math.min(t.t,this.t);for(n=0;n<a;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=a;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=a;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function rl(t,e){return t&e}function nl(t){var e=G();return this.bitwiseTo(t,rl,e),e}function Hi(t,e){return t|e}function il(t){var e=G();return this.bitwiseTo(t,Hi,e),e}function io(t,e){return t^e}function al(t){var e=G();return this.bitwiseTo(t,io,e),e}function ao(t,e){return t&~e}function sl(t){var e=G();return this.bitwiseTo(t,ao,e),e}function ol(){for(var t=G(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function cl(t){var e=G();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function ul(t){var e=G();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function fl(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function hl(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+fl(this.data[t]);return this.s<0?this.t*this.DB:-1}function ll(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function pl(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=ll(this.data[r]^e);return t}function dl(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function yl(t,e){var r=S.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function gl(t){return this.changeBit(t,Hi)}function xl(t){return this.changeBit(t,ao)}function vl(t){return this.changeBit(t,io)}function ml(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function bl(t){var e=G();return this.addTo(t,e),e}function wl(t){var e=G();return this.subTo(t,e),e}function Sl(t){var e=G();return this.multiplyTo(t,e),e}function El(t){var e=G();return this.divRemTo(t,e,null),e}function Bl(t){var e=G();return this.divRemTo(t,null,e),e}function Al(t){var e=G(),r=G();return this.divRemTo(t,e,r),new Array(e,r)}function Cl(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Tl(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Dr(){}function so(t){return t}function Il(t,e,r){t.multiplyTo(e,r)}function _l(t,e){t.squareTo(e)}Dr.prototype.convert=so;Dr.prototype.revert=so;Dr.prototype.mulTo=Il;Dr.prototype.sqrTo=_l;function Rl(t){return this.exp(t,new Dr)}function Dl(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function kl(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function cr(t){this.r2=G(),this.q3=G(),S.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Nl(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=G();return t.copyTo(e),this.reduce(e),e}function Pl(t){return t}function Ll(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Kl(t,e){t.squareTo(e),this.reduce(e)}function Ul(t,e,r){t.multiplyTo(e,r),this.reduce(r)}cr.prototype.convert=Nl;cr.prototype.revert=Pl;cr.prototype.reduce=Ll;cr.prototype.mulTo=Ul;cr.prototype.sqrTo=Kl;function ql(t,e){var r=t.bitLength(),n,i=Ce(1),a;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?a=new Me(e):e.isEven()?a=new cr(e):a=new Ve(e);var s=new Array,o=3,u=n-1,c=(1<<n)-1;if(s[1]=a.convert(this),n>1){var f=G();for(a.sqrTo(s[1],f);o<=c;)s[o]=G(),a.mulTo(f,s[o-2],s[o]),o+=2}var h=t.t-1,l,d=!0,p=G(),g;for(r=In(t.data[h])-1;h>=0;){for(r>=u?l=t.data[h]>>r-u&c:(l=(t.data[h]&(1<<r+1)-1)<<u-r,h>0&&(l|=t.data[h-1]>>this.DB+r-u)),o=n;(l&1)==0;)l>>=1,--o;if((r-=o)<0&&(r+=this.DB,--h),d)s[l].copyTo(i),d=!1;else{for(;o>1;)a.sqrTo(i,p),a.sqrTo(p,i),o-=2;o>0?a.sqrTo(i,p):(g=i,i=p,p=g),a.mulTo(p,s[l],i)}for(;h>=0&&(t.data[h]&1<<r)==0;)a.sqrTo(i,p),g=i,i=p,p=g,--r<0&&(r=this.DB-1,--h)}return a.revert(i)}function Ol(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return e;for(i<a&&(a=i),a>0&&(e.rShiftTo(a,e),r.rShiftTo(a,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r}function Fl(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function Ml(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return S.ZERO;for(var r=t.clone(),n=this.clone(),i=Ce(1),a=Ce(0),s=Ce(0),o=Ce(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!a.isEven())&&(i.addTo(this,i),a.subTo(t,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!o.isEven())&&(s.addTo(this,s),o.subTo(t,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(s,i),a.subTo(o,a)):(n.subTo(r,n),e&&s.subTo(i,s),o.subTo(a,o))}if(n.compareTo(S.ONE)!=0)return S.ZERO;if(o.compareTo(t)>=0)return o.subtract(t);if(o.signum()<0)o.addTo(t,o);else return o;return o.signum()<0?o.add(t):o}var Gt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Vl=(1<<26)/Gt[Gt.length-1];function zl(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Gt[Gt.length-1]){for(e=0;e<Gt.length;++e)if(r.data[0]==Gt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Gt.length;){for(var n=Gt[e],i=e+1;i<Gt.length&&n<Vl;)n*=Gt[i++];for(n=r.modInt(n);e<i;)if(n%Gt[e++]==0)return!1}return r.millerRabin(t)}function Hl(t){var e=this.subtract(S.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=Gl(),a,s=0;s<t;++s){do a=new S(this.bitLength(),i);while(a.compareTo(S.ONE)<=0||a.compareTo(e)>=0);var o=a.modPow(n,this);if(o.compareTo(S.ONE)!=0&&o.compareTo(e)!=0){for(var u=1;u++<r&&o.compareTo(e)!=0;)if(o=o.modPowInt(2,this),o.compareTo(S.ONE)==0)return!1;if(o.compareTo(e)!=0)return!1}}return!0}function Gl(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}S.prototype.chunkSize=Wh;S.prototype.toRadix=jh;S.prototype.fromRadix=$h;S.prototype.fromNumber=Zh;S.prototype.bitwiseTo=el;S.prototype.changeBit=yl;S.prototype.addTo=ml;S.prototype.dMultiply=Cl;S.prototype.dAddOffset=Tl;S.prototype.multiplyLowerTo=Dl;S.prototype.multiplyUpperTo=kl;S.prototype.modInt=Fl;S.prototype.millerRabin=Hl;S.prototype.clone=Vh;S.prototype.intValue=zh;S.prototype.byteValue=Hh;S.prototype.shortValue=Gh;S.prototype.signum=Yh;S.prototype.toByteArray=Qh;S.prototype.equals=Xh;S.prototype.min=Jh;S.prototype.max=tl;S.prototype.and=nl;S.prototype.or=il;S.prototype.xor=al;S.prototype.andNot=sl;S.prototype.not=ol;S.prototype.shiftLeft=cl;S.prototype.shiftRight=ul;S.prototype.getLowestSetBit=hl;S.prototype.bitCount=pl;S.prototype.testBit=dl;S.prototype.setBit=gl;S.prototype.clearBit=xl;S.prototype.flipBit=vl;S.prototype.add=bl;S.prototype.subtract=wl;S.prototype.multiply=Sl;S.prototype.divide=El;S.prototype.remainder=Bl;S.prototype.divideAndRemainder=Al;S.prototype.modPow=ql;S.prototype.modInverse=Ml;S.prototype.pow=Rl;S.prototype.gcd=Ol;S.prototype.isProbablePrime=zl});var lo=C((P1,ho)=>{var te=Z();Fe();ut();var co=ho.exports=te.sha1=te.sha1||{};te.md.sha1=te.md.algorithms.sha1=co;co.create=function(){uo||Wl();var t=null,e=te.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=te.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=te.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),fo(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=te.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(Gi.substr(0,n.blockLength-s));for(var o,u,c=n.fullMessageLength[0]*8,f=0;f<n.fullMessageLength.length-1;++f)o=n.fullMessageLength[f+1]*8,u=o/4294967296>>>0,c+=u,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};fo(h,r,i);var l=te.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Gi=null,uo=!1;function Wl(){Gi=String.fromCharCode(128),Gi+=te.util.fillString(String.fromCharCode(0),64),uo=!0}function fo(t,e,r){for(var n,i,a,s,o,u,c,f,h=r.length();h>=64;){for(i=t.h0,a=t.h1,s=t.h2,o=t.h3,u=t.h4,f=0;f<16;++f)n=r.getInt32(),e[f]=n,c=o^a&(s^o),n=(i<<5|i>>>27)+c+u+1518500249+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;f<20;++f)n=e[f-3]^e[f-8]^e[f-14]^e[f-16],n=n<<1|n>>>31,e[f]=n,c=o^a&(s^o),n=(i<<5|i>>>27)+c+u+1518500249+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;f<32;++f)n=e[f-3]^e[f-8]^e[f-14]^e[f-16],n=n<<1|n>>>31,e[f]=n,c=a^s^o,n=(i<<5|i>>>27)+c+u+1859775393+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;f<40;++f)n=e[f-6]^e[f-16]^e[f-28]^e[f-32],n=n<<2|n>>>30,e[f]=n,c=a^s^o,n=(i<<5|i>>>27)+c+u+1859775393+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;f<60;++f)n=e[f-6]^e[f-16]^e[f-28]^e[f-32],n=n<<2|n>>>30,e[f]=n,c=a&s|o&(a^s),n=(i<<5|i>>>27)+c+u+2400959708+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;f<80;++f)n=e[f-6]^e[f-16]^e[f-28]^e[f-32],n=n<<2|n>>>30,e[f]=n,c=a^s^o,n=(i<<5|i>>>27)+c+u+3395469782+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+a|0,t.h2=t.h2+s|0,t.h3=t.h3+o|0,t.h4=t.h4+u|0,h-=64}}});var go=C((L1,yo)=>{var ee=Z();ut();Rr();lo();var po=yo.exports=ee.pkcs1=ee.pkcs1||{};po.encode_rsa_oaep=function(t,e,r){var n,i,a,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,a=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),a?a.start():a=ee.md.sha1.create(),s||(s=a);var o=Math.ceil(t.n.bitLength()/8),u=o-2*a.digestLength-2;if(e.length>u){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=e.length,c.maxLength=u,c}n||(n=""),a.update(n,"raw");for(var f=a.digest(),h="",l=u-e.length,d=0;d<l;d++)h+="\0";var p=f.getBytes()+h+""+e;if(!i)i=ee.random.getBytes(a.digestLength);else if(i.length!==a.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=a.digestLength,c}var g=Rn(i,o-a.digestLength-1,s),v=ee.util.xorBytes(p,g,p.length),m=Rn(v,a.digestLength,s),E=ee.util.xorBytes(i,m,i.length);return"\0"+E+v};po.decode_rsa_oaep=function(t,e,r){var n,i,a;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=e.length,v.expectedLength=s,v}if(i===void 0?i=ee.md.sha1.create():i.start(),a||(a=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var o=i.digest().getBytes(),u=e.charAt(0),c=e.substring(1,i.digestLength+1),f=e.substring(1+i.digestLength),h=Rn(f,i.digestLength,a),l=ee.util.xorBytes(c,h,c.length),d=Rn(l,s-i.digestLength-1,a),p=ee.util.xorBytes(f,d,f.length),g=p.substring(0,i.digestLength),v=u!=="\0",m=0;m<i.digestLength;++m)v|=o.charAt(m)!==g.charAt(m);for(var E=1,A=i.digestLength,N=i.digestLength;N<p.length;N++){var I=p.charCodeAt(N),_=I&1^1,q=E?65534:0;v|=I&q,E=E&_,A+=E}if(v||p.charCodeAt(A)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(A+1)};function Rn(t,e,r){r||(r=ee.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),a=0;a<i;++a){var s=String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255);r.start(),r.update(t+s),n+=r.digest().getBytes()}return n.substring(0,e)}});var xo=C((K1,Wi)=>{var Te=Z();ut();_n();Rr();(function(){if(Te.prime){Wi.exports=Te.prime;return}var t=Wi.exports=Te.prime=Te.prime||{},e=Te.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var g=l.prng||Te.random,v={nextBytes:function(m){for(var E=g.getBytesSync(m.length),A=0;A<m.length;++A)m[A]=E.charCodeAt(A)}};if(p.name==="PRIMEINC")return a(h,v,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function a(h,l,d,p){return"workers"in d?u(h,l,d,p):s(h,l,d,p)}function s(h,l,d,p){var g=c(h,l),v=0,m=f(g.bitLength());"millerRabinTests"in d&&(m=d.millerRabinTests);var E=10;"maxBlockTime"in d&&(E=d.maxBlockTime),o(g,h,l,v,m,E,p)}function o(h,l,d,p,g,v,m){var E=+new Date;do{if(h.bitLength()>l&&(h=c(l,d)),h.isProbablePrime(g))return m(null,h);h.dAddOffset(r[p++%8],0)}while(v<0||+new Date-E<v);Te.util.setImmediate(function(){o(h,l,d,p,g,v,m)})}function u(h,l,d,p){if(typeof Worker=="undefined")return s(h,l,d,p);var g=c(h,l),v=d.workers,m=d.workLoad||100,E=m*30/8,A=d.workerScript||"forge/prime.worker.js";if(v===-1)return Te.util.estimateCores(function(I,_){I&&(_=2),v=_-1,N()});N();function N(){v=Math.max(1,v);for(var I=[],_=0;_<v;++_)I[_]=new Worker(A);for(var q=v,_=0;_<v;++_)I[_].addEventListener("message",dt);var z=!1;function dt(It){if(!z){--q;var bt=It.data;if(bt.found){for(var Bt=0;Bt<I.length;++Bt)I[Bt].terminate();return z=!0,p(null,new e(bt.prime,16))}g.bitLength()>h&&(g=c(h,l));var Qe=g.toString(16);It.target.postMessage({hex:Qe,workLoad:m}),g.dAddOffset(E,0)}}}}function c(h,l){var d=new e(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(e.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function f(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var kn=C((U1,Bo)=>{var L=Z();_r();_n();bn();go();xo();Rr();ut();typeof M=="undefined"&&(M=L.jsbn.BigInteger);var M,Yi=L.util.isNodejs?sr():null,x=L.asn1,qt=L.util;L.pki=L.pki||{};Bo.exports=L.pki.rsa=L.rsa=L.rsa||{};var K=L.pki,Yl=[6,4,2,4,2,4,6,2],jl={name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},$l={name:"RSAPrivateKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Zl={name:"RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Ql=L.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Xl=function(t){var e;if(t.algorithm in K.oids)e=K.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=x.oidToDer(e).getBytes(),i=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]),a=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]);a.value.push(x.create(x.Class.UNIVERSAL,x.Type.OID,!1,n)),a.value.push(x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,""));var s=x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(a),i.value.push(s),x.toDer(i).getBytes()},vo=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(M.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(M.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new M(L.util.bytesToHex(L.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(M.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),a=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(a)<0;)i=i.add(e.p);var s=i.subtract(a).multiply(e.qInv).mod(e.p).multiply(e.q).add(a);return s=s.multiply(n.modInverse(e.n)).mod(e.n),s};K.rsa.encrypt=function(t,e,r){var n=r,i,a=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=mo(t,e,r)):(i=L.util.createBuffer(),i.putBytes(t));for(var s=new M(i.toHex(),16),o=vo(s,e,n),u=o.toString(16),c=L.util.createBuffer(),f=a-Math.ceil(u.length/2);f>0;)c.putByte(0),--f;return c.putBytes(L.util.hexToBytes(u)),c.getBytes()};K.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var a=new Error("Encrypted message length is invalid.");throw a.length=t.length,a.expected=i,a}var s=new M(L.util.createBuffer(t).toHex(),16);if(s.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=vo(s,e,r),u=o.toString(16),c=L.util.createBuffer(),f=i-Math.ceil(u.length/2);f>0;)c.putByte(0),--f;return c.putBytes(L.util.hexToBytes(u)),n!==!1?Dn(c.getBytes(),e,r):c.getBytes()};K.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||L.random,i={nextBytes:function(o){for(var u=n.getBytesSync(o.length),c=0;c<o.length;++c)o[c]=u.charCodeAt(c)}},a=r.algorithm||"PRIMEINC",s;if(a==="PRIMEINC")s={algorithm:a,state:0,bits:t,rng:i,eInt:e||65537,e:new M(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+a);return s};K.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new M(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},a=+new Date,s,o=0;t.keys===null&&(e<=0||o<e);){if(t.state===0){var u=t.p===null?t.pBits:t.qBits,c=u-1;t.pqState===0?(t.num=new M(u,t.rng),t.num.testBit(c)||t.num.bitwiseTo(M.ONE.shiftLeft(c),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>u?t.pqState=0:t.num.isProbablePrime(tp(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Yl[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(M.ONE).gcd(t.e).compareTo(M.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(M.ONE),t.q1=t.q.subtract(M.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(M.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var f=t.e.modInverse(t.phi);t.keys={privateKey:K.rsa.setPrivateKey(t.n,t.e,f,t.p,t.q,f.mod(t.p1),f.mod(t.q1),t.q.modInverse(t.p)),publicKey:K.rsa.setPublicKey(t.n,t.e)}}s=+new Date,o+=s-a,a=s}return t.keys!==null};K.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!L.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(bo("generateKeyPair"))return Yi.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,u,c){if(o)return n(o);n(null,{privateKey:K.privateKeyFromPem(c),publicKey:K.publicKeyFromPem(u)})});if(wo("generateKey")&&wo("exportKey"))return qt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Eo(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return qt.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var u=K.privateKeyFromAsn1(x.fromDer(L.util.createBuffer(o)));n(null,{privateKey:u,publicKey:K.setRsaPublicKey(u.n,u.e)})}});if(So("generateKey")&&So("exportKey")){var i=qt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Eo(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var u=o.target.result,c=qt.globalScope.msCrypto.subtle.exportKey("pkcs8",u.privateKey);c.oncomplete=function(f){var h=f.target.result,l=K.privateKeyFromAsn1(x.fromDer(L.util.createBuffer(h)));n(null,{privateKey:l,publicKey:K.setRsaPublicKey(l.n,l.e)})},c.onerror=function(f){n(f)}},i.onerror=function(o){n(o)};return}}else if(bo("generateKeyPairSync")){var a=Yi.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:K.privateKeyFromPem(a.privateKey),publicKey:K.publicKeyFromPem(a.publicKey)}}}var s=K.rsa.createKeyPairGenerationState(t,e,r);if(!n)return K.rsa.stepKeyPairGenerationState(s,0),s.keys;Jl(s,r,n)};K.setRsaPublicKey=K.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,a){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,u,c){return mo(o,u,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,u){return L.pkcs1.encode_rsa_oaep(u,o,a)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return K.rsa.encrypt(s,r,!0)},r.verify=function(n,i,a){typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSASSA-PKCS1-V1_5"),a==="RSASSA-PKCS1-V1_5"?a={verify:function(o,u){u=Dn(u,r,!0);var c=x.fromDer(u);return o===c.value[1].value}}:(a==="NONE"||a==="NULL"||a===null)&&(a={verify:function(o,u){return u=Dn(u,r,!0),o===u}});var s=K.rsa.decrypt(i,r,!0,!1);return a.verify(n,s,r.n.bitLength())},r};K.setRsaPrivateKey=K.rsa.setPrivateKey=function(t,e,r,n,i,a,s,o){var u={n:t,e,d:r,p:n,q:i,dP:a,dQ:s,qInv:o};return u.decrypt=function(c,f,h){typeof f=="string"?f=f.toUpperCase():f===void 0&&(f="RSAES-PKCS1-V1_5");var l=K.rsa.decrypt(c,u,!1,!1);if(f==="RSAES-PKCS1-V1_5")f={decode:Dn};else if(f==="RSA-OAEP"||f==="RSAES-OAEP")f={decode:function(d,p){return L.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(f)!==-1)f={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+f+'".');return f.decode(l,u,!1)},u.sign=function(c,f){var h=!1;typeof f=="string"&&(f=f.toUpperCase()),f===void 0||f==="RSASSA-PKCS1-V1_5"?(f={encode:Xl},h=1):(f==="NONE"||f==="NULL"||f===null)&&(f={encode:function(){return c}},h=1);var l=f.encode(c,u.n.bitLength());return K.rsa.encrypt(l,u,h)},u};K.wrapRsaPrivateKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(K.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,x.toDer(t).getBytes())])};K.privateKeyFromAsn1=function(t){var e={},r=[];if(x.validate(t,jl,e,r)&&(t=x.fromDer(L.util.createBuffer(e.privateKey))),e={},r=[],!x.validate(t,$l,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,a,s,o,u,c,f,h;return i=L.util.createBuffer(e.privateKeyModulus).toHex(),a=L.util.createBuffer(e.privateKeyPublicExponent).toHex(),s=L.util.createBuffer(e.privateKeyPrivateExponent).toHex(),o=L.util.createBuffer(e.privateKeyPrime1).toHex(),u=L.util.createBuffer(e.privateKeyPrime2).toHex(),c=L.util.createBuffer(e.privateKeyExponent1).toHex(),f=L.util.createBuffer(e.privateKeyExponent2).toHex(),h=L.util.createBuffer(e.privateKeyCoefficient).toHex(),K.setRsaPrivateKey(new M(i,16),new M(a,16),new M(s,16),new M(o,16),new M(u,16),new M(c,16),new M(f,16),new M(h,16))};K.privateKeyToAsn1=K.privateKeyToRSAPrivateKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.e)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.d)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.p)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.q)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.dP)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.dQ)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.qInv))])};K.publicKeyFromAsn1=function(t){var e={},r=[];if(x.validate(t,Ql,e,r)){var n=x.derToOid(e.publicKeyOid);if(n!==K.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!x.validate(t,Zl,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var a=L.util.createBuffer(e.publicKeyModulus).toHex(),s=L.util.createBuffer(e.publicKeyExponent).toHex();return K.setRsaPublicKey(new M(a,16),new M(s,16))};K.publicKeyToAsn1=K.publicKeyToSubjectPublicKeyInfo=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(K.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.BITSTRING,!1,[K.publicKeyToRSAPublicKey(t)])])};K.publicKeyToRSAPublicKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.e))])};function mo(t,e,r){var n=L.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var a=new Error("Message is too long for PKCS#1 v1.5 padding.");throw a.length=t.length,a.max=i-11,a}n.putByte(0),n.putByte(r);var s=i-3-t.length,o;if(r===0||r===1){o=r===0?0:255;for(var u=0;u<s;++u)n.putByte(o)}else for(;s>0;){for(var c=0,f=L.random.getBytes(s),u=0;u<s;++u)o=f.charCodeAt(u),o===0?++c:n.putByte(o);s=c}return n.putByte(0),n.putBytes(t),n}function Dn(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),a=L.util.createBuffer(t),s=a.getByte(),o=a.getByte();if(s!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n=="undefined")throw new Error("Encryption block is invalid.");var u=0;if(o===0){u=i-3-n;for(var c=0;c<u;++c)if(a.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(u=0;a.length()>1;){if(a.getByte()!==255){--a.read;break}++u}else if(o===2)for(u=0;a.length()>1;){if(a.getByte()===0){--a.read;break}++u}var f=a.getByte();if(f!==0||u!==i-3-a.length())throw new Error("Encryption block is invalid.");return a.getBytes()}function Jl(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){a(t.pBits,function(o,u){if(o)return r(o);if(t.p=u,t.q!==null)return s(o,t.q);a(t.qBits,s)})}function a(o,u){L.prime.generateProbablePrime(o,n,u)}function s(o,u){if(o)return r(o);if(t.q=u,t.p.compareTo(t.q)<0){var c=t.p;t.p=t.q,t.q=c}if(t.p.subtract(M.ONE).gcd(t.e).compareTo(M.ONE)!==0){t.p=null,i();return}if(t.q.subtract(M.ONE).gcd(t.e).compareTo(M.ONE)!==0){t.q=null,a(t.qBits,s);return}if(t.p1=t.p.subtract(M.ONE),t.q1=t.q.subtract(M.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(M.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,a(t.qBits,s);return}var f=t.e.modInverse(t.phi);t.keys={privateKey:K.rsa.setPrivateKey(t.n,t.e,f,t.p,t.q,f.mod(t.p1),f.mod(t.q1),t.q.modInverse(t.p)),publicKey:K.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function re(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=L.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)==0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)==128)?r.substr(1):r}function tp(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function bo(t){return L.util.isNodejs&&typeof Yi[t]=="function"}function wo(t){return typeof qt.globalScope!="undefined"&&typeof qt.globalScope.crypto=="object"&&typeof qt.globalScope.crypto.subtle=="object"&&typeof qt.globalScope.crypto.subtle[t]=="function"}function So(t){return typeof qt.globalScope!="undefined"&&typeof qt.globalScope.msCrypto=="object"&&typeof qt.globalScope.msCrypto.subtle=="object"&&typeof qt.globalScope.msCrypto.subtle[t]=="function"}function Eo(t){for(var e=L.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var Ro=C((q1,_o)=>{var R=Z();rn();_r();P0();Fe();bn();qi();M0();Rr();J0();kn();ut();typeof Ao=="undefined"&&(Ao=R.jsbn.BigInteger);var Ao,b=R.asn1,U=R.pki=R.pki||{};_o.exports=U.pbe=R.pbe=R.pbe||{};var ze=U.oids,ep={name:"EncryptedPrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},rp={name:"PBES2Algorithms",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},np={name:"pkcs-12PbeParams",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"iterations"}]};U.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=R.random.getBytesSync(r.saltSize),i=r.count,a=b.integerToDer(i),s,o,u;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,f,h;switch(r.algorithm){case"aes128":s=16,c=16,f=ze["aes128-CBC"],h=R.aes.createEncryptionCipher;break;case"aes192":s=24,c=16,f=ze["aes192-CBC"],h=R.aes.createEncryptionCipher;break;case"aes256":s=32,c=16,f=ze["aes256-CBC"],h=R.aes.createEncryptionCipher;break;case"des":s=8,c=8,f=ze.desCBC,h=R.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=Io(d),g=R.pkcs5.pbkdf2(e,n,i,s,p),v=R.random.getBytesSync(c),m=h(g);m.start(v),m.update(b.toDer(t)),m.finish(),u=m.output.getBytes();var E=ip(n,a,s,d);o=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(ze.pkcs5PBES2).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(ze.pkcs5PBKDF2).getBytes()),E]),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(f).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,v)])])])}else if(r.algorithm==="3des"){s=24;var A=new R.util.ByteBuffer(n),g=U.pbe.generatePkcs12Key(e,A,1,i,s),v=U.pbe.generatePkcs12Key(e,A,2,i,s),m=R.des.createEncryptionCipher(g);m.start(v),m.update(b.toDer(t)),m.finish(),u=m.output.getBytes(),o=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(ze["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,n),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,a.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var N=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[o,b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,u)]);return N};U.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!b.validate(t,ep,n,i)){var a=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=b.derToOid(n.encryptionOid),o=U.pbe.getCipher(s,n.encryptionParams,e),u=R.util.createBuffer(n.encryptedData);return o.update(u),o.finish()&&(r=b.fromDer(o.output)),r};U.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:b.toDer(t).getBytes()};return R.pem.encode(r,{maxline:e})};U.encryptedPrivateKeyFromPem=function(t){var e=R.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return b.fromDer(e.body)};U.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=U.wrapRsaPrivateKey(U.privateKeyToAsn1(t));return n=U.encryptPrivateKeyInfo(n,e,r),U.encryptedPrivateKeyToPem(n)}var i,a,s,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,a=R.random.getBytesSync(16),o=R.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,a=R.random.getBytesSync(16),o=R.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,a=R.random.getBytesSync(16),o=R.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,a=R.random.getBytesSync(8),o=R.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,a=R.random.getBytesSync(8),o=R.des.createEncryptionCipher;break;default:var u=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw u.algorithm=r.algorithm,u}var c=R.pbe.opensslDeriveBytes(e,a.substr(0,8),s),f=o(c);f.start(a),f.update(b.toDer(U.privateKeyToAsn1(t))),f.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:R.util.bytesToHex(a).toUpperCase()},body:f.output.getBytes()};return R.pem.encode(h)};U.decryptRsaPrivateKey=function(t,e){var r=null,n=R.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var a,s;switch(n.dekInfo.algorithm){case"DES-CBC":a=8,s=R.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,s=R.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,s=R.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,s=R.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,s=R.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,s=function(h){return R.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":a=8,s=function(h){return R.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":a=16,s=function(h){return R.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=R.util.hexToBytes(n.dekInfo.parameters),u=R.pbe.opensslDeriveBytes(e,o.substr(0,8),a),c=s(u);if(c.start(o),c.update(R.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=U.decryptPrivateKeyInfo(b.fromDer(r),e):r=b.fromDer(r),r!==null&&(r=U.privateKeyFromAsn1(r)),r};U.pbe.generatePkcs12Key=function(t,e,r,n,i,a){var s,o;if(typeof a=="undefined"||a===null){if(!("sha1"in R.md))throw new Error('"sha1" hash algorithm unavailable.');a=R.md.sha1.create()}var u=a.digestLength,c=a.blockLength,f=new R.util.ByteBuffer,h=new R.util.ByteBuffer;if(t!=null){for(o=0;o<t.length;o++)h.putInt16(t.charCodeAt(o));h.putInt16(0)}var l=h.length(),d=e.length(),p=new R.util.ByteBuffer;p.fillWithByte(r,c);var g=c*Math.ceil(d/c),v=new R.util.ByteBuffer;for(o=0;o<g;o++)v.putByte(e.at(o%d));var m=c*Math.ceil(l/c),E=new R.util.ByteBuffer;for(o=0;o<m;o++)E.putByte(h.at(o%l));var A=v;A.putBuffer(E);for(var N=Math.ceil(i/u),I=1;I<=N;I++){var _=new R.util.ByteBuffer;_.putBytes(p.bytes()),_.putBytes(A.bytes());for(var q=0;q<n;q++)a.start(),a.update(_.getBytes()),_=a.digest();var z=new R.util.ByteBuffer;for(o=0;o<c;o++)z.putByte(_.at(o%u));var dt=Math.ceil(d/c)+Math.ceil(l/c),It=new R.util.ByteBuffer;for(s=0;s<dt;s++){var bt=new R.util.ByteBuffer(A.getBytes(c)),Bt=511;for(o=z.length()-1;o>=0;o--)Bt=Bt>>8,Bt+=z.at(o)+bt.at(o),bt.setAt(o,Bt&255);It.putBuffer(bt)}A=It,f.putBuffer(_)}return f.truncate(f.length()-i),f};U.pbe.getCipher=function(t,e,r){switch(t){case U.oids.pkcs5PBES2:return U.pbe.getCipherForPBES2(t,e,r);case U.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case U.oids["pbewithSHAAnd40BitRC2-CBC"]:return U.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};U.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!b.validate(e,rp,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}if(t=b.derToOid(n.kdfOid),t!==U.oids.pkcs5PBKDF2){var a=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw a.oid=t,a.supportedOids=["pkcs5PBKDF2"],a}if(t=b.derToOid(n.encOid),t!==U.oids["aes128-CBC"]&&t!==U.oids["aes192-CBC"]&&t!==U.oids["aes256-CBC"]&&t!==U.oids["des-EDE3-CBC"]&&t!==U.oids.desCBC){var a=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw a.oid=t,a.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],a}var s=n.kdfSalt,o=R.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var u,c;switch(U.oids[t]){case"aes128-CBC":u=16,c=R.aes.createDecryptionCipher;break;case"aes192-CBC":u=24,c=R.aes.createDecryptionCipher;break;case"aes256-CBC":u=32,c=R.aes.createDecryptionCipher;break;case"des-EDE3-CBC":u=24,c=R.des.createDecryptionCipher;break;case"desCBC":u=8,c=R.des.createDecryptionCipher;break}var f=To(n.prfOid),h=R.pkcs5.pbkdf2(r,s,o,u,f),l=n.encIv,d=c(h);return d.start(l),d};U.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!b.validate(e,np,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=R.util.createBuffer(n.salt),o=R.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var u,c,f;switch(t){case U.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:u=24,c=8,f=R.des.startDecrypting;break;case U.oids["pbewithSHAAnd40BitRC2-CBC"]:u=5,c=8,f=function(g,v){var m=R.rc2.createDecryptionCipher(g,40);return m.start(v,null),m};break;default:var a=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw a.oid=t,a}var h=To(n.prfOid),l=U.pbe.generatePkcs12Key(r,s,1,o,u,h);h.start();var d=U.pbe.generatePkcs12Key(r,s,2,o,c,h);return f(l,d)};U.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n=="undefined"||n===null){if(!("md5"in R.md))throw new Error('"md5" hash algorithm unavailable.');n=R.md.md5.create()}e===null&&(e="");for(var i=[Co(n,t+e)],a=16,s=1;a<r;++s,a+=16)i.push(Co(n,i[s-1]+t+e));return i.join("").substr(0,r)};function Co(t,e){return t.start().update(e).digest().getBytes()}function To(t){var e;if(!t)e="hmacWithSHA1";else if(e=U.oids[b.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Io(e)}function Io(t){var e=R.md;switch(t){case"hmacWithSHA224":e=R.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function ip(t,e,r,n){var i=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,t),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,R.util.hexToBytes(r.toString(16))),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(U.oids[n]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")])),i}});var kr={};At(kr,{concat:()=>ap});function ap(t,e){e||(e=t.reduce((i,a)=>i+a.length,0));let r=new Uint8Array(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return r}var Nr=X(()=>{});var ji=C((O1,ko)=>{"use strict";var{concat:sp}=(Nr(),kr),{fromString:Do}=(Se(),we),op=gr();function cp({algorithm:t="AES-GCM",nonceLength:e=12,keyLength:r=16,digest:n="SHA-256",saltLength:i=16,iterations:a=32767}={}){let s=op.get();r*=8;async function o(c,f){let h=s.getRandomValues(new Uint8Array(i)),l=s.getRandomValues(new Uint8Array(e)),d={name:t,iv:l},p={name:"PBKDF2",salt:h,iterations:a,hash:{name:n}},g=await s.subtle.importKey("raw",Do(f),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),v=await s.subtle.deriveKey(p,g,{name:t,length:r},!0,["encrypt"]),m=await s.subtle.encrypt(d,v,c);return sp([h,d.iv,new Uint8Array(m)])}async function u(c,f){let h=c.slice(0,i),l=c.slice(i,i+e),d=c.slice(i+e),p={name:t,iv:l},g={name:"PBKDF2",salt:h,iterations:a,hash:{name:n}},v=await s.subtle.importKey("raw",Do(f),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),m=await s.subtle.deriveKey(g,v,{name:t,length:r},!0,["decrypt"]),E=await s.subtle.decrypt(p,m,d);return new Uint8Array(E)}return{encrypt:o,decrypt:u}}ko.exports={create:cp}});var Po=C((F1,No)=>{"use strict";var{base64:up}=(on(),vr),fp=ji();No.exports={import:async function(t,e){let r=up.decode(t);return await fp.create().decrypt(r,e)}}});var Pr={};At(Pr,{equals:()=>hp});function hp(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var Lr=X(()=>{});var Oo=C((M1,qo)=>{var rt=Z();Fe();ut();var Kr=qo.exports=rt.sha512=rt.sha512||{};rt.md.sha512=rt.md.algorithms.sha512=Kr;var Lo=rt.sha384=rt.sha512.sha384=rt.sha512.sha384||{};Lo.create=function(){return Kr.create("SHA-384")};rt.md.sha384=rt.md.algorithms.sha384=Lo;rt.sha512.sha256=rt.sha512.sha256||{create:function(){return Kr.create("SHA-512/256")}};rt.md["sha512/256"]=rt.md.algorithms["sha512/256"]=rt.sha512.sha256;rt.sha512.sha224=rt.sha512.sha224||{create:function(){return Kr.create("SHA-512/224")}};rt.md["sha512/224"]=rt.md.algorithms["sha512/224"]=rt.sha512.sha224;Kr.create=function(t){if(Ko||lp(),typeof t=="undefined"&&(t="SHA-512"),!(t in He))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=He[t],r=null,n=rt.util.createBuffer(),i=new Array(80),a=0;a<80;++a)i[a]=new Array(2);var s=64;switch(t){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var o={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var u=o.messageLengthSize/4,c=0;c<u;++c)o.fullMessageLength.push(0);n=rt.util.createBuffer(),r=new Array(e.length);for(var c=0;c<e.length;++c)r[c]=e[c].slice(0);return o},o.start(),o.update=function(u,c){c==="utf8"&&(u=rt.util.encodeUtf8(u));var f=u.length;o.messageLength+=f,f=[f/4294967296>>>0,f>>>0];for(var h=o.fullMessageLength.length-1;h>=0;--h)o.fullMessageLength[h]+=f[1],f[1]=f[0]+(o.fullMessageLength[h]/4294967296>>>0),o.fullMessageLength[h]=o.fullMessageLength[h]>>>0,f[0]=f[1]/4294967296>>>0;return n.putBytes(u),Uo(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),o},o.digest=function(){var u=rt.util.createBuffer();u.putBytes(n.bytes());var c=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,f=c&o.blockLength-1;u.putBytes($i.substr(0,o.blockLength-f));for(var h,l,d=o.fullMessageLength[0]*8,p=0;p<o.fullMessageLength.length-1;++p)h=o.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,u.putInt32(d>>>0),d=h>>>0;u.putInt32(d);for(var g=new Array(r.length),p=0;p<r.length;++p)g[p]=r[p].slice(0);Uo(g,i,u);var v=rt.util.createBuffer(),m;t==="SHA-512"?m=g.length:t==="SHA-384"?m=g.length-2:m=g.length-4;for(var p=0;p<m;++p)v.putInt32(g[p][0]),(p!==m-1||t!=="SHA-512/224")&&v.putInt32(g[p][1]);return v},o};var $i=null,Ko=!1,Zi=null,He=null;function lp(){$i=String.fromCharCode(128),$i+=rt.util.fillString(String.fromCharCode(0),128),Zi=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],He={},He["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],He["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],He["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],He["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Ko=!0}function Uo(t,e,r){for(var n,i,a,s,o,u,c,f,h,l,d,p,g,v,m,E,A,N,I,_,q,z,dt,It,bt,Bt,Qe,Qr,pt,_t,P,Yn,jn,$n,Zn,da=r.length();da>=128;){for(pt=0;pt<16;++pt)e[pt][0]=r.getInt32()>>>0,e[pt][1]=r.getInt32()>>>0;for(;pt<80;++pt)Yn=e[pt-2],_t=Yn[0],P=Yn[1],n=((_t>>>19|P<<13)^(P>>>29|_t<<3)^_t>>>6)>>>0,i=((_t<<13|P>>>19)^(P<<3|_t>>>29)^(_t<<26|P>>>6))>>>0,$n=e[pt-15],_t=$n[0],P=$n[1],a=((_t>>>1|P<<31)^(_t>>>8|P<<24)^_t>>>7)>>>0,s=((_t<<31|P>>>1)^(_t<<24|P>>>8)^(_t<<25|P>>>7))>>>0,jn=e[pt-7],Zn=e[pt-16],P=i+jn[1]+s+Zn[1],e[pt][0]=n+jn[0]+a+Zn[0]+(P/4294967296>>>0)>>>0,e[pt][1]=P>>>0;for(g=t[0][0],v=t[0][1],m=t[1][0],E=t[1][1],A=t[2][0],N=t[2][1],I=t[3][0],_=t[3][1],q=t[4][0],z=t[4][1],dt=t[5][0],It=t[5][1],bt=t[6][0],Bt=t[6][1],Qe=t[7][0],Qr=t[7][1],pt=0;pt<80;++pt)c=((q>>>14|z<<18)^(q>>>18|z<<14)^(z>>>9|q<<23))>>>0,f=((q<<18|z>>>14)^(q<<14|z>>>18)^(z<<23|q>>>9))>>>0,h=(bt^q&(dt^bt))>>>0,l=(Bt^z&(It^Bt))>>>0,o=((g>>>28|v<<4)^(v>>>2|g<<30)^(v>>>7|g<<25))>>>0,u=((g<<4|v>>>28)^(v<<30|g>>>2)^(v<<25|g>>>7))>>>0,d=(g&m|A&(g^m))>>>0,p=(v&E|N&(v^E))>>>0,P=Qr+f+l+Zi[pt][1]+e[pt][1],n=Qe+c+h+Zi[pt][0]+e[pt][0]+(P/4294967296>>>0)>>>0,i=P>>>0,P=u+p,a=o+d+(P/4294967296>>>0)>>>0,s=P>>>0,Qe=bt,Qr=Bt,bt=dt,Bt=It,dt=q,It=z,P=_+i,q=I+n+(P/4294967296>>>0)>>>0,z=P>>>0,I=A,_=N,A=m,N=E,m=g,E=v,P=i+s,g=n+a+(P/4294967296>>>0)>>>0,v=P>>>0;P=t[0][1]+v,t[0][0]=t[0][0]+g+(P/4294967296>>>0)>>>0,t[0][1]=P>>>0,P=t[1][1]+E,t[1][0]=t[1][0]+m+(P/4294967296>>>0)>>>0,t[1][1]=P>>>0,P=t[2][1]+N,t[2][0]=t[2][0]+A+(P/4294967296>>>0)>>>0,t[2][1]=P>>>0,P=t[3][1]+_,t[3][0]=t[3][0]+I+(P/4294967296>>>0)>>>0,t[3][1]=P>>>0,P=t[4][1]+z,t[4][0]=t[4][0]+q+(P/4294967296>>>0)>>>0,t[4][1]=P>>>0,P=t[5][1]+It,t[5][0]=t[5][0]+dt+(P/4294967296>>>0)>>>0,t[5][1]=P>>>0,P=t[6][1]+Bt,t[6][0]=t[6][0]+bt+(P/4294967296>>>0)>>>0,t[6][1]=P>>>0,P=t[7][1]+Qr,t[7][0]=t[7][0]+Qe+(P/4294967296>>>0)>>>0,t[7][1]=P>>>0,da-=128}}});var Mo=C((V1,Fo)=>{"use strict";var Nn=65536;function pp(t){let e=new Uint8Array(t),r=0;if(t>0)if(t>Nn)for(;r<t;)r+Nn>t?(crypto.getRandomValues(e.subarray(r,r+(t-r))),r+=t-r):(crypto.getRandomValues(e.subarray(r,r+Nn)),r+=Nn);else crypto.getRandomValues(e);return e}Fo.exports=pp});var Pn=C((z1,Vo)=>{"use strict";var dp=Mo(),yp=Pt();Vo.exports=function(t){if(isNaN(t)||t<=0)throw yp(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return dp(t)}});var Ln=C(Ur=>{"use strict";ut();_n();var gp=Z(),{fromString:xp}=(Se(),we),{toString:zo}=(be(),me),{concat:Ho}=(Nr(),kr);Ur.bigIntegerToUintBase64url=(t,e)=>{let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Ho([new Uint8Array(e-r.length),r])}return zo(r,"base64url")};Ur.base64urlToBigInteger=t=>{let e=Ur.base64urlToBuffer(t);return new gp.jsbn.BigInteger(zo(e,"base16"),16)};Ur.base64urlToBuffer=(t,e)=>{let r=xp(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Ho([new Uint8Array(e-r.length),r])}return r}});var Yo=C(qr=>{"use strict";_r();kn();var Ie=Z(),{bigIntegerToUintBase64url:ne,base64urlToBigInteger:ie}=Ln(),{fromString:Go}=(Se(),we),{toString:Wo}=(be(),me);qr.pkcs1ToJwk=function(t){let e=Ie.asn1.fromDer(Wo(t,"ascii")),r=Ie.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:ne(r.n),e:ne(r.e),d:ne(r.d),p:ne(r.p),q:ne(r.q),dp:ne(r.dP),dq:ne(r.dQ),qi:ne(r.qInv),alg:"RS256",kid:"2011-04-29"}};qr.jwkToPkcs1=function(t){let e=Ie.pki.privateKeyToAsn1({n:ie(t.n),e:ie(t.e),d:ie(t.d),p:ie(t.p),q:ie(t.q),dP:ie(t.dp),dQ:ie(t.dq),qInv:ie(t.qi)});return Go(Ie.asn1.toDer(e).getBytes(),"ascii")};qr.pkixToJwk=function(t){let e=Ie.asn1.fromDer(Wo(t,"ascii")),r=Ie.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:ne(r.n),e:ne(r.e),alg:"RS256",kid:"2011-04-29"}};qr.jwkToPkix=function(t){let e=Ie.pki.publicKeyToAsn1({n:ie(t.n),e:ie(t.e)});return Go(Ie.asn1.toDer(e).getBytes(),"ascii")}});var Qo=C((W1,Zo)=>{"use strict";kn();var jo=Z(),{base64urlToBigInteger:vp}=Ln();function $o(t,e){return e.map(r=>vp(t[r]))}function mp(t){return jo.pki.setRsaPrivateKey(...$o(t,["n","e","d","p","q","dp","dq","qi"]))}function bp(t){return jo.pki.setRsaPublicKey(...$o(t,["n","e"]))}Zo.exports={jwk2pub:bp,jwk2priv:mp}});var tc=C(le=>{"use strict";var he=gr(),wp=Pn(),{toString:Sp}=(be(),me),{fromString:Ep}=(Se(),we);le.utils=Yo();le.generateKey=async function(t){let e=await he.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Xo(e);return{privateKey:r[0],publicKey:r[1]}};le.unmarshalPrivateKey=async function(t){let r=[await he.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Bp(t)],n=await Xo({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}};le.getRandomValues=wp;le.hashAndSign=async function(t,e){let r=await he.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await he.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,n.byteOffset,n.byteLength)};le.hashAndVerify=async function(t,e,r){let n=await he.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return he.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)};function Xo(t){return Promise.all([he.get().subtle.exportKey("jwk",t.privateKey),he.get().subtle.exportKey("jwk",t.publicKey)])}function Bp(t){return he.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:Ap,jwk2priv:Cp}=Qo();function Jo(t,e,r,n){let i=e?Ap(t):Cp(t),a=Sp(Uint8Array.from(r),"ascii"),s=n(a,i);return Ep(s,"ascii")}le.encrypt=function(t,e){return Jo(t,!0,e,(r,n)=>n.encrypt(r))};le.decrypt=function(t,e){return Jo(t,!1,e,(r,n)=>n.decrypt(r))}});var Kn=C((j1,ec)=>{"use strict";var{base64:Tp}=(on(),vr),Ip=ji();ec.exports={export:async function(t,e){let n=await Ip.create().encrypt(t,e);return Tp.encode(n)}}});var sc=C(($1,ac)=>{"use strict";var{sha256:rc}=(nr(),Ke),nc=Pt(),{equals:ic}=(Lr(),Pr),{toString:_p}=(be(),me);Oo();var Un=Z(),Ot=tc(),qn=mn(),Rp=Kn(),On=class{constructor(e){this._key=e}async verify(e,r){return Ot.hashAndVerify(this._key,r,e)}marshal(){return Ot.utils.jwkToPkix(this._key)}get bytes(){return qn.PublicKey.encode({Type:qn.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return Ot.encrypt(this._key,e)}equals(e){return ic(this.bytes,e.bytes)}async hash(){let{bytes:e}=await rc.digest(this.bytes);return e}},Or=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return Ot.getRandomValues(16)}async sign(e){return Ot.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw nc(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new On(this._publicKey)}decrypt(e){return Ot.decrypt(this._key,e)}marshal(){return Ot.utils.jwkToPkcs1(this._key)}get bytes(){return qn.PrivateKey.encode({Type:qn.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return ic(this.bytes,e.bytes)}async hash(){let{bytes:e}=await rc.digest(this.bytes);return e}async id(){let e=await this.public.hash();return _p(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Un.util.ByteBuffer(this.marshal()),i=Un.asn1.fromDer(n),a=Un.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Un.pki.encryptRsaPrivateKey(a,e,s)}else{if(r==="libp2p-key")return Rp.export(this.bytes,e);throw nc(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function Dp(t){let e=Ot.utils.pkcs1ToJwk(t),r=await Ot.unmarshalPrivateKey(e);return new Or(r.privateKey,r.publicKey)}function kp(t){let e=Ot.utils.pkixToJwk(t);return new On(e)}async function Np(t){let e=await Ot.unmarshalPrivateKey(t);return new Or(e.privateKey,e.publicKey)}async function Pp(t){let e=await Ot.generateKey(t);return new Or(e.privateKey,e.publicKey)}ac.exports={RsaPublicKey:On,RsaPrivateKey:Or,unmarshalRsaPublicKey:kp,unmarshalRsaPrivateKey:Dp,generateKeyPair:Pp,fromJwk:Np}});var dc=C(Q=>{"use strict";var Lp=Q&&Q.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Q,"__esModule",{value:!0});Q.utils=Q.curve25519=Q.getSharedSecret=Q.verify=Q.sign=Q.getPublicKey=Q.Signature=Q.Point=Q.ExtendedPoint=Q.CURVE=void 0;var Kp=Lp(sr()),ht=BigInt(0),F=BigInt(1),St=BigInt(2),oc=BigInt(255),st={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:St**oc-BigInt(19),n:St**BigInt(252)+BigInt("27742317777372353535851937790883648493"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")};Q.CURVE=st;var Fr=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Z1=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),Up=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),qp=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Op=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Fp=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),J=class{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof at))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(at.ZERO)?J.ZERO:new J(e.x,e.y,F,w(e.x*e.y))}static toAffineBatch(e){let r=zp(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}static fromRistrettoHash(e){e=pe(e),We(64,e);let r=Ji(e.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=Ji(e.slice(32,64)),a=this.calcElligatorRistrettoMap(i);return n.add(a)}static calcElligatorRistrettoMap(e){let{d:r}=st,n=w(Fr*e*e),i=w((n+F)*Op),a=BigInt(-1),s=w((a-r*n)*w(n+r)),{isValid:o,value:u}=ea(i,s),c=w(u*e);_e(c)||(c=w(-c)),o||(u=c),o||(a=n);let f=w(a*(n-F)*Fp-s),h=u*u,l=w((u+u)*s),d=w(f*Up),p=w(F-h),g=w(F+h);return new J(w(l*g),w(p*d),w(d*g),w(l*p))}static fromRistrettoBytes(e){e=pe(e),We(32,e);let{a:r,d:n}=st,i="ExtendedPoint.fromRistrettoBytes: Cannot convert bytes to Ristretto Point",a=Ji(e);if(!Hp(Mr(a,32),e)||_e(a))throw new Error(i);let s=w(a*a),o=w(F+r*s),u=w(F-r*s),c=w(o*o),f=w(u*u),h=w(r*n*c-f),{isValid:l,value:d}=hc(w(h*f)),p=w(d*u),g=w(d*p*h),v=w((a+a)*p);_e(v)&&(v=w(-v));let m=w(o*g),E=w(v*m);if(!l||_e(E)||m===ht)throw new Error(i);return new J(v,m,F,E)}toRistrettoBytes(){let{x:e,y:r,z:n,t:i}=this,a=w(w(n+r)*w(n-r)),s=w(e*r),{value:o}=hc(w(a*s**St)),u=w(o*a),c=w(o*s),f=w(u*c*i),h;if(_e(i*f)){let d=w(r*Fr),p=w(e*Fr);e=d,r=p,h=w(u*qp)}else h=c;_e(e*f)&&(r=w(-r));let l=w((n-r)*h);return _e(l)&&(l=w(-l)),Mr(l,32)}equals(e){let r=this,n=e;return w(r.t*n.z)===w(n.t*r.z)}negate(){return new J(w(-this.x),this.y,this.z,w(-this.t))}double(){let e=this.x,r=this.y,n=this.z,{a:i}=st,a=w(e**St),s=w(r**St),o=w(St*n**St),u=w(i*a),c=w((e+r)**St-a-s),f=w(u+s),h=w(f-o),l=w(u-s),d=w(c*h),p=w(f*l),g=w(c*l),v=w(h*f);return new J(d,p,v,g)}add(e){let r=this.x,n=this.y,i=this.z,a=this.t,s=e.x,o=e.y,u=e.z,c=e.t,f=w((n-r)*(o+s)),h=w((n+r)*(o-s)),l=w(h-f);if(l===ht)return this.double();let d=w(i*St*c),p=w(a*St*u),g=w(p+d),v=w(h+f),m=w(p-d),E=w(g*l),A=w(v*m),N=w(g*m),I=w(l*v);return new J(E,A,I,N)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=fr(e),n=J.ZERO;if(this.equals(n)||r===F)return this;let i=n,a=this;for(;r>ht;)r&F&&(i=i.add(a)),a=a.double(),r>>=F;return i}precomputeWindow(e){let r=256/e+1,n=[],i=this,a=i;for(let s=0;s<r;s++){a=i,n.push(a);for(let o=1;o<2**(e-1);o++)a=a.add(i),n.push(a);i=a.double()}return n}wNAF(e,r){!r&&this.equals(J.BASE)&&(r=at.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Qi.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=J.normalizeZ(i),Qi.set(r,i)));let a=J.ZERO,s=J.ZERO,o=256/n+1,u=2**(n-1),c=BigInt(2**n-1),f=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*u,p=Number(e&c);if(e>>=h,p>u&&(p-=f,e+=F),p===0){let g=i[d];l%2&&(g=g.negate()),s=s.add(g)}else{let g=i[d+Math.abs(p)-1];p<0&&(g=g.negate()),a=a.add(g)}}return[a,s]}multiply(e,r){let n=fr(e);return J.normalizeZ(this.wNAF(n,r))[0]}toAffine(e=ta(this.z)){let r=w(this.x*e),n=w(this.y*e);return new at(r,n)}};Q.ExtendedPoint=J;J.BASE=new J(st.Gx,st.Gy,F,w(st.Gx*st.Gy));J.ZERO=new J(ht,F,F,ht);var Qi=new WeakMap,at=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Qi.delete(this)}static fromHex(e){let{d:r,P:n}=st,i=pe(e);We(32,i);let a=i.slice();a[31]=i[31]&~128;let s=ur(a);if(s>=n)throw new Error("Point.fromHex expects hex <= Fp");let o=w(s*s),u=w(o-F),c=w(r*o+F),{isValid:f,value:h}=ea(u,c);if(!f)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&F)===F;return(i[31]&128)!=0!==l&&(h=w(-h)),new at(h,s)}static async fromPrivateKey(e){return(await Vr(e)).point}toRawBytes(){let e=Mr(this.y,32);return e[31]|=this.x&F?128:0,e}toHex(){return Xi(this.toRawBytes())}toX25519(){let{y:e}=this;return w((F+e)*ta(F-e))}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new at(w(-this.x),this.y)}add(e){return J.fromAffine(this).add(J.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return J.fromAffine(this).multiply(e,this).toAffine()}};Q.Point=at;at.BASE=new at(st.Gx,st.Gy);at.ZERO=new at(ht,F);var Ge=class{constructor(e,r){if(this.r=e,!(e instanceof at))throw new Error("Expected Point instance");this.s=fr(r)}static fromHex(e){let r=pe(e);We(64,r);let n=at.fromHex(r.slice(0,32)),i=ur(r.slice(32,64));return new Ge(n,i)}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(Mr(this.s,32),32),e}toHex(){return Xi(this.toRawBytes())}};Q.Signature=Ge;function Mp(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let a=t[n];r.set(a,i),i+=a.length}return r}var Vp=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Xi(t){let e="";for(let r=0;r<t.length;r++)e+=Vp[t[r]];return e}function cc(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),a=Number.parseInt(i,16);if(Number.isNaN(a))throw new Error("Invalid byte sequence");e[r]=a}return e}function uc(t,e){let r=t.toString(16).padStart(e*2,"0");return cc(r)}function Mr(t,e){return uc(t,e).reverse()}function _e(t){return(w(t)&F)===F}function ur(t){if(!(t instanceof Uint8Array))throw new Error(`bytesToNumberLE: expected Uint8Array, got ${t}`);let e=ht,r=BigInt(8);for(let n=0;n<t.length;n++)e+=BigInt(t[n])<<r*BigInt(n);return e}function Ji(t){return w(ur(t)&St**oc-F)}function w(t,e=st.P){let r=t%e;return r>=ht?r:e+r}function ta(t,e=st.P){if(t===ht||e<=ht)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=w(t,e),n=e,i=ht,a=F,s=F,o=ht;for(;r!==ht;){let c=n/r,f=n%r,h=i-s*c,l=a-o*c;n=r,r=f,i=s,a=o,s=h,o=l}if(n!==F)throw new Error("invert: does not exist");return w(i,e)}function zp(t,e=st.P){let r=t.length,n=new Array(r),i=F;for(let a=0;a<r;a++)t[a]!==ht&&(n[a]=i,i=w(i*t[a],e));i=ta(i,e);for(let a=r-1;a>=0;a--){if(t[a]===ht)continue;let s=w(i*t[a],e);t[a]=w(i*n[a],e),i=s}return t}function Wt(t,e){let{P:r}=st,n=t;for(;e-- >ht;)n*=n,n%=r;return n}function fc(t){let{P:e}=st,r=BigInt(5),n=BigInt(10),i=BigInt(20),a=BigInt(40),s=BigInt(80),u=t*t%e*t%e,c=Wt(u,St)*u%e,f=Wt(c,F)*t%e,h=Wt(f,r)*f%e,l=Wt(h,n)*h%e,d=Wt(l,i)*l%e,p=Wt(d,a)*d%e,g=Wt(p,s)*p%e,v=Wt(g,s)*p%e,m=Wt(v,n)*h%e;return{pow_p_5_8:Wt(m,St)*t%e,b2:u}}function ea(t,e){let r=w(e*e*e),n=w(r*r*e),i=fc(t*n).pow_p_5_8,a=w(t*r*i),s=w(e*a*a),o=a,u=w(a*Fr),c=s===t,f=s===w(-t),h=s===w(-t*Fr);return c&&(a=o),(f||h)&&(a=u),_e(a)&&(a=w(-a)),{isValid:c||f,value:a}}function hc(t){return ea(F,t)}async function ra(...t){let e=Mp(...t),r=await Q.utils.sha512(e),n=ur(r);return w(n,st.n)}function Hp(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function pe(t){return t instanceof Uint8Array?Uint8Array.from(t):cc(t)}function We(t,e){if(e.length!==t)throw new Error(`Expected ${t} bytes`)}function fr(t,e=st.n){if(typeof t=="number"&&t>0&&Number.isSafeInteger(t))return BigInt(t);if(typeof t=="bigint"&&ht<t&&t<e)return t;throw new TypeError("Expected valid scalar: 0 < scalar < max")}function Gp(t){let e=typeof t=="bigint"||typeof t=="number"?uc(fr(t,St**BigInt(256)),32):pe(t);return We(32,e),e}function lc(t){return t=pe(t),We(32,t),t[0]&=248,t[31]&=127,t[31]|=64,ur(t)}async function Vr(t){let e=await Q.utils.sha512(Gp(t)),r=e.slice(0,32),n=e.slice(32,64),i=w(lc(r),st.n),a=at.BASE.multiply(i),s=a.toRawBytes();return{head:r,prefix:n,scalar:i,point:a,pubBytes:s}}async function Wp(t){return(await Vr(t)).pubBytes}Q.getPublicKey=Wp;async function Yp(t,e){let r=pe(t),{prefix:n,scalar:i,pubBytes:a}=await Vr(e),s=await ra(n,r),o=at.BASE.multiply(s),u=await ra(o.toRawBytes(),a,r),c=w(s+u*i,st.n);return new Ge(o,c).toRawBytes()}Q.sign=Yp;async function jp(t,e,r){e=pe(e),r instanceof at||(r=at.fromHex(r)),t instanceof Ge||(t=Ge.fromHex(t));let n=J.BASE.multiply(t.s),i=await ra(t.r.toRawBytes(),r.toRawBytes(),e),a=J.fromAffine(r).multiplyUnsafe(i);return J.fromAffine(t.r).add(a).subtract(n).multiplyUnsafe(st.h).equals(J.ZERO)}Q.verify=jp;async function $p(t,e){let{scalar:r}=await Vr(t),n=at.fromHex(e).toX25519();return pc(r,n)}Q.getSharedSecret=$p;at.BASE._setWindowSize(8);function Fn(t,e,r){let n=w(t*(e-r));return e=w(e-n),r=w(r+n),[e,r]}function Zp(t,e){let{P:r,n}=st,i=fr(t,r),a=fr(e,r),s=BigInt(121665),o=i,u=F,c=ht,f=i,h=F,l=ht,d;for(let m=BigInt(255-1);m>=ht;m--){let E=a>>m&F;l^=E,d=Fn(l,u,f),u=d[0],f=d[1],d=Fn(l,c,h),c=d[0],h=d[1],l=E;let A=w(u+c),N=w(A*A),I=w(u-c),_=w(I*I),q=w(N-_),z=w(f+h),dt=w(f-h),It=w(dt*A),bt=w(z*I);f=w(w(It+bt)**St),h=w(o*w(It-bt)**St),u=w(N*_),c=w(q*(N+w(s*q)))}d=Fn(l,u,f),u=d[0],f=d[1],d=Fn(l,c,h),c=d[0],h=d[1];let{pow_p_5_8:p,b2:g}=fc(c),v=w(Wt(p,BigInt(3))*g);return w(u*v)}function Qp(t){return Mr(w(t,st.P),32)}function pc(t,e){let r=Zp(t,e);if(r===ht)throw new Error("Invalid private or public key received");return Qp(r)}function Xp(t){let e=pe(t);return We(32,e),e[31]&=127,ur(e)}Q.curve25519={BASE_POINT_U:"0900000000000000000000000000000000000000000000000000000000000000",scalarMult(t,e){let r=Xp(e),n=lc(t);return pc(r,n)},scalarMultBase(t){return Q.curve25519.scalarMult(t,Q.curve25519.BASE_POINT_U)}};var Re={node:Kp.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};Q.utils={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],bytesToHex:Xi,getExtendedPublicKey:Vr,randomBytes:(t=32)=>{if(Re.web)return Re.web.getRandomValues(new Uint8Array(t));if(Re.node){let{randomBytes:e}=Re.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Q.utils.randomBytes(32),sha512:async t=>{if(Re.web){let e=await Re.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}else{if(Re.node)return Uint8Array.from(Re.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=at.BASE){let r=e.equals(at.BASE)?e:new at(e.x,e.y);return r._setWindowSize(t),r.multiply(F),r}}});var gc=C(De=>{"use strict";var zr=dc(),Jp=32,td=64,Mn=32;De.publicKeyLength=Jp;De.privateKeyLength=td;De.generateKey=async function(){let t=zr.utils.randomPrivateKey(),e=await zr.getPublicKey(t);return{privateKey:yc(t,e),publicKey:e}};De.generateKeyFromSeed=async function(t){if(t.length!==Mn)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await zr.getPublicKey(e);return{privateKey:yc(e,r),publicKey:r}};De.hashAndSign=function(t,e){let r=t.slice(0,Mn);return zr.sign(e,r)};De.hashAndVerify=function(t,e,r){return zr.verify(e,r,t)};function yc(t,e){let r=new Uint8Array(De.privateKeyLength);for(let n=0;n<Mn;n++)r[n]=t[n],r[Mn+n]=e[n];return r}});var wc=C((J1,bc)=>{"use strict";var xc=Pt(),{equals:vc}=(Lr(),Pr),{sha256:mc}=(nr(),Ke),{base58btc:ed}=(sn(),an),{identity:rd}=(bi(),un),Et=gc(),Vn=mn(),nd=Kn(),zn=class{constructor(e){this._key=lr(e,Et.publicKeyLength)}async verify(e,r){return Et.hashAndVerify(this._key,r,e)}marshal(){return this._key}get bytes(){return Vn.PublicKey.encode({Type:Vn.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return vc(this.bytes,e.bytes)}async hash(){let{bytes:e}=await mc.digest(this.bytes);return e}},hr=class{constructor(e,r){this._key=lr(e,Et.privateKeyLength),this._publicKey=lr(r,Et.publicKeyLength)}async sign(e){return Et.hashAndSign(this._key,e)}get public(){return new zn(this._publicKey)}marshal(){return this._key}get bytes(){return Vn.PrivateKey.encode({Type:Vn.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return vc(this.bytes,e.bytes)}async hash(){let{bytes:e}=await mc.digest(this.bytes);return e}async id(){let e=await rd.digest(this.public.bytes);return ed.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return nd.export(this.bytes,e);throw xc(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function id(t){if(t.length>Et.privateKeyLength){t=lr(t,Et.privateKeyLength+Et.publicKeyLength);let n=t.slice(0,Et.privateKeyLength),i=t.slice(Et.privateKeyLength,t.length);return new hr(n,i)}t=lr(t,Et.privateKeyLength);let e=t.slice(0,Et.privateKeyLength),r=t.slice(Et.publicKeyLength);return new hr(e,r)}function ad(t){return t=lr(t,Et.publicKeyLength),new zn(t)}async function sd(){let{privateKey:t,publicKey:e}=await Et.generateKey();return new hr(t,e)}async function od(t){let{privateKey:e,publicKey:r}=await Et.generateKeyFromSeed(t);return new hr(e,r)}function lr(t,e){if(t=Uint8Array.from(t||[]),t.length!==e)throw xc(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}bc.exports={Ed25519PublicKey:zn,Ed25519PrivateKey:hr,unmarshalEd25519PrivateKey:id,unmarshalEd25519PublicKey:ad,generateKeyPair:sd,generateKeyPairFromSeed:od}});var Uc=C(V=>{"use strict";var cd=V&&V.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(V,"__esModule",{value:!0});V.utils=V.schnorr=V.verify=V.signSync=V.sign=V.getSharedSecret=V.recoverPublicKey=V.getPublicKey=V.Signature=V.Point=V.CURVE=void 0;var ud=cd(sr()),Y=BigInt(0),ct=BigInt(1),lt=BigInt(2),Hr=BigInt(3),fd=BigInt(8),na=lt**BigInt(256),tt={a:Y,b:BigInt(7),P:na-lt**BigInt(32)-BigInt(977),n:na-BigInt("432420386565659656852420866394968145599"),h:ct,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};V.CURVE=tt;function Sc(t){let{a:e,b:r}=tt,n=D(t*t),i=D(n*t);return D(i+e*t+r)}var Hn=tt.a===Y,W=class{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof $))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new W(e.x,e.y,ct)}static toAffineBatch(e){let r=dd(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return W.toAffineBatch(e).map(W.fromAffine)}equals(e){let r=this,n=e,i=D(r.z*r.z),a=D(r.z*i),s=D(n.z*n.z),o=D(n.z*s);return D(r.x*s)===D(i*n.x)&&D(r.y*o)===D(a*n.y)}negate(){return new W(this.x,D(-this.y),this.z)}double(){let e=this.x,r=this.y,n=this.z,i=D(e**lt),a=D(r**lt),s=D(a**lt),o=D(lt*(D(D((e+a)**lt))-i-s)),u=D(Hr*i),c=D(u**lt),f=D(c-lt*o),h=D(u*(o-f)-fd*s),l=D(lt*r*n);return new W(f,h,l)}add(e){if(!(e instanceof W))throw new TypeError("JacobianPoint#add: expected JacobianPoint");let r=this.x,n=this.y,i=this.z,a=e.x,s=e.y,o=e.z;if(a===Y||s===Y)return this;if(r===Y||n===Y)return e;let u=D(i**lt),c=D(o**lt),f=D(r*c),h=D(a*u),l=D(n*o*c),d=D(D(s*i)*u),p=D(h-f),g=D(d-l);if(p===Y)return g===Y?this.double():W.ZERO;let v=D(p**lt),m=D(p*v),E=D(f*v),A=D(g**lt-m-lt*E),N=D(g*(E-A)-l*m),I=D(i*o*p);return new W(A,N,I)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=Ac(e);if(!Hn){let f=W.ZERO,h=this;for(;r>Y;)r&ct&&(f=f.add(h)),h=h.double(),r>>=ct;return f}let{k1neg:n,k1:i,k2neg:a,k2:s}=Tc(r),o=W.ZERO,u=W.ZERO,c=this;for(;i>Y||s>Y;)i&ct&&(o=o.add(c)),s&ct&&(u=u.add(c)),c=c.double(),i>>=ct,s>>=ct;return n&&(o=o.negate()),a&&(u=u.negate()),u=new W(D(u.x*tt.beta),u.y,u.z),o.add(u)}precomputeWindow(e){let r=Hn?128/e+1:256/e+1,n=[],i=this,a=i;for(let s=0;s<r;s++){a=i,n.push(a);for(let o=1;o<2**(e-1);o++)a=a.add(i),n.push(a);i=a.double()}return n}wNAF(e,r){!r&&this.equals(W.BASE)&&(r=$.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&ia.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=W.normalizeZ(i),ia.set(r,i)));let a=W.ZERO,s=W.ZERO,o=Hn?128/n+1:256/n+1,u=2**(n-1),c=BigInt(2**n-1),f=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*u,p=Number(e&c);if(e>>=h,p>u&&(p-=f,e+=ct),p===0){let g=i[d];l%2&&(g=g.negate()),s=s.add(g)}else{let g=i[d+Math.abs(p)-1];p<0&&(g=g.negate()),a=a.add(g)}}return{p:a,f:s}}multiply(e,r){let n=Ac(e),i,a;if(Hn){let{k1neg:s,k1:o,k2neg:u,k2:c}=Tc(n),{p:f,f:h}=this.wNAF(o,r),{p:l,f:d}=this.wNAF(c,r);s&&(f=f.negate()),u&&(l=l.negate()),l=new W(D(l.x*tt.beta),l.y,l.z),i=f.add(l),a=h.add(d)}else{let{p:s,f:o}=this.wNAF(n,r);i=s,a=o}return W.normalizeZ([i,a])[0]}toAffine(e=Wr(this.z)){let r=e**lt,n=D(this.x*r),i=D(this.y*r*e);return new $(n,i)}};W.BASE=new W(tt.Gx,tt.Gy,ct);W.ZERO=new W(Y,ct,Y);var ia=new WeakMap,$=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,ia.delete(this)}static fromCompressedHex(e){let r=e.length===32,n=kt(r?e:e.slice(1)),i=Sc(n),a=pd(i),s=(a&ct)===ct;r?s&&(a=D(-a)):(e[0]&1)==1!==s&&(a=D(-a));let o=new $(n,a);return o.assertValidity(),o}static fromUncompressedHex(e){let r=kt(e.slice(1,33)),n=kt(e.slice(33)),i=new $(r,n);return i.assertValidity(),i}static fromHex(e){let r=je(e),n=r[0];if(r.length===32||r.length===33&&(n===2||n===3))return this.fromCompressedHex(r);if(r.length===65&&n===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${r.length}`)}static fromPrivateKey(e){return $.BASE.multiply(Yr(e))}static fromSignature(e,r,n){let i=e instanceof Uint8Array?kt(e):pr(e),a=_c(r),{r:s,s:o}=a;if(n!==0&&n!==1)throw new Error("Cannot recover signature: invalid recovery bit");let u=2+(n&1),c=$.fromHex(`0${u}${de(s)}`),f=W.fromAffine(c).multiplyUnsafe(o),h=W.BASE.multiply(i),l=Wr(s,tt.n),p=f.subtract(h).multiplyUnsafe(l).toAffine();return p.assertValidity(),p}toRawBytes(e=!1){return ke(this.toHex(e))}toHex(e=!1){let r=de(this.x);return e?`${this.y&ct?"03":"02"}${r}`:`04${r}${de(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:n}=this;if(!ca(r)||!ca(n))throw new Error(e);let i=D(n*n),a=Sc(r);if(D(i-a)!==Y)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new $(this.x,D(-this.y))}double(){return W.fromAffine(this).double().toAffine()}add(e){return W.fromAffine(this).add(W.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return W.fromAffine(this).multiply(e,this).toAffine()}};V.Point=$;$.BASE=new $(tt.Gx,tt.Gy);$.ZERO=new $(Y,Y);function Ec(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function Bc(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${Ye(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:kt(r),left:t.subarray(e+2)}}function hd(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${Ye(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=Bc(t.subarray(2)),{data:n,left:i}=Bc(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${Ye(i)}`);return{r:e,s:n}}var ae=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=e instanceof Uint8Array,n="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?Ye(e):e;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new ae(pr(i.slice(0,64)),pr(i.slice(64,128)))}static fromDER(e){let r=e instanceof Uint8Array;if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=hd(r?e:ke(e));return new ae(n,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!$e(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!$e(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=tt.n>>ct;return this.s>e}normalizeS(){return this.hasHighS()?new ae(this.r,tt.n-this.s):this}toDERRawBytes(e=!1){return ke(this.toDERHex(e))}toDERHex(e=!1){let r=Ec(Gr(this.s));if(e)return r;let n=Ec(Gr(this.r)),i=Gr(n.length/2),a=Gr(r.length/2);return`30${Gr(n.length/2+r.length/2+4)}02${i}${n}02${a}${r}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return ke(this.toCompactHex())}toCompactHex(){return de(this.r)+de(this.s)}};V.Signature=ae;function aa(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let a=t[n];r.set(a,i),i+=a.length}return r}var ld=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ye(t){let e="";for(let r=0;r<t.length;r++)e+=ld[t[r]];return e}function de(t){if(t>na)throw new Error("pad64: invalid number");return t.toString(16).padStart(64,"0")}function sa(t){return ke(de(t))}function Gr(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function pr(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function ke(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),a=Number.parseInt(i,16);if(Number.isNaN(a))throw new Error("Invalid byte sequence");e[r]=a}return e}function je(t){return t instanceof Uint8Array?t:ke(t)}function kt(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return pr(Ye(t))}function Ac(t){if(typeof t=="number"&&t>0&&Number.isSafeInteger(t))return BigInt(t);if(typeof t=="bigint"&&$e(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function D(t,e=tt.P){let r=t%e;return r>=0?r:e+r}function Ft(t,e){let{P:r}=tt,n=t;for(;e-- >Y;)n*=n,n%=r;return n}function pd(t){let{P:e}=tt,r=BigInt(6),n=BigInt(11),i=BigInt(22),a=BigInt(23),s=BigInt(44),o=BigInt(88),u=t*t*t%e,c=u*u*t%e,f=Ft(c,Hr)*c%e,h=Ft(f,Hr)*c%e,l=Ft(h,lt)*u%e,d=Ft(l,n)*l%e,p=Ft(d,i)*d%e,g=Ft(p,s)*p%e,v=Ft(g,o)*g%e,m=Ft(v,s)*p%e,E=Ft(m,Hr)*c%e,A=Ft(E,a)*d%e,N=Ft(A,r)*u%e;return Ft(N,lt)}function Wr(t,e=tt.P){if(t===Y||e<=Y)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=D(t,e),n=e,i=Y,a=ct,s=ct,o=Y;for(;r!==Y;){let c=n/r,f=n%r,h=i-s*c,l=a-o*c;n=r,r=f,i=s,a=o,s=h,o=l}if(n!==ct)throw new Error("invert: does not exist");return D(i,e)}function dd(t,e=tt.P){let r=t.length,n=new Array(r),i=ct;for(let a=0;a<r;a++)t[a]!==Y&&(n[a]=i,i=D(i*t[a],e));i=Wr(i,e);for(let a=r-1;a>=0;a--){if(t[a]===Y)continue;let s=D(i*t[a],e);t[a]=D(i*n[a],e),i=s}return t}var Cc=(t,e)=>(t+e/lt)/e,Gn=lt**BigInt(128);function Tc(t){let{n:e}=tt,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-ct*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=r,s=Cc(a*t,e),o=Cc(-n*t,e),u=D(t-s*r-o*i,e),c=D(-s*n-o*a,e),f=u>Gn,h=c>Gn;if(f&&(u=e-u),h&&(c=e-c),u>Gn||c>Gn)throw new Error("splitScalarEndo: Endomorphism failed");return{k1neg:f,k1:u,k2neg:h,k2:c}}function yd(t){typeof t!="string"&&(t=Ye(t));let e=pr(t||"0"),n=t.length/2*8-256;return n>0&&(e=e>>BigInt(n)),e>=tt.n&&(e-=tt.n),e}var oa=class{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...e){return V.utils.hmacSha256(this.k,...e)}hmacSync(...e){if(typeof V.utils.hmacSha256Sync!="function")throw new Error("utils.hmacSha256Sync is undefined, you need to set it");let r=V.utils.hmacSha256Sync(this.k,...e);if(r instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");return r}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.incr(),this.v=this.hmacSync(this.v),this.v}};function $e(t){return Y<t&&t<tt.n}function ca(t){return 0n<t&&t<tt.P}function Ic(t,e,r){let n=kt(t);if(!$e(n))return;let{n:i}=tt,a=$.BASE.multiply(n),s=D(a.x,i);if(s===Y)return;let o=D(Wr(n,i)*D(e+r*s,i),i);if(o===Y)return;let u=new ae(s,o),c=(a.x===u.r?0:2)|Number(a.y&ct);return{sig:u,recovery:c}}function Yr(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==64)throw new Error("Expected 32 bytes of private key");e=pr(t)}else if(t instanceof Uint8Array){if(t.length!==32)throw new Error("Expected 32 bytes of private key");e=kt(t)}else throw new TypeError("Expected valid private key");if(!$e(e))throw new Error("Expected private key: 0 < key < n");return e}function ua(t){return t instanceof $?(t.assertValidity(),t):$.fromHex(t)}function _c(t){if(t instanceof ae)return t.assertValidity(),t;try{return ae.fromDER(t)}catch(e){return ae.fromCompact(t)}}function gd(t,e=!1){return $.fromPrivateKey(t).toRawBytes(e)}V.getPublicKey=gd;function xd(t,e,r){return $.fromSignature(t,e,r).toRawBytes()}V.recoverPublicKey=xd;function Rc(t){let e=t instanceof Uint8Array,r=typeof t=="string",n=(e||r)&&t.length;return e?n===33||n===65:r?n===66||n===130:t instanceof $}function vd(t,e,r=!1){if(Rc(t))throw new TypeError("getSharedSecret: first arg must be private key");if(!Rc(e))throw new TypeError("getSharedSecret: second arg must be public key");let n=ua(e);return n.assertValidity(),n.multiply(Yr(t)).toRawBytes(r)}V.getSharedSecret=vd;function Dc(t){let e=t.length>32?t.slice(0,32):t;return kt(e)}function md(t){let e=Dc(t),r=D(e,tt.n);return kc(r<Y?e:r)}function kc(t){if(typeof t!="bigint")throw new Error("Expected bigint");let e=de(t);return ke(e)}function Nc(t,e,r){if(t==null)throw new Error(`sign: expected valid msgHash, not "${t}"`);let n=je(t),i=Yr(e),a=[kc(i),md(n)];if(r!=null){r===!0&&(r=V.utils.randomBytes(32));let u=sa(kt(je(r)));if(u.length!==32)throw new Error("secp256k1: Expected 32 bytes of extra data");a.push(u)}let s=aa(...a),o=Dc(n);return{seed:s,m:o,d:i}}function Pc(t,e){let{sig:r,recovery:n}=t,{canonical:i,der:a,recovered:s}=Object.assign({canonical:!0,der:!0},e);i&&r.hasHighS()&&(r=r.normalizeS(),n^=1);let o=a?r.toDERRawBytes():r.toCompactRawBytes();return s?[o,n]:o}async function bd(t,e,r={}){let{seed:n,m:i,d:a}=Nc(t,e,r.extraEntropy),s,o=new oa;for(await o.reseed(n);!(s=Ic(await o.generate(),i,a));)await o.reseed();return Pc(s,r)}V.sign=bd;function wd(t,e,r={}){let{seed:n,m:i,d:a}=Nc(t,e,r.extraEntropy),s,o=new oa;for(o.reseedSync(n);!(s=Ic(o.generateSync(),i,a));)o.reseedSync();return Pc(s,r)}V.signSync=wd;var Sd={strict:!0};function Ed(t,e,r,n=Sd){let i;try{i=_c(t)}catch(m){return!1}let{r:a,s}=i;if(n.strict&&i.hasHighS())return!1;let o=yd(e);if(o===Y)return!1;let u;try{u=W.fromAffine(ua(r))}catch(m){return!1}let{n:c}=tt,f=Wr(s,c),h=D(o*f,c),l=D(a*f,c),d=W.BASE.multiply(h),p=u.multiplyUnsafe(l),g=d.add(p).toAffine();return D(g.x,c)===a}V.verify=Ed;async function fa(t,...e){let r=new Uint8Array(t.split("").map(a=>a.charCodeAt(0))),n=await V.utils.sha256(r),i=await V.utils.sha256(aa(n,n,...e));return kt(i)}async function Lc(t,e,r){let n=sa(t),i=await fa("BIP0340/challenge",n,e.toRawX(),r);return D(i,tt.n)}function ha(t){return D(t.y,lt)===Y}var Ze=class{constructor(e,r){if(this.r=e,this.s=r,!ca(e)||!$e(r))throw new Error("Invalid signature")}static fromHex(e){let r=je(e);if(r.length!==64)throw new TypeError(`SchnorrSignature.fromHex: expected 64 bytes, not ${r.length}`);let n=kt(r.slice(0,32)),i=kt(r.slice(32,64));return new Ze(n,i)}toHex(){return de(this.r)+de(this.s)}toRawBytes(){return ke(this.toHex())}};function Bd(t){return $.fromPrivateKey(t).toRawX()}async function Ad(t,e,r=V.utils.randomBytes()){if(t==null)throw new TypeError(`sign: Expected valid message, not "${t}"`);let{n}=tt,i=je(t),a=Yr(e),s=je(r);if(s.length!==32)throw new TypeError("sign: Expected 32 bytes of aux randomness");let o=$.fromPrivateKey(a),u=ha(o)?a:n-a,c=await fa("BIP0340/aux",s),f=u^c,h=await fa("BIP0340/nonce",sa(f),o.toRawX(),i),l=D(h,n);if(l===Y)throw new Error("sign: Creation of signature failed. k is zero");let d=$.fromPrivateKey(l),p=ha(d)?l:n-l,g=await Lc(d.x,o,i),v=new Ze(d.x,D(p+g*u,n));if(!await Kc(v.toRawBytes(),i,o.toRawX()))throw new Error("sign: Invalid signature produced");return v.toRawBytes()}async function Kc(t,e,r){let n=t instanceof Ze?t:Ze.fromHex(t),i=je(e),a=ua(r),s=await Lc(n.r,a,i),o=$.fromPrivateKey(n.s),u=a.multiply(s),c=o.subtract(u);return!(c.equals($.BASE)||!ha(c)||c.x!==n.r)}V.schnorr={Signature:Ze,getPublicKey:Bd,sign:Ad,verify:Kc};$.BASE._setWindowSize(8);var Nt={node:ud.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};V.utils={isValidPrivateKey(t){try{return Yr(t),!0}catch(e){return!1}},randomBytes:(t=32)=>{if(Nt.web)return Nt.web.getRandomValues(new Uint8Array(t));if(Nt.node){let{randomBytes:e}=Nt.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let t=8;for(;t--;){let e=V.utils.randomBytes(32),r=kt(e);if($e(r)&&r!==ct)return e}throw new Error("Valid private key was not found in 8 iterations. PRNG is broken")},bytesToHex:Ye,sha256:async t=>{if(Nt.web){let e=await Nt.web.subtle.digest("SHA-256",t.buffer);return new Uint8Array(e)}else if(Nt.node){let{createHash:e}=Nt.node;return Uint8Array.from(e("sha256").update(t).digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(Nt.web){let r=await Nt.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=aa(...e),i=await Nt.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(Nt.node){let{createHmac:r}=Nt.node,n=r("sha256",t);return e.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,precompute(t=8,e=$.BASE){let r=e===$.BASE?e:new $(e.x,e.y);return r._setWindowSize(t),r.multiply(Hr),r}}});var Fc=C((e2,Oc)=>{"use strict";var jr=Pt(),Ne=Uc(),{sha256:qc}=(nr(),Ke);Oc.exports=()=>{let t=32;function e(){return Ne.utils.randomPrivateKey()}async function r(c,f){let{digest:h}=await qc.digest(f);try{return await Ne.sign(h,c)}catch(l){throw jr(l,"ERR_INVALID_INPUT")}}async function n(c,f,h){try{let{digest:l}=await qc.digest(h);return Ne.verify(f,l,c)}catch(l){throw jr(l,"ERR_INVALID_INPUT")}}function i(c){return Ne.Point.fromHex(c).toRawBytes(!0)}function a(c){return Ne.Point.fromHex(c).toRawBytes(!1)}function s(c){try{Ne.getPublicKey(c,!0)}catch(f){throw jr(f,"ERR_INVALID_PRIVATE_KEY")}}function o(c){try{Ne.Point.fromHex(c)}catch(f){throw jr(f,"ERR_INVALID_PUBLIC_KEY")}}function u(c){try{return Ne.getPublicKey(c,!0)}catch(f){throw jr(f,"ERR_INVALID_PRIVATE_KEY")}}return{generateKey:e,privateKeyLength:t,hashAndSign:r,hashAndVerify:n,compressPublicKey:i,decompressPublicKey:a,validatePrivateKey:s,validatePublicKey:o,computePublicKey:u}}});var Hc=C((r2,zc)=>{"use strict";var{sha256:Mc}=(nr(),Ke),Cd=Pt(),{equals:Vc}=(Lr(),Pr),{toString:Td}=(be(),me),Id=Kn();zc.exports=(t,e,r)=>{r=r||Fc()();class n{constructor(c){r.validatePublicKey(c),this._key=c}verify(c,f){return r.hashAndVerify(this._key,f,c)}marshal(){return r.compressPublicKey(this._key)}get bytes(){return t.PublicKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(c){return Vc(this.bytes,c.bytes)}async hash(){let{bytes:c}=await Mc.digest(this.bytes);return c}}class i{constructor(c,f){this._key=c,this._publicKey=f||r.computePublicKey(c),r.validatePrivateKey(this._key),r.validatePublicKey(this._publicKey)}sign(c){return r.hashAndSign(this._key,c)}get public(){return new n(this._publicKey)}marshal(){return this._key}get bytes(){return t.PrivateKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(c){return Vc(this.bytes,c.bytes)}async hash(){let{bytes:c}=await Mc.digest(this.bytes);return c}async id(){let c=await this.public.hash();return Td(c,"base58btc")}async export(c,f="libp2p-key"){if(f==="libp2p-key")return Id.export(this.bytes,c);throw Cd(new Error(`export format '${f}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function a(u){return new i(u)}function s(u){return new n(u)}async function o(){let u=await r.generateKey();return new i(u)}return{Secp256k1PublicKey:n,Secp256k1PrivateKey:i,unmarshalSecp256k1PrivateKey:a,unmarshalSecp256k1PublicKey:s,generateKeyPair:o}}});var $c=C((n2,jc)=>{"use strict";var Gc=Pt(),{concat:Wc}=(Nr(),kr),{fromString:_d}=(Se(),we),Rd=Qn(),Yc={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};jc.exports=async(t,e,r)=>{let n=Yc[t];if(!n){let E=Object.keys(Yc).join(" / ");throw Gc(new Error(`unknown cipher type '${t}'. Must be ${E}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw Gc(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let i=n.keySize,a=n.ivSize,s=20,o=_d("key expansion"),u=2*(a+i+s),c=await Rd.create(e,r),f=await c.digest(o),h=[],l=0;for(;l<u;){let E=await c.digest(Wc([f,o])),A=E.length;l+A>u&&(A=u-l),h.push(E),l+=A,f=await c.digest(f)}let d=u/2,p=Wc(h),g=p.slice(0,d),v=p.slice(d,u),m=E=>({iv:E.slice(0,a),cipherKey:E.slice(a,a+i),macKey:E.slice(a+i)});return{k1:m(g),k2:m(v)}}});var Qc=C((i2,Zc)=>{"use strict";var Dd=Pt();Zc.exports=function(t,e){if(!t.includes(e)){let r=t.join(" / ");throw Dd(new Error(`Unknown curve: ${e}. Must be ${r}`),"ERR_INVALID_CURVE")}}});var nu=C(ru=>{"use strict";var kd=Pt(),$r=gr(),{base64urlToBuffer:Xc}=Ln(),Nd=Qc(),{toString:la}=(be(),me),{concat:Pd}=(Nr(),kr),{equals:Ld}=(Lr(),Pr),Jc={"P-256":256,"P-384":384,"P-521":521};ru.generateEphmeralKeyPair=async function(t){Nd(Object.keys(Jc),t);let e=await $r.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(i,a)=>{let s;a?s=await $r.get().subtle.importKey("jwk",Ud(t,a),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):s=e.privateKey;let o=[await $r.get().subtle.importKey("jwk",eu(t,i),{name:"ECDH",namedCurve:t},!1,[]),s],u=await $r.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:o[0]},o[1],Jc[t]);return new Uint8Array(u,u.byteOffset,u.byteLength)},n=await $r.get().subtle.exportKey("jwk",e.publicKey);return{key:Kd(n),genSharedKey:r}};var tu={"P-256":32,"P-384":48,"P-521":66};function Kd(t){let e=tu[t.crv];return Pd([Uint8Array.from([4]),Xc(t.x,e),Xc(t.y,e)],1+e*2)}function eu(t,e){let r=tu[t];if(Ld(!e.slice(0,1),Uint8Array.from([4])))throw kd(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:la(e.slice(1,r+1),"base64url"),y:la(e.slice(1+r),"base64url"),ext:!0}}var Ud=(t,e)=>({...eu(t,e.public),d:la(e.private,"base64url")})});var au=C((s2,iu)=>{"use strict";var qd=nu();iu.exports=async t=>qd.generateEphmeralKeyPair(t)});var cu=C((o2,ou)=>{"use strict";var se=mn();_r();Ro();var pa=Z(),Zr=Pt(),{fromString:Od}=(Se(),we),Fd=Po(),Mt={rsa:sc(),ed25519:wc(),secp256k1:Hc()(se,Pn())},Wn={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function dr(t){let e=Mt[t.toLowerCase()];if(!e){let r=Object.keys(Mt).join(" / ");throw Zr(new Error(`invalid or unsupported key type ${t}. Must be ${r}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var Md=async(t,e)=>dr(t).generateKeyPair(e),Vd=async(t,e,r)=>{let n=dr(t);if(t.toLowerCase()!=="ed25519")throw Zr(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return n.generateKeyPairFromSeed(e,r)},zd=t=>{let e=se.PublicKey.decode(t),r=e.Data;switch(e.Type){case se.KeyType.RSA:return Mt.rsa.unmarshalRsaPublicKey(r);case se.KeyType.Ed25519:return Mt.ed25519.unmarshalEd25519PublicKey(r);case se.KeyType.Secp256k1:if(Mt.secp256k1)return Mt.secp256k1.unmarshalSecp256k1PublicKey(r);throw Zr(new Error(Wn.message),Wn.code);default:dr(e.Type)}},Hd=(t,e)=>(e=(e||"rsa").toLowerCase(),dr(e),t.bytes),su=async t=>{let e=se.PrivateKey.decode(t),r=e.Data;switch(e.Type){case se.KeyType.RSA:return Mt.rsa.unmarshalRsaPrivateKey(r);case se.KeyType.Ed25519:return Mt.ed25519.unmarshalEd25519PrivateKey(r);case se.KeyType.Secp256k1:if(Mt.secp256k1)return Mt.secp256k1.unmarshalSecp256k1PrivateKey(r);throw Zr(new Error(Wn.message),Wn.code);default:dr(e.Type)}},Gd=(t,e)=>(e=(e||"rsa").toLowerCase(),dr(e),t.bytes),Wd=async(t,e)=>{try{let i=await Fd.import(t,e);return su(i)}catch(i){}let r=pa.pki.decryptRsaPrivateKey(t,e);if(r===null)throw Zr(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let n=pa.asn1.toDer(pa.pki.privateKeyToAsn1(r));return n=Od(n.getBytes(),"ascii"),Mt.rsa.unmarshalRsaPrivateKey(n)};ou.exports={supportedKeys:Mt,keysPBM:se,keyStretcher:$c(),generateEphemeralKeyPair:au(),generateKeyPair:Md,generateKeyPairFromSeed:Vd,unmarshalPublicKey:zd,marshalPublicKey:Hd,unmarshalPrivateKey:su,marshalPrivateKey:Gd,import:Wd}});var hu=C((c2,fu)=>{"use strict";var Yd=qi(),jd=ut(),$d=Pt(),uu={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function Zd(t,e,r,n,i){let a=uu[i];if(!a){let o=Object.keys(uu).join(" / ");throw $d(new Error(`Hash '${i}' is unknown or not supported. Must be ${o}`),"ERR_UNSUPPORTED_HASH_TYPE")}let s=Yd(t,e,r,n,a);return jd.encode64(s)}fu.exports=Zd});var ty=C(yr=>{"use strict";var Qd=Qn(),Xd=_s(),Jd=cu();yr.aes=Xd;yr.hmac=Qd;yr.keys=Jd;yr.randomBytes=Pn();yr.pbkdf2=hu()});return ty();})();
/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
return Libp2pCrypto}));
