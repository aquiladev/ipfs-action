(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.InterfaceDatastore = factory()}(typeof self !== 'undefined' ? self : this, function () {
var InterfaceDatastore=(()=>{var ce=Object.defineProperty;var Be=r=>ce(r,"__esModule",{value:!0});var Jt=typeof require!="undefined"?require:r=>{throw new Error('Dynamic require of "'+r+'" is not supported')};var m=(r,e)=>{Be(r);for(var t in e)ce(r,t,{get:e[t],enumerable:!0})};var qt={};m(qt,{Key:()=>f});var he=(r=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(r));for(;r--;){let n=t[r]&63;n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n<63?e+="_":e+="-"}return e};var G={};m(G,{identity:()=>Pe});function Ve(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var o=r.charAt(s),i=o.charCodeAt(0);if(t[i]!==255)throw new TypeError(o+" is ambiguous");t[i]=s}var h=r.length,p=r.charAt(0),I=Math.log(h)/Math.log(256),l=Math.log(256)/Math.log(h);function N(a){if(a instanceof Uint8Array||(ArrayBuffer.isView(a)?a=new Uint8Array(a.buffer,a.byteOffset,a.byteLength):Array.isArray(a)&&(a=Uint8Array.from(a))),!(a instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(a.length===0)return"";for(var u=0,U=0,g=0,y=a.length;g!==y&&a[g]===0;)g++,u++;for(var x=(y-g)*l+1>>>0,b=new Uint8Array(x);g!==y;){for(var v=a[g],C=0,w=x-1;(v!==0||C<U)&&w!==-1;w--,C++)v+=256*b[w]>>>0,b[w]=v%h>>>0,v=v/h>>>0;if(v!==0)throw new Error("Non-zero carry");U=C,g++}for(var j=x-U;j!==x&&b[j]===0;)j++;for(var $=p.repeat(u);j<x;++j)$+=r.charAt(b[j]);return $}function k(a){if(typeof a!="string")throw new TypeError("Expected String");if(a.length===0)return new Uint8Array;var u=0;if(a[u]!==" "){for(var U=0,g=0;a[u]===p;)U++,u++;for(var y=(a.length-u)*I+1>>>0,x=new Uint8Array(y);a[u];){var b=t[a.charCodeAt(u)];if(b===255)return;for(var v=0,C=y-1;(b!==0||v<g)&&C!==-1;C--,v++)b+=h*x[C]>>>0,x[C]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");g=v,u++}if(a[u]!==" "){for(var w=y-g;w!==y&&x[w]===0;)w++;for(var j=new Uint8Array(U+(y-w)),$=U;w!==y;)j[$++]=x[w++];return j}}}function Oe(a){var u=k(a);if(u)return u;throw new Error(`Non-${e} character`)}return{encode:N,decodeUnsafe:k,decode:Oe}}var Re=Ve,ke=Re,de=ke;var Yt=new Uint8Array(0);var fe=(r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0},E=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")};var pe=r=>new TextEncoder().encode(r),ue=r=>new TextDecoder().decode(r);var be=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},me=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseDecode=n}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){let t={[this.prefix]:this,...e.decoders||{[e.prefix]:e}};return new F(t)}},F=class{constructor(e){this.decoders=e}or(e){let t=e.decoders||{[e.prefix]:e};return new F({...this.decoders,...t})}decode(e){let t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},ge=class{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new be(e,t,n),this.decoder=new me(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},P=({name:r,prefix:e,encode:t,decode:n})=>new ge(r,e,t,n),D=({prefix:r,name:e,alphabet:t})=>{let{encode:n,decode:s}=de(t,e);return P({prefix:r,name:e,encode:n,decode:o=>E(s(o))})},$e=(r,e,t,n)=>{let s={};for(let l=0;l<e.length;++l)s[e[l]]=l;let o=r.length;for(;r[o-1]==="=";)--o;let i=new Uint8Array(o*t/8|0),h=0,p=0,I=0;for(let l=0;l<o;++l){let N=s[r[l]];if(N===void 0)throw new SyntaxError(`Non-${n} character`);p=p<<t|N,h+=t,h>=8&&(h-=8,i[I++]=255&p>>h)}if(h>=t||255&p<<8-h)throw new SyntaxError("Unexpected end of data");return i},Fe=(r,e,t)=>{let n=e[e.length-1]==="=",s=(1<<t)-1,o="",i=0,h=0;for(let p=0;p<r.length;++p)for(h=h<<8|r[p],i+=8;i>t;)i-=t,o+=e[s&h>>i];if(i&&(o+=e[s&h<<t-i]),n)for(;o.length*t&7;)o+="=";return o},c=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>P({prefix:e,name:r,encode(s){return Fe(s,n,t)},decode(s){return $e(s,n,t,r)}});var Pe=P({prefix:"\0",name:"identity",encode:r=>ue(r),decode:r=>pe(r)});var Q={};m(Q,{base2:()=>qe});var qe=c({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var H={};m(H,{base8:()=>Je});var Je=c({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Y={};m(Y,{base10:()=>We});var We=D({prefix:"9",name:"base10",alphabet:"0123456789"});var Z={};m(Z,{base16:()=>Xe,base16upper:()=>_e});var Xe=c({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),_e=c({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var K={};m(K,{base32:()=>z,base32hex:()=>Ye,base32hexpad:()=>Ke,base32hexpadupper:()=>et,base32hexupper:()=>Ze,base32pad:()=>Qe,base32padupper:()=>He,base32upper:()=>Ge,base32z:()=>tt});var z=c({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ge=c({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Qe=c({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),He=c({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ye=c({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ze=c({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ke=c({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),et=c({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),tt=c({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ee={};m(ee,{base36:()=>rt,base36upper:()=>nt});var rt=D({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),nt=D({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var te={};m(te,{base58btc:()=>S,base58flickr:()=>st});var S=D({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),st=D({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var re={};m(re,{base64:()=>ot,base64pad:()=>it,base64url:()=>at,base64urlpad:()=>ct});var ot=c({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),it=c({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),at=c({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ct=c({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var se={};m(se,{sha256:()=>Dt,sha512:()=>Ut});var ht=ye,we=128,dt=127,ft=~dt,pt=Math.pow(2,31);function ye(r,e,t){e=e||[],t=t||0;for(var n=t;r>=pt;)e[t++]=r&255|we,r/=128;for(;r&ft;)e[t++]=r&255|we,r>>>=7;return e[t]=r|0,ye.bytes=t-n+1,e}var ut=ne,lt=128,xe=127;function ne(r,e){var t=0,e=e||0,n=0,s=e,o,i=r.length;do{if(s>=i)throw ne.bytes=0,new RangeError("Could not decode varint");o=r[s++],t+=n<28?(o&xe)<<n:(o&xe)*Math.pow(2,n),n+=7}while(o>=lt);return ne.bytes=s-e,t}var bt=Math.pow(2,7),mt=Math.pow(2,14),gt=Math.pow(2,21),wt=Math.pow(2,28),yt=Math.pow(2,35),xt=Math.pow(2,42),vt=Math.pow(2,49),St=Math.pow(2,56),jt=Math.pow(2,63),Et=function(r){return r<bt?1:r<mt?2:r<gt?3:r<wt?4:r<yt?5:r<xt?6:r<vt?7:r<St?8:r<jt?9:10},At={encode:ht,decode:ut,encodingLength:Et},Ct=At,M=Ct;var O=r=>[M.decode(r),M.decode.bytes],T=(r,e,t=0)=>(M.encode(r,e,t),e),L=r=>M.encodingLength(r);var q=(r,e)=>{let t=e.byteLength,n=L(r),s=n+L(t),o=new Uint8Array(s+t);return T(r,o,0),T(t,o,n),o.set(e,s),new B(r,t,e,o)},Se=r=>{let e=E(r),[t,n]=O(e),[s,o]=O(e.subarray(n)),i=e.subarray(n+o);if(i.byteLength!==s)throw new Error("Incorrect length");return new B(t,s,i,e)},je=(r,e)=>r===e?!0:r.code===e.code&&r.size===e.size&&fe(r.bytes,e.bytes),B=class{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}};var V=({name:r,code:e,encode:t})=>new Ae(r,e,t),Ae=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}async digest(e){if(e instanceof Uint8Array){let t=await this.encode(e);return q(this.code,t)}else throw Error("Unknown type, must be binary type")}};var De=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),Dt=V({name:"sha2-256",code:18,encode:De("SHA-256")}),Ut=V({name:"sha2-512",code:19,encode:De("SHA-512")});var oe={};m(oe,{identity:()=>It});var It=V({name:"identity",code:0,encode:r=>E(r)});var xr=new TextEncoder,vr=new TextDecoder;var d=class{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this.byteOffset=s.byteOffset,this.byteLength=s.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:W,byteLength:W,code:J,version:J,multihash:J,bytes:J,_baseCache:W,asCID:W})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:t}=this;if(e!==R)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Ot)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return d.createV0(t)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,n=q(e,t);return d.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&je(this.multihash,e.multihash)}toString(e){let{bytes:t,version:n,_baseCache:s}=this;switch(n){case 0:return Lt(t,s,e||S.encoder);default:return Mt(t,s,e||z.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return Vt(/^0\.0/,Rt),!!(e&&(e[Ie]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof d)return e;if(e!=null&&e.asCID===e){let{version:t,code:n,multihash:s,bytes:o}=e;return new d(t,n,s,o||Ue(t,n,s.bytes))}else if(e!=null&&e[Ie]===!0){let{version:t,multihash:n,code:s}=e,o=Se(n);return d.create(t,s,o)}else return null}static create(e,t,n){if(typeof t!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(t!==R)throw new Error(`Version 0 CID must use dag-pb (code: ${R}) block encoding`);return new d(e,t,n,n.bytes)}case 1:{let s=Ue(e,t,n.bytes);return new d(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return d.create(0,R,e)}static createV1(e,t){return d.create(1,e,t)}static decode(e){let[t,n]=d.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=d.inspectBytes(e),n=t.size-t.multihashSize,s=E(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");let o=s.subarray(t.multihashSize-t.digestSize),i=new B(t.multihashCode,t.digestSize,o,s);return[t.version===0?d.createV0(i):d.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0,n=()=>{let[N,k]=O(e.subarray(t));return t+=k,N},s=n(),o=R;if(s===18?(s=0,t=0):s===1&&(o=n()),s!==0&&s!==1)throw new RangeError(`Invalid CID version ${s}`);let i=t,h=n(),p=n(),I=t+p,l=I-i;return{version:s,codec:o,multihashCode:h,digestSize:p,multihashSize:l,size:I}}static parse(e,t){let[n,s]=Tt(e,t),o=d.decode(s);return o._baseCache.set(n,e),o}},Tt=(r,e)=>{switch(r[0]){case"Q":{let t=e||S;return[S.prefix,t.decode(`${S.prefix}${r}`)]}case S.prefix:{let t=e||S;return[S.prefix,t.decode(r)]}case z.prefix:{let t=e||z;return[z.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}},Lt=(r,e,t)=>{let{prefix:n}=t;if(n!==S.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let s=e.get(n);if(s==null){let o=t.encode(r).slice(1);return e.set(n,o),o}else return s},Mt=(r,e,t)=>{let{prefix:n}=t,s=e.get(n);if(s==null){let o=t.encode(r);return e.set(n,o),o}else return s},R=112,Ot=18,Ue=(r,e,t)=>{let n=L(r),s=n+L(e),o=new Uint8Array(s+t.byteLength);return T(r,o,0),T(e,o,n),o.set(t,s),o},Ie=Symbol.for("@ipld/js-cid/CID"),J={writable:!1,configurable:!1,enumerable:!0},W={writable:!1,enumerable:!1,configurable:!1},Bt="0.0.0-dev",Vt=(r,e)=>{if(r.test(Bt))console.warn(e);else throw new Error(e)},Rt=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`;var ie={...G,...Q,...H,...Y,...Z,...K,...ee,...te,...re},zr={...se,...oe};function Ne(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}var ze=Ne("utf8","u",r=>{let e=new TextDecoder("utf8");return"u"+e.decode(r)},r=>new TextEncoder().encode(r.substring(1))),ae=Ne("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);let e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),kt={utf8:ze,"utf-8":ze,hex:ie.base16,latin1:ae,ascii:ae,binary:ae,...ie},X=kt;function Te(r,e="utf8"){let t=X[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return t.encoder.encode(r).substring(1)}function Le(r,e="utf8"){let t=X[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return t.decoder.decode(`${t.prefix}${r}`)}var A="/",Me=new TextEncoder().encode(A),_=Me[0],f=class{constructor(e,t){if(typeof e=="string")this._buf=Le(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==_)throw new Error("Invalid key")}toString(e="utf8"){return Te(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new f(e.join(A))}static random(){return new f(he().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new f(e):e.uint8Array?new f(e.uint8Array()):null}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=Me),this._buf[0]!==_){let e=new Uint8Array(this._buf.byteLength+1);e.fill(_,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===_;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),n=e.list();for(let s=0;s<t.length;s++){if(n.length<s+1)return!1;let o=t[s],i=n[s];if(o<i)return!0;if(o>i)return!1}return t.length<n.length}reverse(){return f.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(A).slice(1)}type(){return $t(this.baseNamespace())}name(){return Ft(this.baseNamespace())}instance(e){return new f(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(A)||(e+=A),e+=this.type(),new f(e)}parent(){let e=this.list();return e.length===1?new f(A):new f(e.slice(0,-1).join(A))}child(e){return this.toString()===A?e:e.toString()===A?this:new f(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return f.withNamespaces([...this.namespaces(),...Pt(e.map(t=>t.namespaces()))])}};function $t(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function Ft(r){let e=r.split(":");return e[e.length-1]}function Pt(r){return[].concat(...r)}return qt;})();
return InterfaceDatastore}));
