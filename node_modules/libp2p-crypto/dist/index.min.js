(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2pCrypto = factory()}(typeof self !== 'undefined' ? self : this, function () {
var Libp2pCrypto=(()=>{var ia=Object.defineProperty;var eu=e=>ia(e,"__esModule",{value:!0});var Fr=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(t,r)=>(typeof require!="undefined"?require:t)[r]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var Q=(e,t)=>()=>(e&&(t=e(e=0)),t);var C=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ve=(e,t)=>{eu(e);for(var r in t)ia(e,r,{get:t[r],enumerable:!0})};var ar=C(aa=>{"use strict";aa.get=(e=globalThis)=>{let t=e.crypto;if(!t||!t.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}});var oa=C((kd,sa)=>{"use strict";sa.exports={SHA1:20,SHA256:32,SHA512:64}});var Wn=C(ua=>{"use strict";var fa=ar(),tu=oa(),ru={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},nu=async(e,t)=>{let r=await fa.get().subtle.sign({name:"HMAC"},e,t);return new Uint8Array(r,r.byteOffset,r.byteLength)};ua.create=async function(e,t){let r=ru[e],n=await fa.get().subtle.importKey("raw",t,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return nu(n,i)},length:tu[e]}}});var $=C((Nd,ca)=>{ca.exports={options:{usePureJavaScript:!1}}});var pa=C((Ld,la)=>{var jn={};la.exports=jn;var ha={};jn.encode=function(e,t,r){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(e instanceof Uint8Array))n=iu(e,t);else{var i=0,a=t.length,s=t.charAt(0),o=[0];for(i=0;i<e.length;++i){for(var u=0,f=e[i];u<o.length;++u)f+=o[u]<<8,o[u]=f%a,f=f/a|0;for(;f>0;)o.push(f%a),f=f/a|0}for(i=0;e[i]===0&&i<e.length-1;++i)n+=s;for(i=o.length-1;i>=0;--i)n+=t[o[i]]}if(r){var c=new RegExp(".{1,"+r+"}","g");n=n.match(c).join(`\r
`)}return n};jn.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var r=ha[t];if(!r){r=ha[t]=[];for(var n=0;n<t.length;++n)r[t.charCodeAt(n)]=n}e=e.replace(/\s/g,"");for(var i=t.length,a=t.charAt(0),s=[0],n=0;n<e.length;n++){var o=r[e.charCodeAt(n)];if(o===void 0)return;for(var u=0,f=o;u<s.length;++u)f+=s[u]*i,s[u]=f&255,f>>=8;for(;f>0;)s.push(f&255),f>>=8}for(var c=0;e[c]===a&&c<e.length-1;++c)s.push(0);return typeof Buffer!="undefined"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function iu(e,t){var r=0,n=t.length,i=t.charAt(0),a=[0];for(r=0;r<e.length();++r){for(var s=0,o=e.at(r);s<a.length;++s)o+=a[s]<<8,a[s]=o%n,o=o/n|0;for(;o>0;)a.push(o%n),o=o/n|0}var u="";for(r=0;e.at(r)===0&&r<e.length()-1;++r)u+=i;for(r=a.length-1;r>=0;--r)u+=t[a[r]];return u}});var se=C((Kd,xa)=>{var da=$(),ya=pa(),d=xa.exports=da.util=da.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){d.nextTick=process.nextTick,typeof setImmediate=="function"?d.setImmediate=setImmediate:d.setImmediate=d.nextTick;return}if(typeof setImmediate=="function"){d.setImmediate=function(){return setImmediate.apply(void 0,arguments)},d.nextTick=function(o){return setImmediate(o)};return}if(d.setImmediate=function(o){setTimeout(o,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let o=function(u){if(u.source===window&&u.data===e){u.stopPropagation();var f=t.slice();t.length=0,f.forEach(function(c){c()})}};var s=o,e="forge.setImmediate",t=[];d.setImmediate=function(u){t.push(u),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver!="undefined"){var r=Date.now(),n=!0,i=document.createElement("div"),t=[];new MutationObserver(function(){var u=t.slice();t.length=0,u.forEach(function(f){f()})}).observe(i,{attributes:!0});var a=d.setImmediate;d.setImmediate=function(u){Date.now()-r>15?(r=Date.now(),a(u)):(t.push(u),t.length===1&&i.setAttribute("a",n=!n))}}d.nextTick=d.setImmediate})();d.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;d.globalScope=function(){return d.isNodejs?globalThis:typeof self=="undefined"?window:self}();d.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};d.isArrayBuffer=function(e){return typeof ArrayBuffer!="undefined"&&e instanceof ArrayBuffer};d.isArrayBufferView=function(e){return e&&d.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function sr(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}d.ByteBuffer=Yn;function Yn(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(d.isArrayBuffer(e)||d.isArrayBufferView(e))if(typeof Buffer!="undefined"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(n){for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof Yn||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}d.ByteStringBuffer=Yn;var au=4096;d.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>au&&(this.data.substr(0,1),this._constructedStringLength=0)};d.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};d.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};d.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};d.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this};d.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};d.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(d.encodeUtf8(e))};d.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};d.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};d.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};d.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};d.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};d.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};d.ByteStringBuffer.prototype.putInt=function(e,t){sr(t);var r="";do t-=8,r+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(r)};d.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};d.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};d.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};d.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};d.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};d.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};d.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};d.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};d.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};d.ByteStringBuffer.prototype.getInt=function(e){sr(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};d.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};d.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};d.ByteStringBuffer.prototype.bytes=function(e){return typeof e=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};d.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};d.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};d.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};d.ByteStringBuffer.prototype.copy=function(){var e=d.createBuffer(this.data);return e.read=this.read,e};d.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};d.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};d.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};d.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e};d.ByteStringBuffer.prototype.toString=function(){return d.decodeUtf8(this.bytes())};function su(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=d.isArrayBuffer(e),n=d.isArrayBufferView(e);if(r||n){r?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}d.DataBuffer=su;d.DataBuffer.prototype.length=function(){return this.write-this.read};d.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};d.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this};d.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};d.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this};d.DataBuffer.prototype.putBytes=function(e,t){if(d.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(d.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof d.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&d.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(e instanceof d.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var a;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),a=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.hex.decode(e,a,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),a=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.base64.decode(e,a,this.write),this;if(t==="utf8"&&(e=d.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),a=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.raw.decode(a),this;if(t==="utf16")return this.accommodate(e.length*2),a=new Uint16Array(this.data.buffer,this.write),this.write+=d.text.utf16.encode(a),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};d.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};d.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};d.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};d.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};d.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};d.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};d.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};d.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};d.DataBuffer.prototype.putInt=function(e,t){sr(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};d.DataBuffer.prototype.putSignedInt=function(e,t){return sr(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};d.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};d.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};d.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};d.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};d.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};d.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};d.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};d.DataBuffer.prototype.getInt=function(e){sr(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};d.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};d.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};d.DataBuffer.prototype.bytes=function(e){return typeof e=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};d.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};d.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};d.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};d.DataBuffer.prototype.copy=function(){return new d.DataBuffer(this)};d.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};d.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};d.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};d.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e};d.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return d.binary.raw.encode(t);if(e==="hex")return d.binary.hex.encode(t);if(e==="base64")return d.binary.base64.encode(t);if(e==="utf8")return d.text.utf8.decode(t);if(e==="utf16")return d.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};d.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=d.encodeUtf8(e)),new d.ByteBuffer(e)};d.fillString=function(e,t){for(var r="";t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return r};d.xorBytes=function(e,t,r){for(var n="",i="",a="",s=0,o=0;r>0;--r,++s)i=e.charCodeAt(s)^t.charCodeAt(s),o>=10&&(n+=a,a="",o=0),a+=String.fromCharCode(i),++o;return n+=a,n};d.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t};d.bytesToHex=function(e){return d.createBuffer(e).toHex()};d.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var ut="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ct=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],ga="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";d.encode64=function(e,t){for(var r="",n="",i,a,s,o=0;o<e.length;)i=e.charCodeAt(o++),a=e.charCodeAt(o++),s=e.charCodeAt(o++),r+=ut.charAt(i>>2),r+=ut.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=ut.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":ut.charAt(s&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};d.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",r,n,i,a,s=0;s<e.length;)r=ct[e.charCodeAt(s++)-43],n=ct[e.charCodeAt(s++)-43],i=ct[e.charCodeAt(s++)-43],a=ct[e.charCodeAt(s++)-43],t+=String.fromCharCode(r<<2|n>>4),i!==64&&(t+=String.fromCharCode((n&15)<<4|i>>2),a!==64&&(t+=String.fromCharCode((i&3)<<6|a)));return t};d.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};d.decodeUtf8=function(e){return decodeURIComponent(escape(e))};d.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:ya.encode,decode:ya.decode}};d.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};d.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,a=0;a<e.length;++a)n[i++]=e.charCodeAt(a);return t?i-r:n};d.binary.hex.encode=d.bytesToHex;d.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2))),r=r||0;var i=0,a=r;for(e.length&1&&(i=1,n[a++]=parseInt(e[0],16));i<e.length;i+=2)n[a++]=parseInt(e.substr(i,2),16);return t?a-r:n};d.binary.base64.encode=function(e,t){for(var r="",n="",i,a,s,o=0;o<e.byteLength;)i=e[o++],a=e[o++],s=e[o++],r+=ut.charAt(i>>2),r+=ut.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=ut.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":ut.charAt(s&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};d.binary.base64.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,a,s,o,u=0,f=r;u<e.length;)i=ct[e.charCodeAt(u++)-43],a=ct[e.charCodeAt(u++)-43],s=ct[e.charCodeAt(u++)-43],o=ct[e.charCodeAt(u++)-43],n[f++]=i<<2|a>>4,s!==64&&(n[f++]=(a&15)<<4|s>>2,o!==64&&(n[f++]=(s&3)<<6|o));return t?f-r:n.subarray(0,f)};d.binary.base58.encode=function(e,t){return d.binary.baseN.encode(e,ga,t)};d.binary.base58.decode=function(e,t){return d.binary.baseN.decode(e,ga,t)};d.text={utf8:{},utf16:{}};d.text.utf8.encode=function(e,t,r){e=d.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,a=0;a<e.length;++a)n[i++]=e.charCodeAt(a);return t?i-r:n};d.text.utf8.decode=function(e){return d.decodeUtf8(String.fromCharCode.apply(null,e))};d.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var a=r,s=r,o=0;o<e.length;++o)i[s++]=e.charCodeAt(o),a+=2;return t?a-r:n};d.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};d.deflate=function(e,t,r){if(t=d.decode64(e.deflate(d.encode64(t)).rval),r){var n=2,i=t.charCodeAt(1);i&32&&(n=6),t=t.substring(n,t.length-4)}return t};d.inflate=function(e,t,r){var n=e.inflate(d.encode64(t)).rval;return n===null?null:d.decode64(n)};var $n=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(r===null?n=e.removeItem(t):(r=d.encode64(JSON.stringify(r)),n=e.setItem(t,r)),typeof n!="undefined"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Qn=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(d.decode64(r))),r},ou=function(e,t,r,n){var i=Qn(e,t);i===null&&(i={}),i[r]=n,$n(e,t,i)},fu=function(e,t,r){var n=Qn(e,t);return n!==null&&(n=r in n?n[r]:null),n},uu=function(e,t,r){var n=Qn(e,t);if(n!==null&&r in n){delete n[r];var i=!0;for(var a in n){i=!1;break}i&&(n=null),$n(e,t,n)}},cu=function(e,t){$n(e,t,null)},Mr=function(e,t,r){var n=null;typeof r=="undefined"&&(r=["web","flash"]);var i,a=!1,s=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");n=e.apply(this,t),a=i==="flash"}(i==="web"||i==="both")&&(t[0]=localStorage,n=e.apply(this,t),a=!0)}catch(u){s=u}if(a)break}if(!a)throw s;return n};d.setItem=function(e,t,r,n,i){Mr(ou,arguments,i)};d.getItem=function(e,t,r,n){return Mr(fu,arguments,n)};d.removeItem=function(e,t,r,n){Mr(uu,arguments,n)};d.clearItems=function(e,t,r){Mr(cu,arguments,r)};d.parseUrl=function(e){var t=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;t.lastIndex=0;var r=t.exec(e),n=r===null?null:{full:e,scheme:r[1],host:r[2],port:r[3],path:r[4]};return n&&(n.fullHost=n.host,n.port?(n.port!==80&&n.scheme==="http"||n.port!==443&&n.scheme==="https")&&(n.fullHost+=":"+n.port):n.scheme==="http"?n.port=80:n.scheme==="https"&&(n.port=443),n.full=n.scheme+"://"+n.fullHost),n};var Vr=null;d.getQueryVariables=function(e){var t=function(n){for(var i={},a=n.split("&"),s=0;s<a.length;s++){var o=a[s].indexOf("="),u,f;o>0?(u=a[s].substring(0,o),f=a[s].substring(o+1)):(u=a[s],f=null),u in i||(i[u]=[]),!(u in Object.prototype)&&f!==null&&i[u].push(unescape(f))}return i},r;return typeof e=="undefined"?(Vr===null&&(typeof window!="undefined"&&window.location&&window.location.search?Vr=t(window.location.search.substring(1)):Vr={}),r=Vr):r=t(e),r};d.parseFragment=function(e){var t=e,r="",n=e.indexOf("?");n>0&&(t=e.substring(0,n),r=e.substring(n+1));var i=t.split("/");i.length>0&&i[0]===""&&i.shift();var a=r===""?{}:d.getQueryVariables(r);return{pathString:t,queryString:r,path:i,query:a}};d.makeRequest=function(e){var t=d.parseFragment(e),r={path:t.pathString,query:t.queryString,getPath:function(n){return typeof n=="undefined"?t.path:t.path[n]},getQuery:function(n,i){var a;return typeof n=="undefined"?a=t.query:(a=t.query[n],a&&typeof i!="undefined"&&(a=a[i])),a},getQueryLast:function(n,i){var a,s=r.getQuery(n);return s?a=s[s.length-1]:a=i,a}};return r};d.makeLink=function(e,t,r){e=jQuery.isArray(e)?e.join("/"):e;var n=jQuery.param(t||{});return r=r||"",e+(n.length>0?"?"+n:"")+(r.length>0?"#"+r:"")};d.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};d.format=function(e){for(var t=/%./g,r,n,i=0,a=[],s=0;r=t.exec(e);){n=e.substring(s,t.lastIndex-2),n.length>0&&a.push(n),s=t.lastIndex;var o=r[0][1];switch(o){case"s":case"o":i<arguments.length?a.push(arguments[i+++1]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+o+"?>")}}return a.push(e.substring(s)),a.join("")};d.formatNumber=function(e,t,r,n){var i=e,a=isNaN(t=Math.abs(t))?2:t,s=r===void 0?",":r,o=n===void 0?".":n,u=i<0?"-":"",f=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",c=f.length>3?f.length%3:0;return u+(c?f.substr(0,c)+o:"")+f.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+o)+(a?s+Math.abs(i-f).toFixed(a).slice(2):"")};d.formatSize=function(e){return e>=1073741824?e=d.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=d.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=d.formatNumber(e/1024,0)+" KiB":e=d.formatNumber(e,0)+" bytes",e};d.bytesFromIP=function(e){return e.indexOf(".")!==-1?d.bytesFromIPv4(e):e.indexOf(":")!==-1?d.bytesFromIPv6(e):null};d.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=d.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()};d.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(s){return s.length===0&&++t,!0});for(var r=(8-e.length+t)*2,n=d.createBuffer(),i=0;i<8;++i){if(!e[i]||e[i].length===0){n.fillWithByte(0,r),r=0;continue}var a=d.hexToBytes(e[i]);a.length<2&&n.putByte(0),n.putBytes(a)}return n.getBytes()};d.bytesToIP=function(e){return e.length===4?d.bytesToIPv4(e):e.length===16?d.bytesToIPv6(e):null};d.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")};d.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var a=d.bytesToHex(e[i]+e[i+1]);a[0]==="0"&&a!=="0";)a=a.substr(1);if(a==="0"){var s=r[r.length-1],o=t.length;!s||o!==s.end+1?r.push({start:o,end:o}):(s.end=o,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}t.push(a)}if(r.length>0){var u=r[n];u.end-u.start>0&&(t.splice(u.start,u.end-u.start+1,""),u.start===0&&t.unshift(""),u.end===7&&t.push(""))}return t.join(":")};d.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in d&&!e.update)return t(null,d.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return d.cores=navigator.hardwareConcurrency,t(null,d.cores);if(typeof Worker=="undefined")return d.cores=1,t(null,d.cores);if(typeof Blob=="undefined")return d.cores=2,t(null,d.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var o=Date.now(),u=o+4;Date.now()<u;);self.postMessage({st:o,et:u})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,o,u){if(o===0){var f=Math.floor(s.reduce(function(c,h){return c+h},0)/s.length);return d.cores=Math.max(1,f),URL.revokeObjectURL(r),t(null,d.cores)}i(u,function(c,h){s.push(a(u,h)),n(s,o-1,u)})}function i(s,o){for(var u=[],f=[],c=0;c<s;++c){var h=new Worker(r);h.addEventListener("message",function(l){if(f.push(l.data),f.length===s){for(var y=0;y<s;++y)u[y].terminate();o(null,f)}}),u.push(h)}for(var c=0;c<s;++c)u[c].postMessage(c)}function a(s,o){for(var u=[],f=0;f<s;++f)for(var c=o[f],h=u[f]=[],l=0;l<s;++l)if(f!==l){var y=o[l];(c.st>y.st&&c.st<y.et||y.st>c.st&&y.st<c.et)&&h.push(l)}return u.reduce(function(p,g){return Math.max(p,g.length)},0)}}});var Xn=C((Ud,va)=>{var ue=$();se();va.exports=ue.cipher=ue.cipher||{};ue.cipher.algorithms=ue.cipher.algorithms||{};ue.cipher.createCipher=function(e,t){var r=e;if(typeof r=="string"&&(r=ue.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new ue.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})};ue.cipher.createDecipher=function(e,t){var r=e;if(typeof r=="string"&&(r=ue.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new ue.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})};ue.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),ue.cipher.algorithms[e]=t};ue.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in ue.cipher.algorithms?ue.cipher.algorithms[e]:null};var Zn=ue.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};Zn.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=ue.util.createBuffer(),this.output=e.output||ue.util.createBuffer(),this.mode.start(t)};Zn.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Zn.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return e(this.blockSize,r,!1)},this.mode.unpad=function(r){return e(this.blockSize,r,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))}});var ei=C((qd,ma)=>{var ce=$();se();ce.cipher=ce.cipher||{};var q=ma.exports=ce.cipher.modes=ce.cipher.modes||{};q.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};q.ecb.prototype.start=function(e){};q.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};q.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};q.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};q.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};q.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};q.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=zr(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};q.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock};q.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};q.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};q.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};q.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=ce.util.createBuffer(),this._partialBytes=0};q.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=zr(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};q.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(a>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};q.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(a>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};q.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=ce.util.createBuffer(),this._partialBytes=0};q.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=zr(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};q.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(a>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};q.ofb.prototype.decrypt=q.ofb.prototype.encrypt;q.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=ce.util.createBuffer(),this._partialBytes=0};q.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=zr(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};q.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(a>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Hr(this._inBlock)};q.ctr.prototype.decrypt=q.ctr.prototype.encrypt;q.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=ce.util.createBuffer(),this._partialBytes=0,this._R=3774873600};q.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=ce.util.createBuffer(e.iv);this._cipherLength=0;var r;if("additionalData"in e?r=ce.util.createBuffer(e.additionalData):r=ce.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=ce.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=t.length();if(n===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Jn(n*8)))}this._inBlock=this._j0.slice(0),Hr(this._inBlock),this._partialBytes=0,r=ce.util.createBuffer(r),this._aDataLength=Jn(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};q.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(a<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Hr(this._inBlock)};q.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Hr(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};q.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=ce.util.createBuffer();var n=this._aDataLength.concat(Jn(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var a=0;a<this._ints;++a)this.tag.putInt32(this._s[a]^i[a]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};q.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){var a=e[i/32|0]&1<<31-i%32;a&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};q.gcm.prototype.pow=function(e,t){for(var r=e[3]&1,n=3;n>0;--n)t[n]=e[n]>>>1|(e[n-1]&1)<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)};q.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=e[n]>>>(7-r%8)*4&15,a=this._m[r][i];t[0]^=a[0],t[1]^=a[1],t[2]^=a[2],t[3]^=a[3]}return t};q.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)};q.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,a=new Array(i),s=0;s<i;++s){var o=[0,0,0,0],u=s/n|0,f=(n-1-s%n)*t;o[u]=1<<t-1<<f,a[s]=this.generateSubHashTable(this.multiply(o,e),t)}return a};q.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var a=n>>>1;a>0;)this.pow(i[2*a],i[a]=[]),a>>=1;for(a=2;a<n;){for(var s=1;s<a;++s){var o=i[a],u=i[s];i[a+s]=[o[0]^u[0],o[1]^u[1],o[2]^u[2],o[3]^u[3]]}a*=2}for(i[0]=[0,0,0,0],a=n+1;a<r;++a){var f=i[a^n];i[a]=[e[0]^f[0],e[1]^f[1],e[2]^f[2],e[3]^f[3]]}return i};function zr(e,t){if(typeof e=="string"&&(e=ce.util.createBuffer(e)),ce.util.isArray(e)&&e.length>4){var r=e;e=ce.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!ce.util.isArray(e)){for(var i=[],a=t/4,n=0;n<a;++n)i.push(e.getInt32());e=i}return e}function Hr(e){e[e.length-1]=e[e.length-1]+1&4294967295}function Jn(e){return[e/4294967296|0,e&4294967295]}});var Wr=C((Od,Ea)=>{var X=$();Xn();ei();se();Ea.exports=X.aes=X.aes||{};X.aes.startEncrypting=function(e,t,r,n){var i=Gr({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i};X.aes.createEncryptionCipher=function(e,t){return Gr({key:e,output:null,decrypt:!1,mode:t})};X.aes.startDecrypting=function(e,t,r,n){var i=Gr({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i};X.aes.createDecryptionCipher=function(e,t){return Gr({key:e,output:null,decrypt:!0,mode:t})};X.aes.Algorithm=function(e,t){ti||wa();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(n,i){return ni(r._w,n,i,!1)},decrypt:function(n,i){return ni(r._w,n,i,!0)}}}),r._init=!1};X.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,r;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=X.util.createBuffer(t);else if(X.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){r=t,t=X.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(!X.util.isArray(t)){r=t,t=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)t.push(r.getInt32())}}if(!X.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var a=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(a)!==-1;this._w=Sa(t,e.decrypt&&!s),this._init=!0}};X.aes._expandKey=function(e,t){return ti||wa(),Sa(e,t)};X.aes._updateBlock=ni;Vt("AES-ECB",X.cipher.modes.ecb);Vt("AES-CBC",X.cipher.modes.cbc);Vt("AES-CFB",X.cipher.modes.cfb);Vt("AES-OFB",X.cipher.modes.ofb);Vt("AES-CTR",X.cipher.modes.ctr);Vt("AES-GCM",X.cipher.modes.gcm);function Vt(e,t){var r=function(){return new X.aes.Algorithm(e,t)};X.cipher.registerAlgorithm(e,r)}var ti=!1,zt=4,me,ri,ba,Rt,Ue;function wa(){ti=!0,ba=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;me=new Array(256),ri=new Array(256),Rt=new Array(4),Ue=new Array(4);for(var t=0;t<4;++t)Rt[t]=new Array(256),Ue[t]=new Array(256);for(var r=0,n=0,i,a,s,o,u,f,c,t=0;t<256;++t){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,me[r]=o,ri[o]=r,u=e[o],i=e[r],a=e[i],s=e[a],f=u<<24^o<<16^o<<8^(o^u),c=(i^a^s)<<24^(r^s)<<16^(r^a^s)<<8^(r^i^s);for(var h=0;h<4;++h)Rt[h][r]=f,Ue[h][o]=c,f=f<<24|f>>>8,c=c<<24|c>>>8;r===0?r=n=1:(r=i^e[e[e[i^s]]],n^=e[e[n]])}}function Sa(e,t){for(var r=e.slice(0),n,i=1,a=r.length,s=a+6+1,o=zt*s,u=a;u<o;++u)n=r[u-1],u%a==0?(n=me[n>>>16&255]<<24^me[n>>>8&255]<<16^me[n&255]<<8^me[n>>>24]^ba[i]<<24,i++):a>6&&u%a==4&&(n=me[n>>>24]<<24^me[n>>>16&255]<<16^me[n>>>8&255]<<8^me[n&255]),r[u]=r[u-a]^n;if(t){var f,c=Ue[0],h=Ue[1],l=Ue[2],y=Ue[3],p=r.slice(0);o=r.length;for(var u=0,g=o-zt;u<o;u+=zt,g-=zt)if(u===0||u===o-zt)p[u]=r[g],p[u+1]=r[g+3],p[u+2]=r[g+2],p[u+3]=r[g+1];else for(var v=0;v<zt;++v)f=r[g+v],p[u+(3&-v)]=c[me[f>>>24]]^h[me[f>>>16&255]]^l[me[f>>>8&255]]^y[me[f&255]];r=p}return r}function ni(e,t,r,n){var i=e.length/4-1,a,s,o,u,f;n?(a=Ue[0],s=Ue[1],o=Ue[2],u=Ue[3],f=ri):(a=Rt[0],s=Rt[1],o=Rt[2],u=Rt[3],f=me);var c,h,l,y,p,g,v;c=t[0]^e[0],h=t[n?3:1]^e[1],l=t[2]^e[2],y=t[n?1:3]^e[3];for(var b=3,E=1;E<i;++E)p=a[c>>>24]^s[h>>>16&255]^o[l>>>8&255]^u[y&255]^e[++b],g=a[h>>>24]^s[l>>>16&255]^o[y>>>8&255]^u[c&255]^e[++b],v=a[l>>>24]^s[y>>>16&255]^o[c>>>8&255]^u[h&255]^e[++b],y=a[y>>>24]^s[c>>>16&255]^o[h>>>8&255]^u[l&255]^e[++b],c=p,h=g,l=v;r[0]=f[c>>>24]<<24^f[h>>>16&255]<<16^f[l>>>8&255]<<8^f[y&255]^e[++b],r[n?3:1]=f[h>>>24]<<24^f[l>>>16&255]<<16^f[y>>>8&255]<<8^f[c&255]^e[++b],r[2]=f[l>>>24]<<24^f[y>>>16&255]<<16^f[c>>>8&255]<<8^f[h&255]^e[++b],r[n?1:3]=f[y>>>24]<<24^f[c>>>16&255]<<16^f[h>>>8&255]<<8^f[l&255]^e[++b]}function Gr(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="AES-"+t,n;e.decrypt?n=X.cipher.createDecipher(r,e.key):n=X.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof X.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});function hu(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var a=e.charAt(i),s=a.charCodeAt(0);if(r[s]!==255)throw new TypeError(a+" is ambiguous");r[s]=i}var o=e.length,u=e.charAt(0),f=Math.log(o)/Math.log(256),c=Math.log(256)/Math.log(o);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,v=0,b=0,E=p.length;b!==E&&p[b]===0;)b++,g++;for(var A=(E-b)*c+1>>>0,N=new Uint8Array(A);b!==E;){for(var _=p[b],R=0,O=A-1;(_!==0||R<v)&&O!==-1;O--,R++)_+=256*N[O]>>>0,N[O]=_%o>>>0,_=_/o>>>0;if(_!==0)throw new Error("Non-zero carry");v=R,b++}for(var G=A-v;G!==A&&N[G]===0;)G++;for(var de=u.repeat(g);G<A;++G)de+=e.charAt(N[G]);return de}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var v=0,b=0;p[g]===u;)v++,g++;for(var E=(p.length-g)*f+1>>>0,A=new Uint8Array(E);p[g];){var N=r[p.charCodeAt(g)];if(N===255)return;for(var _=0,R=E-1;(N!==0||_<b)&&R!==-1;R--,_++)N+=o*A[R]>>>0,A[R]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");b=_,g++}if(p[g]!==" "){for(var O=E-b;O!==E&&A[O]===0;)O++;for(var G=new Uint8Array(v+(E-O)),de=v;O!==E;)G[de++]=A[O++];return G}}}function y(p){var g=l(p);if(g)return g;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:l,decode:y}}var lu,pu,Ba,Aa=Q(()=>{lu=hu,pu=lu,Ba=pu});var Md,Ca,tt,Ta,Ia,ht=Q(()=>{Md=new Uint8Array(0),Ca=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},tt=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},Ta=e=>new TextEncoder().encode(e),Ia=e=>new TextDecoder().decode(e)});var Ra,Da,ka,Pa,Na,jr,lt,du,yu,ae,Me=Q(()=>{Aa();ht();Ra=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Da=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseDecode=n}decode(t){if(typeof t=="string")switch(t[0]){case this.prefix:return this.baseDecode(t.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(t){return Pa(this,t)}},ka=class{constructor(t){this.decoders=t}or(t){return Pa(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Pa=(e,t)=>new ka({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),Na=class{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Ra(t,r,n),this.decoder=new Da(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},jr=({name:e,prefix:t,encode:r,decode:n})=>new Na(e,t,r,n),lt=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:i}=Ba(r,t);return jr({prefix:e,name:t,encode:n,decode:a=>tt(i(a))})},du=(e,t,r,n)=>{let i={};for(let c=0;c<t.length;++c)i[t[c]]=c;let a=e.length;for(;e[a-1]==="=";)--a;let s=new Uint8Array(a*r/8|0),o=0,u=0,f=0;for(let c=0;c<a;++c){let h=i[e[c]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<r|h,o+=r,o>=8&&(o-=8,s[f++]=255&u>>o)}if(o>=r||255&u<<8-o)throw new SyntaxError("Unexpected end of data");return s},yu=(e,t,r)=>{let n=t[t.length-1]==="=",i=(1<<r)-1,a="",s=0,o=0;for(let u=0;u<e.length;++u)for(o=o<<8|e[u],s+=8;s>r;)s-=r,a+=t[i&o>>s];if(s&&(a+=t[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a},ae=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>jr({prefix:t,name:e,encode(i){return yu(i,n,r)},decode(i){return du(i,n,r,e)}})});var ii={};ve(ii,{identity:()=>gu});var gu,La=Q(()=>{Me();ht();gu=jr({prefix:"\0",name:"identity",encode:e=>Ia(e),decode:e=>Ta(e)})});var ai={};ve(ai,{base2:()=>xu});var xu,Ka=Q(()=>{Me();xu=ae({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var si={};ve(si,{base8:()=>vu});var vu,Ua=Q(()=>{Me();vu=ae({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var oi={};ve(oi,{base10:()=>mu});var mu,qa=Q(()=>{Me();mu=lt({prefix:"9",name:"base10",alphabet:"0123456789"})});var fi={};ve(fi,{base16:()=>bu,base16upper:()=>wu});var bu,wu,Oa=Q(()=>{Me();bu=ae({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),wu=ae({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var ui={};ve(ui,{base32:()=>Ht,base32hex:()=>Au,base32hexpad:()=>Tu,base32hexpadupper:()=>Iu,base32hexupper:()=>Cu,base32pad:()=>Eu,base32padupper:()=>Bu,base32upper:()=>Su,base32z:()=>_u});var Ht,Su,Eu,Bu,Au,Cu,Tu,Iu,_u,ci=Q(()=>{Me();Ht=ae({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Su=ae({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Eu=ae({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Bu=ae({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Au=ae({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Cu=ae({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Tu=ae({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Iu=ae({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),_u=ae({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var hi={};ve(hi,{base36:()=>Ru,base36upper:()=>Du});var Ru,Du,Fa=Q(()=>{Me();Ru=lt({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Du=lt({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var Yr={};ve(Yr,{base58btc:()=>Ve,base58flickr:()=>ku});var Ve,ku,$r=Q(()=>{Me();Ve=lt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ku=lt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var or={};ve(or,{base64:()=>Pu,base64pad:()=>Nu,base64url:()=>Lu,base64urlpad:()=>Ku});var Pu,Nu,Lu,Ku,Qr=Q(()=>{Me();Pu=ae({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Nu=ae({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Lu=ae({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ku=ae({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});function Va(e,t,r){t=t||[],r=r||0;for(var n=r;e>=Fu;)t[r++]=e&255|Ma,e/=128;for(;e&Ou;)t[r++]=e&255|Ma,e>>>=7;return t[r]=e|0,Va.bytes=r-n+1,t}function li(e,t){var r=0,t=t||0,n=0,i=t,a,s=e.length;do{if(i>=s)throw li.bytes=0,new RangeError("Could not decode varint");a=e[i++],r+=n<28?(a&za)<<n:(a&za)*Math.pow(2,n),n+=7}while(a>=Vu);return li.bytes=i-t,r}var Uu,Ma,qu,Ou,Fu,Mu,Vu,za,zu,Hu,Gu,Wu,ju,Yu,$u,Qu,Zu,Xu,Ju,ec,fr,Ha=Q(()=>{Uu=Va,Ma=128,qu=127,Ou=~qu,Fu=Math.pow(2,31);Mu=li,Vu=128,za=127;zu=Math.pow(2,7),Hu=Math.pow(2,14),Gu=Math.pow(2,21),Wu=Math.pow(2,28),ju=Math.pow(2,35),Yu=Math.pow(2,42),$u=Math.pow(2,49),Qu=Math.pow(2,56),Zu=Math.pow(2,63),Xu=function(e){return e<zu?1:e<Hu?2:e<Gu?3:e<Wu?4:e<ju?5:e<Yu?6:e<$u?7:e<Qu?8:e<Zu?9:10},Ju={encode:Uu,decode:Mu,encodingLength:Xu},ec=Ju,fr=ec});var ur,Gt,Wt,Zr=Q(()=>{Ha();ur=e=>[fr.decode(e),fr.decode.bytes],Gt=(e,t,r=0)=>(fr.encode(e,t,r),t),Wt=e=>fr.encodingLength(e)});var Xr,Wa,ja,cr,Jr=Q(()=>{ht();Zr();Xr=(e,t)=>{let r=t.byteLength,n=Wt(e),i=n+Wt(r),a=new Uint8Array(i+r);return Gt(e,a,0),Gt(r,a,n),a.set(t,i),new cr(e,r,t,a)},Wa=e=>{let t=tt(e),[r,n]=ur(t),[i,a]=ur(t.subarray(n)),s=t.subarray(n+a);if(s.byteLength!==i)throw new Error("Incorrect length");return new cr(r,i,s,t)},ja=(e,t)=>e===t?!0:e.code===t.code&&e.size===t.size&&Ca(e.bytes,t.bytes),cr=class{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}}});var hr,$a,en=Q(()=>{Jr();hr=({name:e,code:t,encode:r})=>new $a(e,t,r),$a=class{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}async digest(t){if(t instanceof Uint8Array){let r=await this.encode(t);return Xr(this.code,r)}else throw Error("Unknown type, must be binary type")}}});var Dt={};ve(Dt,{sha256:()=>tc,sha512:()=>rc});var Za,tc,rc,jt=Q(()=>{en();Za=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),tc=hr({name:"sha2-256",code:18,encode:Za("SHA-256")}),rc=hr({name:"sha2-512",code:19,encode:Za("SHA-512")})});var tn={};ve(tn,{identity:()=>nc});var nc,pi=Q(()=>{en();ht();nc=hr({name:"identity",code:0,encode:e=>tt(e)})});var Xa=Q(()=>{ht()});var c1,h1,Ja=Q(()=>{c1=new TextEncoder,h1=new TextDecoder});var he,sc,oc,fc,lr,uc,es,ts,rn,nn,cc,hc,lc,rs=Q(()=>{Zr();Jr();$r();ci();ht();he=class{constructor(t,r,n,i){this.code=r,this.version=t,this.multihash=n,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:nn,byteLength:nn,code:rn,version:rn,multihash:rn,bytes:rn,_baseCache:nn,asCID:nn})}toV0(){switch(this.version){case 0:return this;default:{let{code:t,multihash:r}=this;if(t!==lr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==uc)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return he.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=Xr(t,r);return he.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(t){return t&&this.code===t.code&&this.version===t.version&&ja(this.multihash,t.multihash)}toString(t){let{bytes:r,version:n,_baseCache:i}=this;switch(n){case 0:return oc(r,i,t||Ve.encoder);default:return fc(r,i,t||Ht.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(t){return hc(/^0\.0/,lc),!!(t&&(t[ts]||t.asCID===t))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(t){if(t instanceof he)return t;if(t!=null&&t.asCID===t){let{version:r,code:n,multihash:i,bytes:a}=t;return new he(r,n,i,a||es(r,n,i.bytes))}else if(t!=null&&t[ts]===!0){let{version:r,multihash:n,code:i}=t,a=Wa(n);return he.create(r,i,a)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(t){case 0:{if(r!==lr)throw new Error(`Version 0 CID must use dag-pb (code: ${lr}) block encoding`);return new he(t,r,n,n.bytes)}case 1:{let i=es(t,r,n.bytes);return new he(t,r,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return he.create(0,lr,t)}static createV1(t,r){return he.create(1,t,r)}static decode(t){let[r,n]=he.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=he.inspectBytes(t),n=r.size-r.multihashSize,i=tt(t.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let a=i.subarray(r.multihashSize-r.digestSize),s=new cr(r.multihashCode,r.digestSize,a,i);return[r.version===0?he.createV0(s):he.createV1(r.codec,s),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[h,l]=ur(t.subarray(r));return r+=l,h},i=n(),a=lr;if(i===18?(i=0,r=0):i===1&&(a=n()),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,o=n(),u=n(),f=r+u,c=f-s;return{version:i,codec:a,multihashCode:o,digestSize:u,multihashSize:c,size:f}}static parse(t,r){let[n,i]=sc(t,r),a=he.decode(i);return a._baseCache.set(n,t),a}},sc=(e,t)=>{switch(e[0]){case"Q":{let r=t||Ve;return[Ve.prefix,r.decode(`${Ve.prefix}${e}`)]}case Ve.prefix:{let r=t||Ve;return[Ve.prefix,r.decode(e)]}case Ht.prefix:{let r=t||Ht;return[Ht.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},oc=(e,t,r)=>{let{prefix:n}=r;if(n!==Ve.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=t.get(n);if(i==null){let a=r.encode(e).slice(1);return t.set(n,a),a}else return i},fc=(e,t,r)=>{let{prefix:n}=r,i=t.get(n);if(i==null){let a=r.encode(e);return t.set(n,a),a}else return i},lr=112,uc=18,es=(e,t,r)=>{let n=Wt(e),i=n+Wt(t),a=new Uint8Array(i+r.byteLength);return Gt(e,a,0),Gt(t,a,n),a.set(r,i),a},ts=Symbol.for("@ipld/js-cid/CID"),rn={writable:!1,configurable:!1,enumerable:!0},nn={writable:!1,enumerable:!1,configurable:!1},cc="0.0.0-dev",hc=(e,t)=>{if(e.test(cc))console.warn(t);else throw new Error(t)},lc=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var ns=Q(()=>{rs();Zr();ht();en();Jr()});var di,w1,is=Q(()=>{La();Ka();Ua();qa();Oa();ci();Fa();$r();Qr();jt();pi();Xa();Ja();ns();di={...ii,...ai,...si,...oi,...fi,...ui,...hi,...Yr,...or},w1={...Dt,...tn}});function as(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var ss,yi,pc,an,gi=Q(()=>{is();ss=as("utf8","u",e=>{let t=new TextDecoder("utf8");return"u"+t.decode(e)},e=>new TextEncoder().encode(e.substring(1))),yi=as("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),pc={utf8:ss,"utf-8":ss,hex:di.base16,latin1:yi,ascii:yi,binary:yi,...di},an=pc});var pt={};ve(pt,{toString:()=>dc});function dc(e,t="utf8"){let r=an[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return r.encoder.encode(e).substring(1)}var dt=Q(()=>{gi()});var yt={};ve(yt,{fromString:()=>yc});function yc(e,t="utf8"){let r=an[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return r.decoder.decode(`${r.prefix}${e}`)}var gt=Q(()=>{gi()});var us=C((T1,fs)=>{"use strict";Wr();var sn=$(),{toString:Yt}=(dt(),pt),{fromString:os}=(gt(),yt);fs.exports={createCipheriv:(e,t,r)=>{let n=sn.cipher.createCipher("AES-CTR",Yt(t,"ascii"));return n.start({iv:Yt(r,"ascii")}),{update:i=>(n.update(sn.util.createBuffer(Yt(i,"ascii"))),os(n.output.getBytes(),"ascii"))}},createDecipheriv:(e,t,r)=>{let n=sn.cipher.createDecipher("AES-CTR",Yt(t,"ascii"));return n.start({iv:Yt(r,"ascii")}),{update:i=>(n.update(sn.util.createBuffer(Yt(i,"ascii"))),os(n.output.getBytes(),"ascii"))}}}});var Te=C((I1,hs)=>{"use strict";function cs(e,t){for(let r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}function gc(e,t,r){if(!e||typeof e=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof t=="object"&&(r=t,t=""),t&&(r.code=t);try{return cs(e,r)}catch(n){r.message=e.message,r.stack=e.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(e)),cs(new i,r)}}hs.exports=gc});var ds=C((_1,ps)=>{"use strict";var xc=Te(),ls={16:"aes-128-ctr",32:"aes-256-ctr"};ps.exports=function(e){let t=ls[e.length];if(!t){let r=Object.entries(ls).map(([n,i])=>`${n} (${i})`).join(" / ");throw xc(new Error(`Invalid key length ${e.length} bytes. Must be ${r}`),"ERR_INVALID_KEY_LENGTH")}return t}});var xs=C(gs=>{"use strict";var ys=us(),vc=ds();gs.create=async function(e,t){let r=vc(e),n=ys.createCipheriv(r,e,t),i=ys.createDecipheriv(r,e,t);return{async encrypt(s){return n.update(s)},async decrypt(s){return i.update(s)}}}});var ms=C((D1,vs)=>{"use strict";vs.exports=mc;function mc(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,a=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(o,u){r[n]=function(c){if(a)if(a=!1,c)u(c);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];o.apply(null,h)}};try{e.apply(t||null,r)}catch(f){a&&(a=!1,u(f))}})}});var Es=C(Ss=>{"use strict";var on=Ss;on.length=function(t){var r=t.length;if(!r)return 0;for(var n=0;--r%4>1&&t.charAt(r)==="=";)++n;return Math.ceil(t.length*3)/4-n};var $t=new Array(64),bs=new Array(123);for(qe=0;qe<64;)bs[$t[qe]=qe<26?qe+65:qe<52?qe+71:qe<62?qe-4:qe-59|43]=qe++;var qe;on.encode=function(t,r,n){for(var i=null,a=[],s=0,o=0,u;r<n;){var f=t[r++];switch(o){case 0:a[s++]=$t[f>>2],u=(f&3)<<4,o=1;break;case 1:a[s++]=$t[u|f>>4],u=(f&15)<<2,o=2;break;case 2:a[s++]=$t[u|f>>6],a[s++]=$t[f&63],o=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),s=0)}return o&&(a[s++]=$t[u],a[s++]=61,o===1&&(a[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,a.slice(0,s))),i.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var ws="invalid encoding";on.decode=function(t,r,n){for(var i=n,a=0,s,o=0;o<t.length;){var u=t.charCodeAt(o++);if(u===61&&a>1)break;if((u=bs[u])===void 0)throw Error(ws);switch(a){case 0:s=u,a=1;break;case 1:r[n++]=s<<2|(u&48)>>4,s=u,a=2;break;case 2:r[n++]=(s&15)<<4|(u&60)>>2,s=u,a=3;break;case 3:r[n++]=(s&3)<<6|u,a=0;break}}if(a===1)throw Error(ws);return n-i};on.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}});var As=C((P1,Bs)=>{"use strict";Bs.exports=fn;function fn(){this._listeners={}}fn.prototype.on=function(t,r,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:r,ctx:n||this}),this};fn.prototype.off=function(t,r){if(t===void 0)this._listeners={};else if(r===void 0)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};fn.prototype.emit=function(t){var r=this._listeners[t];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var ks=C((N1,Ds)=>{"use strict";Ds.exports=Cs(Cs);function Cs(e){return typeof Float32Array!="undefined"?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=r[3]===128;function i(u,f,c){t[0]=u,f[c]=r[0],f[c+1]=r[1],f[c+2]=r[2],f[c+3]=r[3]}function a(u,f,c){t[0]=u,f[c]=r[3],f[c+1]=r[2],f[c+2]=r[1],f[c+3]=r[0]}e.writeFloatLE=n?i:a,e.writeFloatBE=n?a:i;function s(u,f){return r[0]=u[f],r[1]=u[f+1],r[2]=u[f+2],r[3]=u[f+3],t[0]}function o(u,f){return r[3]=u[f],r[2]=u[f+1],r[1]=u[f+2],r[0]=u[f+3],t[0]}e.readFloatLE=n?s:o,e.readFloatBE=n?o:s}():function(){function t(n,i,a,s){var o=i<0?1:0;if(o&&(i=-i),i===0)n(1/i>0?0:2147483648,a,s);else if(isNaN(i))n(2143289344,a,s);else if(i>34028234663852886e22)n((o<<31|2139095040)>>>0,a,s);else if(i<11754943508222875e-54)n((o<<31|Math.round(i/1401298464324817e-60))>>>0,a,s);else{var u=Math.floor(Math.log(i)/Math.LN2),f=Math.round(i*Math.pow(2,-u)*8388608)&8388607;n((o<<31|u+127<<23|f)>>>0,a,s)}}e.writeFloatLE=t.bind(null,Ts),e.writeFloatBE=t.bind(null,Is);function r(n,i,a){var s=n(i,a),o=(s>>31)*2+1,u=s>>>23&255,f=s&8388607;return u===255?f?NaN:o*(1/0):u===0?o*1401298464324817e-60*f:o*Math.pow(2,u-150)*(f+8388608)}e.readFloatLE=r.bind(null,_s),e.readFloatBE=r.bind(null,Rs)}(),typeof Float64Array!="undefined"?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=r[7]===128;function i(u,f,c){t[0]=u,f[c]=r[0],f[c+1]=r[1],f[c+2]=r[2],f[c+3]=r[3],f[c+4]=r[4],f[c+5]=r[5],f[c+6]=r[6],f[c+7]=r[7]}function a(u,f,c){t[0]=u,f[c]=r[7],f[c+1]=r[6],f[c+2]=r[5],f[c+3]=r[4],f[c+4]=r[3],f[c+5]=r[2],f[c+6]=r[1],f[c+7]=r[0]}e.writeDoubleLE=n?i:a,e.writeDoubleBE=n?a:i;function s(u,f){return r[0]=u[f],r[1]=u[f+1],r[2]=u[f+2],r[3]=u[f+3],r[4]=u[f+4],r[5]=u[f+5],r[6]=u[f+6],r[7]=u[f+7],t[0]}function o(u,f){return r[7]=u[f],r[6]=u[f+1],r[5]=u[f+2],r[4]=u[f+3],r[3]=u[f+4],r[2]=u[f+5],r[1]=u[f+6],r[0]=u[f+7],t[0]}e.readDoubleLE=n?s:o,e.readDoubleBE=n?o:s}():function(){function t(n,i,a,s,o,u){var f=s<0?1:0;if(f&&(s=-s),s===0)n(0,o,u+i),n(1/s>0?0:2147483648,o,u+a);else if(isNaN(s))n(0,o,u+i),n(2146959360,o,u+a);else if(s>17976931348623157e292)n(0,o,u+i),n((f<<31|2146435072)>>>0,o,u+a);else{var c;if(s<22250738585072014e-324)c=s/5e-324,n(c>>>0,o,u+i),n((f<<31|c/4294967296)>>>0,o,u+a);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),c=s*Math.pow(2,-h),n(c*4503599627370496>>>0,o,u+i),n((f<<31|h+1023<<20|c*1048576&1048575)>>>0,o,u+a)}}}e.writeDoubleLE=t.bind(null,Ts,0,4),e.writeDoubleBE=t.bind(null,Is,4,0);function r(n,i,a,s,o){var u=n(s,o+i),f=n(s,o+a),c=(f>>31)*2+1,h=f>>>20&2047,l=4294967296*(f&1048575)+u;return h===2047?l?NaN:c*(1/0):h===0?c*5e-324*l:c*Math.pow(2,h-1075)*(l+4503599627370496)}e.readDoubleLE=r.bind(null,_s,0,4),e.readDoubleBE=r.bind(null,Rs,4,0)}(),e}function Ts(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function Is(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=e&255}function _s(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function Rs(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}});var Ps=C((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}});var Ls=C(Ns=>{"use strict";var xi=Ns;xi.length=function(t){for(var r=0,n=0,i=0;i<t.length;++i)n=t.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)==55296&&(t.charCodeAt(i+1)&64512)==56320?(++i,r+=4):r+=3;return r};xi.read=function(t,r,n){var i=n-r;if(i<1)return"";for(var a=null,s=[],o=0,u;r<n;)u=t[r++],u<128?s[o++]=u:u>191&&u<224?s[o++]=(u&31)<<6|t[r++]&63:u>239&&u<365?(u=((u&7)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,s[o++]=55296+(u>>10),s[o++]=56320+(u&1023)):s[o++]=(u&15)<<12|(t[r++]&63)<<6|t[r++]&63,o>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,s)),o=0);return a?(o&&a.push(String.fromCharCode.apply(String,s.slice(0,o))),a.join("")):String.fromCharCode.apply(String,s.slice(0,o))};xi.write=function(t,r,n){for(var i=n,a,s,o=0;o<t.length;++o)a=t.charCodeAt(o),a<128?r[n++]=a:a<2048?(r[n++]=a>>6|192,r[n++]=a&63|128):(a&64512)==55296&&((s=t.charCodeAt(o+1))&64512)==56320?(a=65536+((a&1023)<<10)+(s&1023),++o,r[n++]=a>>18|240,r[n++]=a>>12&63|128,r[n++]=a>>6&63|128,r[n++]=a&63|128):(r[n++]=a>>12|224,r[n++]=a>>6&63|128,r[n++]=a&63|128);return n-i}});var Us=C((K1,Ks)=>{"use strict";Ks.exports=bc;function bc(e,t,r){var n=r||8192,i=n>>>1,a=null,s=n;return function(u){if(u<1||u>i)return e(u);s+u>n&&(a=e(n),s=0);var f=t.call(a,s,s+=u);return s&7&&(s=(s|7)+1),f}}});var Os=C((U1,qs)=>{"use strict";qs.exports=le;var pr=vt();function le(e,t){this.lo=e>>>0,this.hi=t>>>0}var kt=le.zero=new le(0,0);kt.toNumber=function(){return 0};kt.zzEncode=kt.zzDecode=function(){return this};kt.length=function(){return 1};var wc=le.zeroHash="\0\0\0\0\0\0\0\0";le.fromNumber=function(t){if(t===0)return kt;var r=t<0;r&&(t=-t);var n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new le(n,i)};le.from=function(t){if(typeof t=="number")return le.fromNumber(t);if(pr.isString(t))if(pr.Long)t=pr.Long.fromString(t);else return le.fromNumber(parseInt(t,10));return t.low||t.high?new le(t.low>>>0,t.high>>>0):kt};le.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};le.prototype.toLong=function(t){return pr.Long?new pr.Long(this.lo|0,this.hi|0,Boolean(t)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(t)}};var xt=String.prototype.charCodeAt;le.fromHash=function(t){return t===wc?kt:new le((xt.call(t,0)|xt.call(t,1)<<8|xt.call(t,2)<<16|xt.call(t,3)<<24)>>>0,(xt.call(t,4)|xt.call(t,5)<<8|xt.call(t,6)<<16|xt.call(t,7)<<24)>>>0)};le.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};le.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this};le.prototype.zzDecode=function(){var t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this};le.prototype.length=function(){var t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var vt=C(vi=>{"use strict";var k=vi;k.asPromise=ms();k.base64=Es();k.EventEmitter=As();k.float=ks();k.inquire=Ps();k.utf8=Ls();k.pool=Us();k.LongBits=Os();k.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);k.global=k.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||vi;k.emptyArray=Object.freeze?Object.freeze([]):[];k.emptyObject=Object.freeze?Object.freeze({}):{};k.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};k.isString=function(t){return typeof t=="string"||t instanceof String};k.isObject=function(t){return t&&typeof t=="object"};k.isset=k.isSet=function(t,r){var n=t[r];return n!=null&&t.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};k.Buffer=function(){try{var e=k.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(t){return null}}();k._Buffer_from=null;k._Buffer_allocUnsafe=null;k.newBuffer=function(t){return typeof t=="number"?k.Buffer?k._Buffer_allocUnsafe(t):new k.Array(t):k.Buffer?k._Buffer_from(t):typeof Uint8Array=="undefined"?t:new Uint8Array(t)};k.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;k.Long=k.global.dcodeIO&&k.global.dcodeIO.Long||k.global.Long||k.inquire("long");k.key2Re=/^true|false|0|1$/;k.key32Re=/^-?(?:0|[1-9][0-9]*)$/;k.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;k.longToHash=function(t){return t?k.LongBits.from(t).toHash():k.LongBits.zeroHash};k.longFromHash=function(t,r){var n=k.LongBits.fromHash(t);return k.Long?k.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function Fs(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)(e[n[i]]===void 0||!r)&&(e[n[i]]=t[n[i]]);return e}k.merge=Fs;k.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)};function Ms(e){function t(r,n){if(!(this instanceof t))return new t(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Fs(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}k.newError=Ms;k.ProtocolError=Ms("ProtocolError");k.oneOfGetter=function(t){for(var r={},n=0;n<t.length;++n)r[t[n]]=1;return function(){for(var i=Object.keys(this),a=i.length-1;a>-1;--a)if(r[i[a]]===1&&this[i[a]]!==void 0&&this[i[a]]!==null)return i[a]}};k.oneOfSetter=function(t){return function(r){for(var n=0;n<t.length;++n)t[n]!==r&&delete this[t[n]]}};k.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};k._configure=function(){var e=k.Buffer;if(!e){k._Buffer_from=k._Buffer_allocUnsafe=null;return}k._Buffer_from=e.from!==Uint8Array.from&&e.from||function(r,n){return new e(r,n)},k._Buffer_allocUnsafe=e.allocUnsafe||function(r){return new e(r)}}});var Ai=C((O1,Gs)=>{"use strict";Gs.exports=M;var Ie=vt(),mi,un=Ie.LongBits,Vs=Ie.base64,zs=Ie.utf8;function dr(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function bi(){}function Sc(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function M(){this.len=0,this.head=new dr(bi,0,0),this.tail=this.head,this.states=null}var Hs=function(){return Ie.Buffer?function(){return(M.create=function(){return new mi})()}:function(){return new M}};M.create=Hs();M.alloc=function(t){return new Ie.Array(t)};Ie.Array!==Array&&(M.alloc=Ie.pool(M.alloc,Ie.Array.prototype.subarray));M.prototype._push=function(t,r,n){return this.tail=this.tail.next=new dr(t,r,n),this.len+=r,this};function wi(e,t,r){t[r]=e&255}function Ec(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}function Si(e,t){this.len=e,this.next=void 0,this.val=t}Si.prototype=Object.create(dr.prototype);Si.prototype.fn=Ec;M.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new Si((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};M.prototype.int32=function(t){return t<0?this._push(Ei,10,un.fromNumber(t)):this.uint32(t)};M.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)};function Ei(e,t,r){for(;e.hi;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}M.prototype.uint64=function(t){var r=un.from(t);return this._push(Ei,r.length(),r)};M.prototype.int64=M.prototype.uint64;M.prototype.sint64=function(t){var r=un.from(t).zzEncode();return this._push(Ei,r.length(),r)};M.prototype.bool=function(t){return this._push(wi,1,t?1:0)};function Bi(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}M.prototype.fixed32=function(t){return this._push(Bi,4,t>>>0)};M.prototype.sfixed32=M.prototype.fixed32;M.prototype.fixed64=function(t){var r=un.from(t);return this._push(Bi,4,r.lo)._push(Bi,4,r.hi)};M.prototype.sfixed64=M.prototype.fixed64;M.prototype.float=function(t){return this._push(Ie.float.writeFloatLE,4,t)};M.prototype.double=function(t){return this._push(Ie.float.writeDoubleLE,8,t)};var Bc=Ie.Array.prototype.set?function(t,r,n){r.set(t,n)}:function(t,r,n){for(var i=0;i<t.length;++i)r[n+i]=t[i]};M.prototype.bytes=function(t){var r=t.length>>>0;if(!r)return this._push(wi,1,0);if(Ie.isString(t)){var n=M.alloc(r=Vs.length(t));Vs.decode(t,n,0),t=n}return this.uint32(r)._push(Bc,r,t)};M.prototype.string=function(t){var r=zs.length(t);return r?this.uint32(r)._push(zs.write,r,t):this._push(wi,1,0)};M.prototype.fork=function(){return this.states=new Sc(this),this.head=this.tail=new dr(bi,0,0),this.len=0,this};M.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new dr(bi,0,0),this.len=0),this};M.prototype.ldelim=function(){var t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=r,this.len+=n),this};M.prototype.finish=function(){for(var t=this.head.next,r=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r};M._configure=function(e){mi=e,M.create=Hs(),mi._configure()}});var Ys=C((F1,js)=>{"use strict";js.exports=ze;var Ws=Ai();(ze.prototype=Object.create(Ws.prototype)).constructor=ze;var mt=vt();function ze(){Ws.call(this)}ze._configure=function(){ze.alloc=mt._Buffer_allocUnsafe,ze.writeBytesBuffer=mt.Buffer&&mt.Buffer.prototype instanceof Uint8Array&&mt.Buffer.prototype.set.name==="set"?function(t,r,n){r.set(t,n)}:function(t,r,n){if(t.copy)t.copy(r,n,0,t.length);else for(var i=0;i<t.length;)r[n++]=t[i++]}};ze.prototype.bytes=function(t){mt.isString(t)&&(t=mt._Buffer_from(t,"base64"));var r=t.length>>>0;return this.uint32(r),r&&this._push(ze.writeBytesBuffer,r,t),this};function Ac(e,t,r){e.length<40?mt.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}ze.prototype.string=function(t){var r=mt.Buffer.byteLength(t);return this.uint32(r),r&&this._push(Ac,r,t),this};ze._configure()});var Ii=C((M1,Js)=>{"use strict";Js.exports=oe;var He=vt(),Ci,$s=He.LongBits,Cc=He.utf8;function Oe(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function oe(e){this.buf=e,this.pos=0,this.len=e.length}var Qs=typeof Uint8Array!="undefined"?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new oe(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new oe(t);throw Error("illegal buffer")},Zs=function(){return He.Buffer?function(r){return(oe.create=function(i){return He.Buffer.isBuffer(i)?new Ci(i):Qs(i)})(r)}:Qs};oe.create=Zs();oe.prototype._slice=He.Array.prototype.subarray||He.Array.prototype.slice;oe.prototype.uint32=function(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,Oe(this,10);return t}}();oe.prototype.int32=function(){return this.uint32()|0};oe.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(t&1)|0};function Ti(){var e=new $s(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw Oe(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw Oe(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}oe.prototype.bool=function(){return this.uint32()!==0};function cn(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}oe.prototype.fixed32=function(){if(this.pos+4>this.len)throw Oe(this,4);return cn(this.buf,this.pos+=4)};oe.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Oe(this,4);return cn(this.buf,this.pos+=4)|0};function Xs(){if(this.pos+8>this.len)throw Oe(this,8);return new $s(cn(this.buf,this.pos+=4),cn(this.buf,this.pos+=4))}oe.prototype.float=function(){if(this.pos+4>this.len)throw Oe(this,4);var t=He.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};oe.prototype.double=function(){if(this.pos+8>this.len)throw Oe(this,4);var t=He.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};oe.prototype.bytes=function(){var t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw Oe(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};oe.prototype.string=function(){var t=this.bytes();return Cc.read(t,0,t.length)};oe.prototype.skip=function(t){if(typeof t=="number"){if(this.pos+t>this.len)throw Oe(this,t);this.pos+=t}else do if(this.pos>=this.len)throw Oe(this);while(this.buf[this.pos++]&128);return this};oe.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!=4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};oe._configure=function(e){Ci=e,oe.create=Zs(),Ci._configure();var t=He.Long?"toLong":"toNumber";He.merge(oe.prototype,{int64:function(){return Ti.call(this)[t](!1)},uint64:function(){return Ti.call(this)[t](!0)},sint64:function(){return Ti.call(this).zzDecode()[t](!1)},fixed64:function(){return Xs.call(this)[t](!0)},sfixed64:function(){return Xs.call(this)[t](!1)}})}});var n0=C((V1,r0)=>{"use strict";r0.exports=Pt;var e0=Ii();(Pt.prototype=Object.create(e0.prototype)).constructor=Pt;var t0=vt();function Pt(e){e0.call(this,e)}Pt._configure=function(){t0.Buffer&&(Pt.prototype._slice=t0.Buffer.prototype.slice)};Pt.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};Pt._configure()});var a0=C((z1,i0)=>{"use strict";i0.exports=yr;var _i=vt();(yr.prototype=Object.create(_i.EventEmitter.prototype)).constructor=yr;function yr(e,t,r){if(typeof e!="function")throw TypeError("rpcImpl must be a function");_i.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}yr.prototype.rpcCall=function e(t,r,n,i,a){if(!i)throw TypeError("request must be specified");var s=this;if(!a)return _i.asPromise(e,s,t,r,n,i);if(!s.rpcImpl){setTimeout(function(){a(Error("already ended"))},0);return}try{return s.rpcImpl(t,r[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(u,f){if(u)return s.emit("error",u,t),a(u);if(f===null){s.end(!0);return}if(!(f instanceof n))try{f=n[s.responseDelimited?"decodeDelimited":"decode"](f)}catch(c){return s.emit("error",c,t),a(c)}return s.emit("data",f,t),a(null,f)})}catch(o){s.emit("error",o,t),setTimeout(function(){a(o)},0);return}};yr.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var o0=C(s0=>{"use strict";var Tc=s0;Tc.Service=a0()});var u0=C((G1,f0)=>{"use strict";f0.exports={}});var l0=C(h0=>{"use strict";var Ee=h0;Ee.build="minimal";Ee.Writer=Ai();Ee.BufferWriter=Ys();Ee.Reader=Ii();Ee.BufferReader=n0();Ee.util=vt();Ee.rpc=o0();Ee.roots=u0();Ee.configure=c0;function c0(){Ee.util._configure(),Ee.Writer._configure(Ee.BufferWriter),Ee.Reader._configure(Ee.BufferReader)}c0()});var d0=C((j1,p0)=>{"use strict";p0.exports=l0()});var ln=C((Y1,g0)=>{"use strict";var Nt=d0(),hn=Nt.Reader,y0=Nt.Writer,ye=Nt.util,_e=Nt.roots["libp2p-crypto-keys"]||(Nt.roots["libp2p-crypto-keys"]={});_e.KeyType=function(){var e={},t=Object.create(e);return t[e[0]="RSA"]=0,t[e[1]="Ed25519"]=1,t[e[2]="Secp256k1"]=2,t}();_e.PublicKey=function(){function e(t){if(t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.Type=0,e.prototype.Data=ye.newBuffer([]),e.encode=function(r,n){return n||(n=y0.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},e.decode=function(r,n){r instanceof hn||(r=hn.create(r));for(var i=n===void 0?r.len:r.pos+n,a=new _e.PublicKey;r.pos<i;){var s=r.uint32();switch(s>>>3){case 1:a.Type=r.int32();break;case 2:a.Data=r.bytes();break;default:r.skipType(s&7);break}}if(!a.hasOwnProperty("Type"))throw ye.ProtocolError("missing required 'Type'",{instance:a});if(!a.hasOwnProperty("Data"))throw ye.ProtocolError("missing required 'Data'",{instance:a});return a},e.fromObject=function(r){if(r instanceof _e.PublicKey)return r;var n=new _e.PublicKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?ye.base64.decode(r.Data,n.Data=ye.newBuffer(ye.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},e.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=ye.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?_e.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?ye.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Nt.util.toJSONOptions)},e}();_e.PrivateKey=function(){function e(t){if(t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.Type=0,e.prototype.Data=ye.newBuffer([]),e.encode=function(r,n){return n||(n=y0.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},e.decode=function(r,n){r instanceof hn||(r=hn.create(r));for(var i=n===void 0?r.len:r.pos+n,a=new _e.PrivateKey;r.pos<i;){var s=r.uint32();switch(s>>>3){case 1:a.Type=r.int32();break;case 2:a.Data=r.bytes();break;default:r.skipType(s&7);break}}if(!a.hasOwnProperty("Type"))throw ye.ProtocolError("missing required 'Type'",{instance:a});if(!a.hasOwnProperty("Data"))throw ye.ProtocolError("missing required 'Data'",{instance:a});return a},e.fromObject=function(r){if(r instanceof _e.PrivateKey)return r;var n=new _e.PrivateKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?ye.base64.decode(r.Data,n.Data=ye.newBuffer(ye.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},e.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=ye.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?_e.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?ye.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Nt.util.toJSONOptions)},e}();g0.exports=_e});var pn=C(($1,x0)=>{var gr=$();gr.pki=gr.pki||{};var Ri=x0.exports=gr.pki.oids=gr.oids=gr.oids||{};function B(e,t){Ri[e]=t,Ri[t]=e}function W(e,t){Ri[e]=t}B("1.2.840.113549.1.1.1","rsaEncryption");B("1.2.840.113549.1.1.4","md5WithRSAEncryption");B("1.2.840.113549.1.1.5","sha1WithRSAEncryption");B("1.2.840.113549.1.1.7","RSAES-OAEP");B("1.2.840.113549.1.1.8","mgf1");B("1.2.840.113549.1.1.9","pSpecified");B("1.2.840.113549.1.1.10","RSASSA-PSS");B("1.2.840.113549.1.1.11","sha256WithRSAEncryption");B("1.2.840.113549.1.1.12","sha384WithRSAEncryption");B("1.2.840.113549.1.1.13","sha512WithRSAEncryption");B("1.3.101.112","EdDSA25519");B("1.2.840.10040.4.3","dsa-with-sha1");B("1.3.14.3.2.7","desCBC");B("1.3.14.3.2.26","sha1");B("2.16.840.1.101.3.4.2.1","sha256");B("2.16.840.1.101.3.4.2.2","sha384");B("2.16.840.1.101.3.4.2.3","sha512");B("1.2.840.113549.2.5","md5");B("1.2.840.113549.1.7.1","data");B("1.2.840.113549.1.7.2","signedData");B("1.2.840.113549.1.7.3","envelopedData");B("1.2.840.113549.1.7.4","signedAndEnvelopedData");B("1.2.840.113549.1.7.5","digestedData");B("1.2.840.113549.1.7.6","encryptedData");B("1.2.840.113549.1.9.1","emailAddress");B("1.2.840.113549.1.9.2","unstructuredName");B("1.2.840.113549.1.9.3","contentType");B("1.2.840.113549.1.9.4","messageDigest");B("1.2.840.113549.1.9.5","signingTime");B("1.2.840.113549.1.9.6","counterSignature");B("1.2.840.113549.1.9.7","challengePassword");B("1.2.840.113549.1.9.8","unstructuredAddress");B("1.2.840.113549.1.9.14","extensionRequest");B("1.2.840.113549.1.9.20","friendlyName");B("1.2.840.113549.1.9.21","localKeyId");B("1.2.840.113549.1.9.22.1","x509Certificate");B("1.2.840.113549.1.12.10.1.1","keyBag");B("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");B("1.2.840.113549.1.12.10.1.3","certBag");B("1.2.840.113549.1.12.10.1.4","crlBag");B("1.2.840.113549.1.12.10.1.5","secretBag");B("1.2.840.113549.1.12.10.1.6","safeContentsBag");B("1.2.840.113549.1.5.13","pkcs5PBES2");B("1.2.840.113549.1.5.12","pkcs5PBKDF2");B("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");B("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");B("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");B("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");B("1.2.840.113549.2.7","hmacWithSHA1");B("1.2.840.113549.2.8","hmacWithSHA224");B("1.2.840.113549.2.9","hmacWithSHA256");B("1.2.840.113549.2.10","hmacWithSHA384");B("1.2.840.113549.2.11","hmacWithSHA512");B("1.2.840.113549.3.7","des-EDE3-CBC");B("2.16.840.1.101.3.4.1.2","aes128-CBC");B("2.16.840.1.101.3.4.1.22","aes192-CBC");B("2.16.840.1.101.3.4.1.42","aes256-CBC");B("2.5.4.3","commonName");B("2.5.4.5","serialName");B("2.5.4.6","countryName");B("2.5.4.7","localityName");B("2.5.4.8","stateOrProvinceName");B("2.5.4.9","streetAddress");B("2.5.4.10","organizationName");B("2.5.4.11","organizationalUnitName");B("2.5.4.13","description");B("2.5.4.15","businessCategory");B("2.5.4.17","postalCode");B("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");B("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");B("2.16.840.1.113730.1.1","nsCertType");B("2.16.840.1.113730.1.13","nsComment");W("2.5.29.1","authorityKeyIdentifier");W("2.5.29.2","keyAttributes");W("2.5.29.3","certificatePolicies");W("2.5.29.4","keyUsageRestriction");W("2.5.29.5","policyMapping");W("2.5.29.6","subtreesConstraint");W("2.5.29.7","subjectAltName");W("2.5.29.8","issuerAltName");W("2.5.29.9","subjectDirectoryAttributes");W("2.5.29.10","basicConstraints");W("2.5.29.11","nameConstraints");W("2.5.29.12","policyConstraints");W("2.5.29.13","basicConstraints");B("2.5.29.14","subjectKeyIdentifier");B("2.5.29.15","keyUsage");W("2.5.29.16","privateKeyUsagePeriod");B("2.5.29.17","subjectAltName");B("2.5.29.18","issuerAltName");B("2.5.29.19","basicConstraints");W("2.5.29.20","cRLNumber");W("2.5.29.21","cRLReason");W("2.5.29.22","expirationDate");W("2.5.29.23","instructionCode");W("2.5.29.24","invalidityDate");W("2.5.29.25","cRLDistributionPoints");W("2.5.29.26","issuingDistributionPoint");W("2.5.29.27","deltaCRLIndicator");W("2.5.29.28","issuingDistributionPoint");W("2.5.29.29","certificateIssuer");W("2.5.29.30","nameConstraints");B("2.5.29.31","cRLDistributionPoints");B("2.5.29.32","certificatePolicies");W("2.5.29.33","policyMappings");W("2.5.29.34","policyConstraints");B("2.5.29.35","authorityKeyIdentifier");W("2.5.29.36","policyConstraints");B("2.5.29.37","extKeyUsage");W("2.5.29.46","freshestCRL");W("2.5.29.54","inhibitAnyPolicy");B("1.3.6.1.4.1.11129.2.4.2","timestampList");B("1.3.6.1.5.5.7.1.1","authorityInfoAccess");B("1.3.6.1.5.5.7.3.1","serverAuth");B("1.3.6.1.5.5.7.3.2","clientAuth");B("1.3.6.1.5.5.7.3.3","codeSigning");B("1.3.6.1.5.5.7.3.4","emailProtection");B("1.3.6.1.5.5.7.3.8","timeStamping")});var vr=C((Q1,m0)=>{var ee=$();se();pn();var T=m0.exports=ee.asn1=ee.asn1||{};T.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};T.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};T.create=function(e,t,r,n,i){if(ee.util.isArray(n)){for(var a=[],s=0;s<n.length;++s)n[s]!==void 0&&a.push(n[s]);n=a}var o={tagClass:e,type:t,constructed:r,composed:r||ee.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=T.copy(o)),o};T.copy=function(e,t){var r;if(ee.util.isArray(e)){r=[];for(var n=0;n<e.length;++n)r.push(T.copy(e[n],t));return r}return typeof e=="string"?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:T.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)};T.equals=function(e,t,r){if(ee.util.isArray(e)){if(!ee.util.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!T.equals(e[n],t[n]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var i=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&T.equals(e.value,t.value);return r&&r.includeBitStringContents&&(i=i&&e.bitStringContents===t.bitStringContents),i};T.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var r,n=t&128;return n?r=e.getInt((t&127)<<3):r=t,r}};function xr(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}var Ic=function(e,t){var r=e.getByte();if(t--,r!==128){var n,i=r&128;if(!i)n=r;else{var a=r&127;xr(e,t,a),n=e.getInt(a<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};T.fromDer=function(e,t){return t===void 0&&(t={strict:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=ee.util.createBuffer(e)),dn(e,e.length(),0,t)};function dn(e,t,r,n){var i;xr(e,t,2);var a=e.getByte();t--;var s=a&192,o=a&31;i=e.length();var u=Ic(e,t);if(t-=i-e.length(),u!==void 0&&u>t){if(n.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=e.length(),f.remaining=t,f.requested=u,f}u=t}var c,h,l=(a&32)==32;if(l)if(c=[],u===void 0)for(;;){if(xr(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}i=e.length(),c.push(dn(e,t,r+1,n)),t-=i-e.length()}else for(;u>0;)i=e.length(),c.push(dn(e,u,r+1,n)),t-=i-e.length(),u-=i-e.length();if(c===void 0&&s===T.Class.UNIVERSAL&&o===T.Type.BITSTRING&&(h=e.bytes(u)),c===void 0&&n.decodeBitStrings&&s===T.Class.UNIVERSAL&&o===T.Type.BITSTRING&&u>1){var y=e.read,p=t,g=0;if(o===T.Type.BITSTRING&&(xr(e,t,1),g=e.getByte(),t--),g===0)try{i=e.length();var v={verbose:n.verbose,strict:!0,decodeBitStrings:!0},b=dn(e,t,r+1,v),E=i-e.length();t-=E,o==T.Type.BITSTRING&&E++;var A=b.tagClass;E===u&&(A===T.Class.UNIVERSAL||A===T.Class.CONTEXT_SPECIFIC)&&(c=[b])}catch(_){}c===void 0&&(e.read=y,t=p)}if(c===void 0){if(u===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");u=t}if(o===T.Type.BMPSTRING)for(c="";u>0;u-=2)xr(e,t,2),c+=String.fromCharCode(e.getInt16()),t-=2;else c=e.getBytes(u)}var N=h===void 0?null:{bitStringContents:h};return T.create(s,o,l,c,N)}T.toDer=function(e){var t=ee.util.createBuffer(),r=e.tagClass|e.type,n=ee.util.createBuffer(),i=!1;if("bitStringContents"in e&&(i=!0,e.original&&(i=T.equals(e,e.original))),i)n.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:n.putByte(0);for(var a=0;a<e.value.length;++a)e.value[a]!==void 0&&n.putBuffer(T.toDer(e.value[a]))}else if(e.type===T.Type.BMPSTRING)for(var a=0;a<e.value.length;++a)n.putInt16(e.value.charCodeAt(a));else e.type===T.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&(e.value.charCodeAt(1)&128)==0||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)==128)?n.putBytes(e.value.substr(1)):n.putBytes(e.value);if(t.putByte(r),n.length()<=127)t.putByte(n.length()&127);else{var s=n.length(),o="";do o+=String.fromCharCode(s&255),s=s>>>8;while(s>0);t.putByte(o.length|128);for(var a=o.length-1;a>=0;--a)t.putByte(o.charCodeAt(a))}return t.putBuffer(n),t};T.oidToDer=function(e){var t=e.split("."),r=ee.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var n,i,a,s,o=2;o<t.length;++o){n=!0,i=[],a=parseInt(t[o],10);do s=a&127,a=a>>>7,n||(s|=128),i.push(s),n=!1;while(a>0);for(var u=i.length-1;u>=0;--u)r.putByte(i[u])}return r};T.derToOid=function(e){var t;typeof e=="string"&&(e=ee.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)r=e.getByte(),n=n<<7,r&128?n+=r&127:(t+="."+(n+r),n=0);return t};T.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),a=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=0;if(e.length>11){var u=e.charAt(10),f=10;u!=="+"&&u!=="-"&&(o=parseInt(e.substr(10,2),10),f+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(a,s,o,0),f&&(u=e.charAt(f),u==="+"||u==="-")){var c=parseInt(e.substr(f+1,2),10),h=parseInt(e.substr(f+4,2),10),l=c*60+h;l*=6e4,u==="+"?t.setTime(+t-l):t.setTime(+t+l)}return t};T.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),a=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),o=parseInt(e.substr(12,2),10),u=0,f=0,c=!1;e.charAt(e.length-1)==="Z"&&(c=!0);var h=e.length-5,l=e.charAt(h);if(l==="+"||l==="-"){var y=parseInt(e.substr(h+1,2),10),p=parseInt(e.substr(h+4,2),10);f=y*60+p,f*=6e4,l==="+"&&(f*=-1),c=!0}return e.charAt(14)==="."&&(u=parseFloat(e.substr(14),10)*1e3),c?(t.setUTCFullYear(r,n,i),t.setUTCHours(a,s,o,u),t.setTime(+t+f)):(t.setFullYear(r,n,i),t.setHours(a,s,o,u)),t};T.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};T.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};T.integerToDer=function(e){var t=ee.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r};T.derToInteger=function(e){typeof e=="string"&&(e=ee.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};T.validate=function(e,t,r,n){var i=!1;if((e.tagClass===t.tagClass||typeof t.tagClass=="undefined")&&(e.type===t.type||typeof t.type=="undefined"))if(e.constructed===t.constructed||typeof t.constructed=="undefined"){if(i=!0,t.value&&ee.util.isArray(t.value))for(var a=0,s=0;i&&s<t.value.length;++s)i=t.value[s].optional||!1,e.value[a]&&(i=T.validate(e.value[a],t.value[s],r,n),i?++a:t.value[s].optional&&(i=!0)),!i&&n&&n.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(i&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)){var o;if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{var u=e.bitStringContents.charCodeAt(0);if(u!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}else n&&n.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else n&&(e.tagClass!==t.tagClass&&n.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&n.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return i};var v0=/[^\\u0000-\\u00ff]/;T.prettyPrint=function(e,t,r){var n="";t=t||0,r=r||2,t>0&&(n+=`
`);for(var i="",a=0;a<t*r;++a)i+=" ";switch(n+=i+"Tag: ",e.tagClass){case T.Class.UNIVERSAL:n+="Universal:";break;case T.Class.APPLICATION:n+="Application:";break;case T.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case T.Class.PRIVATE:n+="Private:";break}if(e.tagClass===T.Class.UNIVERSAL)switch(n+=e.type,e.type){case T.Type.NONE:n+=" (None)";break;case T.Type.BOOLEAN:n+=" (Boolean)";break;case T.Type.INTEGER:n+=" (Integer)";break;case T.Type.BITSTRING:n+=" (Bit string)";break;case T.Type.OCTETSTRING:n+=" (Octet string)";break;case T.Type.NULL:n+=" (Null)";break;case T.Type.OID:n+=" (Object Identifier)";break;case T.Type.ODESC:n+=" (Object Descriptor)";break;case T.Type.EXTERNAL:n+=" (External or Instance of)";break;case T.Type.REAL:n+=" (Real)";break;case T.Type.ENUMERATED:n+=" (Enumerated)";break;case T.Type.EMBEDDED:n+=" (Embedded PDV)";break;case T.Type.UTF8:n+=" (UTF8)";break;case T.Type.ROID:n+=" (Relative Object Identifier)";break;case T.Type.SEQUENCE:n+=" (Sequence)";break;case T.Type.SET:n+=" (Set)";break;case T.Type.PRINTABLESTRING:n+=" (Printable String)";break;case T.Type.IA5String:n+=" (IA5String (ASCII))";break;case T.Type.UTCTIME:n+=" (UTC time)";break;case T.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case T.Type.BMPSTRING:n+=" (BMP String)";break}else n+=e.type;if(n+=`
`,n+=i+"Constructed: "+e.constructed+`
`,e.composed){for(var s=0,o="",a=0;a<e.value.length;++a)e.value[a]!==void 0&&(s+=1,o+=T.prettyPrint(e.value[a],t+1,r),a+1<e.value.length&&(o+=","));n+=i+"Sub values: "+s+o}else{if(n+=i+"Value: ",e.type===T.Type.OID){var u=T.derToOid(e.value);n+=u,ee.pki&&ee.pki.oids&&u in ee.pki.oids&&(n+=" ("+ee.pki.oids[u]+") ")}if(e.type===T.Type.INTEGER)try{n+=T.derToInteger(e.value)}catch(c){n+="0x"+ee.util.bytesToHex(e.value)}else if(e.type===T.Type.BITSTRING){if(e.value.length>1?n+="0x"+ee.util.bytesToHex(e.value.slice(1)):n+="(none)",e.value.length>0){var f=e.value.charCodeAt(0);f==1?n+=" (1 unused bit shown)":f>1&&(n+=" ("+f+" unused bits shown)")}}else e.type===T.Type.OCTETSTRING?(v0.test(e.value)||(n+="("+e.value+") "),n+="0x"+ee.util.bytesToHex(e.value)):e.type===T.Type.UTF8?n+=ee.util.decodeUtf8(e.value):e.type===T.Type.PRINTABLESTRING||e.type===T.Type.IA5String?n+=e.value:v0.test(e.value)?n+="0x"+ee.util.bytesToHex(e.value):e.value.length===0?n+="[null]":n+=e.value}return n}});var S0=C((Z1,w0)=>{var te=$();Xn();ei();se();w0.exports=te.des=te.des||{};te.des.startEncrypting=function(e,t,r,n){var i=yn({key:e,output:r,decrypt:!1,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};te.des.createEncryptionCipher=function(e,t){return yn({key:e,output:null,decrypt:!1,mode:t})};te.des.startDecrypting=function(e,t,r,n){var i=yn({key:e,output:r,decrypt:!0,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};te.des.createDecryptionCipher=function(e,t){return yn({key:e,output:null,decrypt:!0,mode:t})};te.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(n,i){return b0(r._keys,n,i,!1)},decrypt:function(n,i){return b0(r._keys,n,i,!0)}}}),r._init=!1};te.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=te.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=Uc(t),this._init=!0}};Ge("DES-ECB",te.cipher.modes.ecb);Ge("DES-CBC",te.cipher.modes.cbc);Ge("DES-CFB",te.cipher.modes.cfb);Ge("DES-OFB",te.cipher.modes.ofb);Ge("DES-CTR",te.cipher.modes.ctr);Ge("3DES-ECB",te.cipher.modes.ecb);Ge("3DES-CBC",te.cipher.modes.cbc);Ge("3DES-CFB",te.cipher.modes.cfb);Ge("3DES-OFB",te.cipher.modes.ofb);Ge("3DES-CTR",te.cipher.modes.ctr);function Ge(e,t){var r=function(){return new te.des.Algorithm(e,t)};te.cipher.registerAlgorithm(e,r)}var _c=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Rc=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Dc=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],kc=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Pc=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Nc=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Lc=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Kc=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Uc(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],f=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],c=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],y=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=e.length()>8?3:1,v=[],b=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,A,N=0;N<g;N++){var _=e.getInt32(),R=e.getInt32();A=(_>>>4^R)&252645135,R^=A,_^=A<<4,A=(R>>>-16^_)&65535,_^=A,R^=A<<-16,A=(_>>>2^R)&858993459,R^=A,_^=A<<2,A=(R>>>-16^_)&65535,_^=A,R^=A<<-16,A=(_>>>1^R)&1431655765,R^=A,_^=A<<1,A=(R>>>8^_)&16711935,_^=A,R^=A<<8,A=(_>>>1^R)&1431655765,R^=A,_^=A<<1,A=_<<8|R>>>20&240,_=R<<24|R<<8&16711680|R>>>8&65280|R>>>24&240,R=A;for(var O=0;O<b.length;++O){b[O]?(_=_<<2|_>>>26,R=R<<2|R>>>26):(_=_<<1|_>>>27,R=R<<1|R>>>27),_&=-15,R&=-15;var G=t[_>>>28]|r[_>>>24&15]|n[_>>>20&15]|i[_>>>16&15]|a[_>>>12&15]|s[_>>>8&15]|o[_>>>4&15],de=u[R>>>28]|f[R>>>24&15]|c[R>>>20&15]|h[R>>>16&15]|l[R>>>12&15]|y[R>>>8&15]|p[R>>>4&15];A=(de>>>16^G)&65535,v[E++]=G^A,v[E++]=de^A<<16}}return v}function b0(e,t,r,n){var i=e.length===32?3:9,a;i===3?a=n?[30,-2,-2]:[0,32,2]:a=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,o=t[0],u=t[1];s=(o>>>4^u)&252645135,u^=s,o^=s<<4,s=(o>>>16^u)&65535,u^=s,o^=s<<16,s=(u>>>2^o)&858993459,o^=s,u^=s<<2,s=(u>>>8^o)&16711935,o^=s,u^=s<<8,s=(o>>>1^u)&1431655765,u^=s,o^=s<<1,o=o<<1|o>>>31,u=u<<1|u>>>31;for(var f=0;f<i;f+=3){for(var c=a[f+1],h=a[f+2],l=a[f];l!=c;l+=h){var y=u^e[l],p=(u>>>4|u<<28)^e[l+1];s=o,o=u,u=s^(Rc[y>>>24&63]|kc[y>>>16&63]|Nc[y>>>8&63]|Kc[y&63]|_c[p>>>24&63]|Dc[p>>>16&63]|Pc[p>>>8&63]|Lc[p&63])}s=o,o=u,u=s}o=o>>>1|o<<31,u=u>>>1|u<<31,s=(o>>>1^u)&1431655765,u^=s,o^=s<<1,s=(u>>>8^o)&16711935,o^=s,u^=s<<8,s=(u>>>2^o)&858993459,o^=s,u^=s<<2,s=(o>>>16^u)&65535,u^=s,o^=s<<16,s=(o>>>4^u)&252645135,u^=s,o^=s<<4,r[0]=o,r[1]=u}function yn(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="DES-"+t,n;e.decrypt?n=te.cipher.createDecipher(r,e.key):n=te.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof te.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});var Lt=C((X1,E0)=>{var gn=$();E0.exports=gn.md=gn.md||{};gn.md.algorithms=gn.md.algorithms||{}});var A0=C((J1,B0)=>{var rt=$();Lt();se();var qc=B0.exports=rt.hmac=rt.hmac||{};qc.create=function(){var e=null,t=null,r=null,n=null,i={};return i.start=function(a,s){if(a!==null)if(typeof a=="string")if(a=a.toLowerCase(),a in rt.md.algorithms)t=rt.md.algorithms[a].create();else throw new Error('Unknown hash algorithm "'+a+'"');else t=a;if(s===null)s=e;else{if(typeof s=="string")s=rt.util.createBuffer(s);else if(rt.util.isArray(s)){var o=s;s=rt.util.createBuffer();for(var u=0;u<o.length;++u)s.putByte(o[u])}var f=s.length();f>t.blockLength&&(t.start(),t.update(s.bytes()),s=t.digest()),r=rt.util.createBuffer(),n=rt.util.createBuffer(),f=s.length();for(var u=0;u<f;++u){var o=s.at(u);r.putByte(54^o),n.putByte(92^o)}if(f<t.blockLength)for(var o=t.blockLength-f,u=0;u<o;++u)r.putByte(54),n.putByte(92);e=s,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},i.update=function(a){t.update(a)},i.getMac=function(){var a=t.digest().bytes();return t.start(),t.update(n),t.update(a),t.digest()},i.digest=i.getMac,i}});var Qt=C(()=>{});var Di=C((ry,C0)=>{var be=$();A0();Lt();se();var Oc=be.pkcs5=be.pkcs5||{},nt;be.util.isNodejs&&!be.options.usePureJavaScript&&(nt=Qt());C0.exports=be.pbkdf2=Oc.pbkdf2=function(e,t,r,n,i,a){if(typeof i=="function"&&(a=i,i=null),be.util.isNodejs&&!be.options.usePureJavaScript&&nt.pbkdf2&&(i===null||typeof i!="object")&&(nt.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),a?nt.pbkdf2Sync.length===4?nt.pbkdf2(e,t,r,n,function(A,N){if(A)return a(A);a(null,N.toString("binary"))}):nt.pbkdf2(e,t,r,n,i,function(A,N){if(A)return a(A);a(null,N.toString("binary"))}):nt.pbkdf2Sync.length===4?nt.pbkdf2Sync(e,t,r,n).toString("binary"):nt.pbkdf2Sync(e,t,r,n,i).toString("binary");if((typeof i=="undefined"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in be.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=be.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var o=new Error("Derived key is too long.");if(a)return a(o);throw o}var u=Math.ceil(n/s),f=n-(u-1)*s,c=be.hmac.create();c.start(i,e);var h="",l,y,p;if(!a){for(var g=1;g<=u;++g){c.start(null,null),c.update(t),c.update(be.util.int32ToBytes(g)),l=p=c.digest().getBytes();for(var v=2;v<=r;++v)c.start(null,null),c.update(p),y=c.digest().getBytes(),l=be.util.xorBytes(l,y,s),p=y;h+=g<u?l:l.substr(0,f)}return h}var g=1,v;function b(){if(g>u)return a(null,h);c.start(null,null),c.update(t),c.update(be.util.int32ToBytes(g)),l=p=c.digest().getBytes(),v=2,E()}function E(){if(v<=r)return c.start(null,null),c.update(p),y=c.digest().getBytes(),l=be.util.xorBytes(l,y,s),p=y,++v,be.util.setImmediate(E);h+=g<u?l:l.substr(0,f),++g,b()}b()}});var _0=C((ny,I0)=>{var xn=$();se();var T0=I0.exports=xn.pem=xn.pem||{};T0.encode=function(e,t){t=t||{};var r="-----BEGIN "+e.type+`-----\r
`,n;if(e.procType&&(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},r+=vn(n)),e.contentDomain&&(n={name:"Content-Domain",values:[e.contentDomain]},r+=vn(n)),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),r+=vn(n)),e.headers)for(var i=0;i<e.headers.length;++i)r+=vn(e.headers[i]);return e.procType&&(r+=`\r
`),r+=xn.util.encode64(e.body,t.maxline||64)+`\r
`,r+="-----END "+e.type+`-----\r
`,r};T0.decode=function(e){for(var t=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,a;a=r.exec(e),!!a;){var s={type:a[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:xn.util.decode64(a[3])};if(t.push(s),!!a[2]){for(var o=a[2].split(i),u=0;a&&u<o.length;){for(var f=o[u].replace(/\s+$/,""),c=u+1;c<o.length;++c){var h=o[c];if(!/\s/.test(h[0]))break;f+=h,u=c}if(a=f.match(n),a){for(var l={name:a[1],values:[]},y=a[2].split(","),p=0;p<y.length;++p)l.values.push(Fc(y[p]));if(s.procType)if(!s.contentDomain&&l.name==="Content-Domain")s.contentDomain=y[0]||"";else if(!s.dekInfo&&l.name==="DEK-Info"){if(l.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');s.dekInfo={algorithm:y[0],parameters:y[1]||null}}else s.headers.push(l);else{if(l.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(l.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');s.procType={version:y[0],type:y[1]}}}++u}if(s.procType==="ENCRYPTED"&&!s.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function vn(e){for(var t=e.name+": ",r=[],n=function(u,f){return" "+f},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+`\r
`;for(var a=0,s=-1,i=0;i<t.length;++i,++a)if(a>65&&s!==-1){var o=t[s];o===","?(++s,t=t.substr(0,s)+`\r
 `+t.substr(s)):t=t.substr(0,s)+`\r
`+o+t.substr(s+1),a=i-s-1,s=-1,++i}else(t[i]===" "||t[i]==="	"||t[i]===",")&&(s=i);return t}function Fc(e){return e.replace(/^\s+/,"")}});var L0=C((iy,N0)=>{var We=$();Lt();se();var R0=N0.exports=We.sha256=We.sha256||{};We.md.sha256=We.md.algorithms.sha256=R0;R0.create=function(){D0||Mc();var e=null,t=We.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return t=We.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=We.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(i),P0(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=We.util.createBuffer();i.putBytes(t.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(ki.substr(0,n.blockLength-s));for(var o,u,f=n.fullMessageLength[0]*8,c=0;c<n.fullMessageLength.length-1;++c)o=n.fullMessageLength[c+1]*8,u=o/4294967296>>>0,f+=u,i.putInt32(f>>>0),f=o>>>0;i.putInt32(f);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};P0(h,r,i);var l=We.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var ki=null,D0=!1,k0=null;function Mc(){ki=String.fromCharCode(128),ki+=We.util.fillString(String.fromCharCode(0),64),k0=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],D0=!0}function P0(e,t,r){for(var n,i,a,s,o,u,f,c,h,l,y,p,g,v,b,E=r.length();E>=64;){for(f=0;f<16;++f)t[f]=r.getInt32();for(;f<64;++f)n=t[f-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=t[f-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[f]=n+t[f-7]+i+t[f-16]|0;for(c=e.h0,h=e.h1,l=e.h2,y=e.h3,p=e.h4,g=e.h5,v=e.h6,b=e.h7,f=0;f<64;++f)s=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),o=v^p&(g^v),a=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),u=c&h|l&(c^h),n=b+s+o+k0[f]+t[f],i=a+u,b=v,v=g,g=p,p=y+n>>>0,y=l,l=h,h=c,c=n+i>>>0;e.h0=e.h0+c|0,e.h1=e.h1+h|0,e.h2=e.h2+l|0,e.h3=e.h3+y|0,e.h4=e.h4+p|0,e.h5=e.h5+g|0,e.h6=e.h6+v|0,e.h7=e.h7+b|0,E-=64}}});var U0=C((ay,K0)=>{var je=$();se();var mn=null;je.util.isNodejs&&!je.options.usePureJavaScript&&!process.versions["node-webkit"]&&(mn=Qt());var Vc=K0.exports=je.prng=je.prng||{};Vc.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();t.pools=n,t.pool=0,t.generate=function(f,c){if(!c)return t.generateSync(f);var h=t.plugin.cipher,l=t.plugin.increment,y=t.plugin.formatKey,p=t.plugin.formatSeed,g=je.util.createBuffer();t.key=null,v();function v(b){if(b)return c(b);if(g.length()>=f)return c(null,g.getBytes(f));if(t.generated>1048575&&(t.key=null),t.key===null)return je.util.nextTick(function(){a(v)});var E=h(t.key,t.seed);t.generated+=E.length,g.putBytes(E),t.key=y(h(t.key,l(t.seed))),t.seed=p(h(t.key,t.seed)),je.util.setImmediate(v)}},t.generateSync=function(f){var c=t.plugin.cipher,h=t.plugin.increment,l=t.plugin.formatKey,y=t.plugin.formatSeed;t.key=null;for(var p=je.util.createBuffer();p.length()<f;){t.generated>1048575&&(t.key=null),t.key===null&&s();var g=c(t.key,t.seed);t.generated+=g.length,p.putBytes(g),t.key=l(c(t.key,h(t.seed))),t.seed=y(c(t.key,t.seed))}return p.getBytes(f)};function a(f){if(t.pools[0].messageLength>=32)return o(),f();var c=32-t.pools[0].messageLength<<5;t.seedFile(c,function(h,l){if(h)return f(h);t.collect(l),o(),f()})}function s(){if(t.pools[0].messageLength>=32)return o();var f=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(f)),o()}function o(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var f=t.plugin.md.create();f.update(t.keyBytes);for(var c=1,h=0;h<32;++h)t.reseeds%c==0&&(f.update(t.pools[h].digest().getBytes()),t.pools[h].start()),c=c<<1;t.keyBytes=f.digest().getBytes(),f.start(),f.update(t.keyBytes);var l=f.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(l),t.generated=0}function u(f){var c=null,h=je.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(c=function(_){return l.getRandomValues(_)});var y=je.util.createBuffer();if(c)for(;y.length()<f;){var p=Math.max(1,Math.min(f-y.length(),65536)/4),g=new Uint32Array(Math.floor(p));try{c(g);for(var v=0;v<g.length;++v)y.putInt32(g[v])}catch(_){if(!(typeof QuotaExceededError!="undefined"&&_ instanceof QuotaExceededError))throw _}}if(y.length()<f)for(var b,E,A,N=Math.floor(Math.random()*65536);y.length()<f;){E=16807*(N&65535),b=16807*(N>>16),E+=(b&32767)<<16,E+=b>>15,E=(E&2147483647)+(E>>31),N=E&4294967295;for(var v=0;v<3;++v)A=N>>>(v<<3),A^=Math.floor(Math.random()*256),y.putByte(String.fromCharCode(A&255))}return y.getBytes(f)}return mn?(t.seedFile=function(f,c){mn.randomBytes(f,function(h,l){if(h)return c(h);c(null,l.toString())})},t.seedFileSync=function(f){return mn.randomBytes(f).toString()}):(t.seedFile=function(f,c){try{c(null,u(f))}catch(h){c(h)}},t.seedFileSync=u),t.collect=function(f){for(var c=f.length,h=0;h<c;++h)t.pools[t.pool].update(f.substr(h,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(f,c){for(var h="",l=0;l<c;l+=8)h+=String.fromCharCode(f>>l&255);t.collect(h)},t.registerWorker=function(f){if(f===self)t.seedFile=function(h,l){function y(p){var g=p.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",y),l(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",y),self.postMessage({forge:{prng:{needed:h}}})};else{var c=function(h){var l=h.data;l.forge&&l.forge.prng&&t.seedFile(l.forge.prng.needed,function(y,p){f.postMessage({forge:{prng:{err:y,bytes:p}}})})};f.addEventListener("message",c)}},t}});var mr=C((sy,Pi)=>{var pe=$();Wr();L0();U0();se();(function(){if(pe.random&&pe.random.getBytes){Pi.exports=pe.random;return}(function(e){var t={},r=new Array(4),n=pe.util.createBuffer();t.formatKey=function(h){var l=pe.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),pe.aes._expandKey(h,!1)},t.formatSeed=function(h){var l=pe.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},t.cipher=function(h,l){return pe.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},t.increment=function(h){return++h[3],h},t.md=pe.md.sha256;function i(){var h=pe.prng.create(t);return h.getBytes=function(l,y){return h.generate(l,y)},h.getBytesSync=function(l){return h.generate(l)},h}var a=i(),s=null,o=pe.util.globalScope,u=o.crypto||o.msCrypto;if(u&&u.getRandomValues&&(s=function(h){return u.getRandomValues(h)}),pe.options.usePureJavaScript||!pe.util.isNodejs&&!s){if(typeof window=="undefined"||window.document===void 0,a.collectInt(+new Date,32),typeof navigator!="undefined"){var f="";for(var c in navigator)try{typeof navigator[c]=="string"&&(f+=navigator[c])}catch(h){}a.collect(f),f=null}e&&(e().mousemove(function(h){a.collectInt(h.clientX,16),a.collectInt(h.clientY,16)}),e().keypress(function(h){a.collectInt(h.charCode,8)}))}if(!pe.random)pe.random=a;else for(var c in a)pe.random[c]=a[c];pe.random.createInstance=i,Pi.exports=pe.random})(typeof jQuery!="undefined"?jQuery:null)})()});var M0=C((oy,F0)=>{var Be=$();se();var Ni=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],q0=[1,2,3,5],zc=function(e,t){return e<<t&65535|(e&65535)>>16-t},Hc=function(e,t){return(e&65535)>>t|e<<16-t&65535};F0.exports=Be.rc2=Be.rc2||{};Be.rc2.expandKey=function(e,t){typeof e=="string"&&(e=Be.util.createBuffer(e)),t=t||128;var r=e,n=e.length(),i=t,a=Math.ceil(i/8),s=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(Ni[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-a,Ni[r.at(128-a)&s]),o=127-a;o>=0;o--)r.setAt(o,Ni[r.at(o+1)^r.at(o+a)]);return r};var O0=function(e,t,r){var n=!1,i=null,a=null,s=null,o,u,f,c,h=[];for(e=Be.rc2.expandKey(e,t),f=0;f<64;f++)h.push(e.getInt16Le());r?(o=function(p){for(f=0;f<4;f++)p[f]+=h[c]+(p[(f+3)%4]&p[(f+2)%4])+(~p[(f+3)%4]&p[(f+1)%4]),p[f]=zc(p[f],q0[f]),c++},u=function(p){for(f=0;f<4;f++)p[f]+=h[p[(f+3)%4]&63]}):(o=function(p){for(f=3;f>=0;f--)p[f]=Hc(p[f],q0[f]),p[f]-=h[c]+(p[(f+3)%4]&p[(f+2)%4])+(~p[(f+3)%4]&p[(f+1)%4]),c--},u=function(p){for(f=3;f>=0;f--)p[f]-=h[p[(f+3)%4]&63]});var l=function(p){var g=[];for(f=0;f<4;f++){var v=i.getInt16Le();s!==null&&(r?v^=s.getInt16Le():s.putInt16Le(v)),g.push(v&65535)}c=r?0:63;for(var b=0;b<p.length;b++)for(var E=0;E<p[b][0];E++)p[b][1](g);for(f=0;f<4;f++)s!==null&&(r?s.putInt16Le(g[f]):g[f]^=s.getInt16Le()),a.putInt16Le(g[f])},y=null;return y={start:function(p,g){p&&typeof p=="string"&&(p=Be.util.createBuffer(p)),n=!1,i=Be.util.createBuffer(),a=g||new Be.util.createBuffer,s=p,y.output=a},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,o],[1,u],[6,o],[1,u],[5,o]])},finish:function(p){var g=!0;if(r)if(p)g=p(8,i,!r);else{var v=i.length()===8?8:8-i.length();i.fillWithByte(v,v)}if(g&&(n=!0,y.update()),!r&&(g=i.length()===0,g))if(p)g=p(8,a,!r);else{var b=a.length(),E=a.at(b-1);E>b?g=!1:a.truncate(E)}return g}},y};Be.rc2.startEncrypting=function(e,t,r){var n=Be.rc2.createEncryptionCipher(e,128);return n.start(t,r),n};Be.rc2.createEncryptionCipher=function(e,t){return O0(e,t,!0)};Be.rc2.startDecrypting=function(e,t,r){var n=Be.rc2.createDecryptionCipher(e,128);return n.start(t,r),n};Be.rc2.createDecryptionCipher=function(e,t){return O0(e,t,!1)}});var Sn=C((fy,$0)=>{var Li=$();$0.exports=Li.jsbn=Li.jsbn||{};var it,Gc=244837814094590,V0=(Gc&16777215)==15715070;function w(e,t,r){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}Li.jsbn.BigInteger=w;function V(){return new w(null)}function Wc(e,t,r,n,i,a){for(;--a>=0;){var s=t*this.data[e++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function jc(e,t,r,n,i,a){for(var s=t&32767,o=t>>15;--a>=0;){var u=this.data[e]&32767,f=this.data[e++]>>15,c=o*u+f*s;u=s*u+((c&32767)<<15)+r.data[n]+(i&1073741823),i=(u>>>30)+(c>>>15)+o*f+(i>>>30),r.data[n++]=u&1073741823}return i}function z0(e,t,r,n,i,a){for(var s=t&16383,o=t>>14;--a>=0;){var u=this.data[e]&16383,f=this.data[e++]>>14,c=o*u+f*s;u=s*u+((c&16383)<<14)+r.data[n]+i,i=(u>>28)+(c>>14)+o*f,r.data[n++]=u&268435455}return i}typeof navigator=="undefined"?(w.prototype.am=z0,it=28):V0&&navigator.appName=="Microsoft Internet Explorer"?(w.prototype.am=jc,it=30):V0&&navigator.appName!="Netscape"?(w.prototype.am=Wc,it=26):(w.prototype.am=z0,it=28);w.prototype.DB=it;w.prototype.DM=(1<<it)-1;w.prototype.DV=1<<it;var Ki=52;w.prototype.FV=Math.pow(2,Ki);w.prototype.F1=Ki-it;w.prototype.F2=2*it-Ki;var Yc="0123456789abcdefghijklmnopqrstuvwxyz",bn=new Array,Zt,Re;Zt="0".charCodeAt(0);for(Re=0;Re<=9;++Re)bn[Zt++]=Re;Zt="a".charCodeAt(0);for(Re=10;Re<36;++Re)bn[Zt++]=Re;Zt="A".charCodeAt(0);for(Re=10;Re<36;++Re)bn[Zt++]=Re;function H0(e){return Yc.charAt(e)}function G0(e,t){var r=bn[e.charCodeAt(t)];return r??-1}function $c(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function Qc(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function bt(e){var t=V();return t.fromInt(e),t}function Zc(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,i=!1,a=0;--n>=0;){var s=r==8?e[n]&255:G0(e,n);if(s<0){e.charAt(n)=="-"&&(i=!0);continue}i=!1,a==0?this.data[this.t++]=s:a+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this.data[this.t++]=s>>this.DB-a):this.data[this.t-1]|=s<<a,a+=r,a>=this.DB&&(a-=this.DB)}r==8&&(e[0]&128)!=0&&(this.s=-1,a>0&&(this.data[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&w.ZERO.subTo(this,this)}function Xc(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function Jc(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,a="",s=this.t,o=this.DB-s*this.DB%t;if(s-- >0)for(o<this.DB&&(n=this.data[s]>>o)>0&&(i=!0,a=H0(n));s>=0;)o<t?(n=(this.data[s]&(1<<o)-1)<<t-o,n|=this.data[--s]>>(o+=this.DB-t)):(n=this.data[s]>>(o-=t)&r,o<=0&&(o+=this.DB,--s)),n>0&&(i=!0),i&&(a+=H0(n));return i?a:"0"}function eh(){var e=V();return w.ZERO.subTo(this,e),e}function th(){return this.s<0?this.negate():this}function rh(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this.data[r]-e.data[r])!=0)return t;return 0}function wn(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function nh(){return this.t<=0?0:this.DB*(this.t-1)+wn(this.data[this.t-1]^this.s&this.DM)}function ih(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}function ah(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}function sh(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,a=Math.floor(e/this.DB),s=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)t.data[o+a+1]=this.data[o]>>n|s,s=(this.data[o]&i)<<r;for(o=a-1;o>=0;--o)t.data[o]=0;t.data[a]=s,t.t=this.t+a+1,t.s=this.s,t.clamp()}function oh(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,a=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)t.data[s-r-1]|=(this.data[s]&a)<<i,t.data[s-r]=this.data[s]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&a)<<i),t.t=this.t-r,t.clamp()}function fh(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()}function uh(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&w.ZERO.subTo(t,t)}function ch(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}function hh(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t!=null&&t.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=V());var a=V(),s=this.s,o=e.s,u=this.DB-wn(n.data[n.t-1]);u>0?(n.lShiftTo(u,a),i.lShiftTo(u,r)):(n.copyTo(a),i.copyTo(r));var f=a.t,c=a.data[f-1];if(c!=0){var h=c*(1<<this.F1)+(f>1?a.data[f-2]>>this.F2:0),l=this.FV/h,y=(1<<this.F1)/h,p=1<<this.F2,g=r.t,v=g-f,b=t??V();for(a.dlShiftTo(v,b),r.compareTo(b)>=0&&(r.data[r.t++]=1,r.subTo(b,r)),w.ONE.dlShiftTo(f,b),b.subTo(a,a);a.t<f;)a.data[a.t++]=0;for(;--v>=0;){var E=r.data[--g]==c?this.DM:Math.floor(r.data[g]*l+(r.data[g-1]+p)*y);if((r.data[g]+=a.am(0,E,r,v,0,f))<E)for(a.dlShiftTo(v,b),r.subTo(b,r);r.data[g]<--E;)r.subTo(b,r)}t!=null&&(r.drShiftTo(f,t),s!=o&&w.ZERO.subTo(t,t)),r.t=f,r.clamp(),u>0&&r.rShiftTo(u,r),s<0&&w.ZERO.subTo(r,r)}}}function lh(e){var t=V();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(w.ZERO)>0&&e.subTo(t,t),t}function Kt(e){this.m=e}function ph(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function dh(e){return e}function yh(e){e.divRemTo(this.m,null,e)}function gh(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function xh(e,t){e.squareTo(t),this.reduce(t)}Kt.prototype.convert=ph;Kt.prototype.revert=dh;Kt.prototype.reduce=yh;Kt.prototype.mulTo=gh;Kt.prototype.sqrTo=xh;function vh(){if(this.t<1)return 0;var e=this.data[0];if((e&1)==0)return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function Ut(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function mh(e){var t=V();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(w.ZERO)>0&&this.m.subTo(t,t),t}function bh(e){var t=V();return e.copyTo(t),this.reduce(t),t}function wh(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e.data[t]&32767,n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Sh(e,t){e.squareTo(t),this.reduce(t)}function Eh(e,t,r){e.multiplyTo(t,r),this.reduce(r)}Ut.prototype.convert=mh;Ut.prototype.revert=bh;Ut.prototype.reduce=wh;Ut.prototype.mulTo=Eh;Ut.prototype.sqrTo=Sh;function Bh(){return(this.t>0?this.data[0]&1:this.s)==0}function Ah(e,t){if(e>4294967295||e<1)return w.ONE;var r=V(),n=V(),i=t.convert(this),a=wn(e)-1;for(i.copyTo(r);--a>=0;)if(t.sqrTo(r,n),(e&1<<a)>0)t.mulTo(n,i,r);else{var s=r;r=n,n=s}return t.revert(r)}function Ch(e,t){var r;return e<256||t.isEven()?r=new Kt(t):r=new Ut(t),this.exp(e,r)}w.prototype.copyTo=$c;w.prototype.fromInt=Qc;w.prototype.fromString=Zc;w.prototype.clamp=Xc;w.prototype.dlShiftTo=ih;w.prototype.drShiftTo=ah;w.prototype.lShiftTo=sh;w.prototype.rShiftTo=oh;w.prototype.subTo=fh;w.prototype.multiplyTo=uh;w.prototype.squareTo=ch;w.prototype.divRemTo=hh;w.prototype.invDigit=vh;w.prototype.isEven=Bh;w.prototype.exp=Ah;w.prototype.toString=Jc;w.prototype.negate=eh;w.prototype.abs=th;w.prototype.compareTo=rh;w.prototype.bitLength=nh;w.prototype.mod=lh;w.prototype.modPowInt=Ch;w.ZERO=bt(0);w.ONE=bt(1);function Th(){var e=V();return this.copyTo(e),e}function Ih(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function _h(){return this.t==0?this.s:this.data[0]<<24>>24}function Rh(){return this.t==0?this.s:this.data[0]<<16>>16}function Dh(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function kh(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Ph(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=bt(r),i=V(),a=V(),s="";for(this.divRemTo(n,i,a);i.signum()>0;)s=(r+a.intValue()).toString(e).substr(1)+s,i.divRemTo(n,i,a);return a.intValue().toString(e)+s}function Nh(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,a=0,s=0,o=0;o<e.length;++o){var u=G0(e,o);if(u<0){e.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}s=t*s+u,++a>=r&&(this.dMultiply(n),this.dAddOffset(s,0),a=0,s=0)}a>0&&(this.dMultiply(Math.pow(t,a)),this.dAddOffset(s,0)),i&&w.ZERO.subTo(this,this)}function Lh(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(w.ONE.shiftLeft(e-1),Ui,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(w.ONE.shiftLeft(e-1),this);else{var n=new Array,i=e&7;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Kh(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this.data[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this.data[e]&(1<<r)-1)<<8-r,n|=this.data[--e]>>(r+=this.DB-8)):(n=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function Uh(e){return this.compareTo(e)==0}function qh(e){return this.compareTo(e)<0?this:e}function Oh(e){return this.compareTo(e)>0?this:e}function Fh(e,t,r){var n,i,a=Math.min(e.t,this.t);for(n=0;n<a;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=a;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=a;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function Mh(e,t){return e&t}function Vh(e){var t=V();return this.bitwiseTo(e,Mh,t),t}function Ui(e,t){return e|t}function zh(e){var t=V();return this.bitwiseTo(e,Ui,t),t}function W0(e,t){return e^t}function Hh(e){var t=V();return this.bitwiseTo(e,W0,t),t}function j0(e,t){return e&~t}function Gh(e){var t=V();return this.bitwiseTo(e,j0,t),t}function Wh(){for(var e=V(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function jh(e){var t=V();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function Yh(e){var t=V();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function $h(e){if(e==0)return-1;var t=0;return(e&65535)==0&&(e>>=16,t+=16),(e&255)==0&&(e>>=8,t+=8),(e&15)==0&&(e>>=4,t+=4),(e&3)==0&&(e>>=2,t+=2),(e&1)==0&&++t,t}function Qh(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+$h(this.data[e]);return this.s<0?this.t*this.DB:-1}function Zh(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function Xh(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=Zh(this.data[r]^t);return e}function Jh(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function el(e,t){var r=w.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function tl(e){return this.changeBit(e,Ui)}function rl(e){return this.changeBit(e,j0)}function nl(e){return this.changeBit(e,W0)}function il(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()}function al(e){var t=V();return this.addTo(e,t),t}function sl(e){var t=V();return this.subTo(e,t),t}function ol(e){var t=V();return this.multiplyTo(e,t),t}function fl(e){var t=V();return this.divRemTo(e,t,null),t}function ul(e){var t=V();return this.divRemTo(e,null,t),t}function cl(e){var t=V(),r=V();return this.divRemTo(e,t,r),new Array(t,r)}function hl(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function ll(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function br(){}function Y0(e){return e}function pl(e,t,r){e.multiplyTo(t,r)}function dl(e,t){e.squareTo(t)}br.prototype.convert=Y0;br.prototype.revert=Y0;br.prototype.mulTo=pl;br.prototype.sqrTo=dl;function yl(e){return this.exp(e,new br)}function gl(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,e.data[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e.data[n],r,n,0,t-n);r.clamp()}function xl(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function Xt(e){this.r2=V(),this.q3=V(),w.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function vl(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=V();return e.copyTo(t),this.reduce(t),t}function ml(e){return e}function bl(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function wl(e,t){e.squareTo(t),this.reduce(t)}function Sl(e,t,r){e.multiplyTo(t,r),this.reduce(r)}Xt.prototype.convert=vl;Xt.prototype.revert=ml;Xt.prototype.reduce=bl;Xt.prototype.mulTo=Sl;Xt.prototype.sqrTo=wl;function El(e,t){var r=e.bitLength(),n,i=bt(1),a;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?a=new Kt(t):t.isEven()?a=new Xt(t):a=new Ut(t);var s=new Array,o=3,u=n-1,f=(1<<n)-1;if(s[1]=a.convert(this),n>1){var c=V();for(a.sqrTo(s[1],c);o<=f;)s[o]=V(),a.mulTo(c,s[o-2],s[o]),o+=2}var h=e.t-1,l,y=!0,p=V(),g;for(r=wn(e.data[h])-1;h>=0;){for(r>=u?l=e.data[h]>>r-u&f:(l=(e.data[h]&(1<<r+1)-1)<<u-r,h>0&&(l|=e.data[h-1]>>this.DB+r-u)),o=n;(l&1)==0;)l>>=1,--o;if((r-=o)<0&&(r+=this.DB,--h),y)s[l].copyTo(i),y=!1;else{for(;o>1;)a.sqrTo(i,p),a.sqrTo(p,i),o-=2;o>0?a.sqrTo(i,p):(g=i,i=p,p=g),a.mulTo(p,s[l],i)}for(;h>=0&&(e.data[h]&1<<r)==0;)a.sqrTo(i,p),g=i,i=p,p=g,--r<0&&(r=this.DB-1,--h)}return a.revert(i)}function Bl(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return t;for(i<a&&(a=i),a>0&&(t.rShiftTo(a,t),r.rShiftTo(a,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r}function Al(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r}function Cl(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return w.ZERO;for(var r=e.clone(),n=this.clone(),i=bt(1),a=bt(0),s=bt(0),o=bt(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!a.isEven())&&(i.addTo(this,i),a.subTo(e,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);for(;n.isEven();)n.rShiftTo(1,n),t?((!s.isEven()||!o.isEven())&&(s.addTo(this,s),o.subTo(e,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(s,i),a.subTo(o,a)):(n.subTo(r,n),t&&s.subTo(i,s),o.subTo(a,o))}if(n.compareTo(w.ONE)!=0)return w.ZERO;if(o.compareTo(e)>=0)return o.subtract(e);if(o.signum()<0)o.addTo(e,o);else return o;return o.signum()<0?o.add(e):o}var Fe=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Tl=(1<<26)/Fe[Fe.length-1];function Il(e){var t,r=this.abs();if(r.t==1&&r.data[0]<=Fe[Fe.length-1]){for(t=0;t<Fe.length;++t)if(r.data[0]==Fe[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<Fe.length;){for(var n=Fe[t],i=t+1;i<Fe.length&&n<Tl;)n*=Fe[i++];for(n=r.modInt(n);t<i;)if(n%Fe[t++]==0)return!1}return r.millerRabin(e)}function _l(e){var t=this.subtract(w.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n=t.shiftRight(r),i=Rl(),a,s=0;s<e;++s){do a=new w(this.bitLength(),i);while(a.compareTo(w.ONE)<=0||a.compareTo(t)>=0);var o=a.modPow(n,this);if(o.compareTo(w.ONE)!=0&&o.compareTo(t)!=0){for(var u=1;u++<r&&o.compareTo(t)!=0;)if(o=o.modPowInt(2,this),o.compareTo(w.ONE)==0)return!1;if(o.compareTo(t)!=0)return!1}}return!0}function Rl(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}w.prototype.chunkSize=Dh;w.prototype.toRadix=Ph;w.prototype.fromRadix=Nh;w.prototype.fromNumber=Lh;w.prototype.bitwiseTo=Fh;w.prototype.changeBit=el;w.prototype.addTo=il;w.prototype.dMultiply=hl;w.prototype.dAddOffset=ll;w.prototype.multiplyLowerTo=gl;w.prototype.multiplyUpperTo=xl;w.prototype.modInt=Al;w.prototype.millerRabin=_l;w.prototype.clone=Th;w.prototype.intValue=Ih;w.prototype.byteValue=_h;w.prototype.shortValue=Rh;w.prototype.signum=kh;w.prototype.toByteArray=Kh;w.prototype.equals=Uh;w.prototype.min=qh;w.prototype.max=Oh;w.prototype.and=Vh;w.prototype.or=zh;w.prototype.xor=Hh;w.prototype.andNot=Gh;w.prototype.not=Wh;w.prototype.shiftLeft=jh;w.prototype.shiftRight=Yh;w.prototype.getLowestSetBit=Qh;w.prototype.bitCount=Xh;w.prototype.testBit=Jh;w.prototype.setBit=tl;w.prototype.clearBit=rl;w.prototype.flipBit=nl;w.prototype.add=al;w.prototype.subtract=sl;w.prototype.multiply=ol;w.prototype.divide=fl;w.prototype.remainder=ul;w.prototype.divideAndRemainder=cl;w.prototype.modPow=El;w.prototype.modInverse=Cl;w.prototype.pow=yl;w.prototype.gcd=Bl;w.prototype.isProbablePrime=Il});var eo=C((uy,J0)=>{var Ye=$();Lt();se();var Q0=J0.exports=Ye.sha1=Ye.sha1||{};Ye.md.sha1=Ye.md.algorithms.sha1=Q0;Q0.create=function(){Z0||Dl();var e=null,t=Ye.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return t=Ye.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=Ye.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(i),X0(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=Ye.util.createBuffer();i.putBytes(t.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(qi.substr(0,n.blockLength-s));for(var o,u,f=n.fullMessageLength[0]*8,c=0;c<n.fullMessageLength.length-1;++c)o=n.fullMessageLength[c+1]*8,u=o/4294967296>>>0,f+=u,i.putInt32(f>>>0),f=o>>>0;i.putInt32(f);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};X0(h,r,i);var l=Ye.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var qi=null,Z0=!1;function Dl(){qi=String.fromCharCode(128),qi+=Ye.util.fillString(String.fromCharCode(0),64),Z0=!0}function X0(e,t,r){for(var n,i,a,s,o,u,f,c,h=r.length();h>=64;){for(i=e.h0,a=e.h1,s=e.h2,o=e.h3,u=e.h4,c=0;c<16;++c)n=r.getInt32(),t[c]=n,f=o^a&(s^o),n=(i<<5|i>>>27)+f+u+1518500249+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;c<20;++c)n=t[c-3]^t[c-8]^t[c-14]^t[c-16],n=n<<1|n>>>31,t[c]=n,f=o^a&(s^o),n=(i<<5|i>>>27)+f+u+1518500249+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;c<32;++c)n=t[c-3]^t[c-8]^t[c-14]^t[c-16],n=n<<1|n>>>31,t[c]=n,f=a^s^o,n=(i<<5|i>>>27)+f+u+1859775393+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;c<40;++c)n=t[c-6]^t[c-16]^t[c-28]^t[c-32],n=n<<2|n>>>30,t[c]=n,f=a^s^o,n=(i<<5|i>>>27)+f+u+1859775393+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;c<60;++c)n=t[c-6]^t[c-16]^t[c-28]^t[c-32],n=n<<2|n>>>30,t[c]=n,f=a&s|o&(a^s),n=(i<<5|i>>>27)+f+u+2400959708+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;c<80;++c)n=t[c-6]^t[c-16]^t[c-28]^t[c-32],n=n<<2|n>>>30,t[c]=n,f=a^s^o,n=(i<<5|i>>>27)+f+u+3395469782+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+a|0,e.h2=e.h2+s|0,e.h3=e.h3+o|0,e.h4=e.h4+u|0,h-=64}}});var no=C((cy,ro)=>{var $e=$();se();mr();eo();var to=ro.exports=$e.pkcs1=$e.pkcs1||{};to.encode_rsa_oaep=function(e,t,r){var n,i,a,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,a=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),a?a.start():a=$e.md.sha1.create(),s||(s=a);var o=Math.ceil(e.n.bitLength()/8),u=o-2*a.digestLength-2;if(t.length>u){var f=new Error("RSAES-OAEP input message length is too long.");throw f.length=t.length,f.maxLength=u,f}n||(n=""),a.update(n,"raw");for(var c=a.digest(),h="",l=u-t.length,y=0;y<l;y++)h+="\0";var p=c.getBytes()+h+""+t;if(!i)i=$e.random.getBytes(a.digestLength);else if(i.length!==a.digestLength){var f=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw f.seedLength=i.length,f.digestLength=a.digestLength,f}var g=En(i,o-a.digestLength-1,s),v=$e.util.xorBytes(p,g,p.length),b=En(v,a.digestLength,s),E=$e.util.xorBytes(i,b,i.length);return"\0"+E+v};to.decode_rsa_oaep=function(e,t,r){var n,i,a;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var s=Math.ceil(e.n.bitLength()/8);if(t.length!==s){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=t.length,v.expectedLength=s,v}if(i===void 0?i=$e.md.sha1.create():i.start(),a||(a=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var o=i.digest().getBytes(),u=t.charAt(0),f=t.substring(1,i.digestLength+1),c=t.substring(1+i.digestLength),h=En(c,i.digestLength,a),l=$e.util.xorBytes(f,h,f.length),y=En(l,s-i.digestLength-1,a),p=$e.util.xorBytes(c,y,c.length),g=p.substring(0,i.digestLength),v=u!=="\0",b=0;b<i.digestLength;++b)v|=o.charAt(b)!==g.charAt(b);for(var E=1,A=i.digestLength,N=i.digestLength;N<p.length;N++){var _=p.charCodeAt(N),R=_&1^1,O=E?65534:0;v|=_&O,E=E&R,A+=E}if(v||p.charCodeAt(A)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(A+1)};function En(e,t,r){r||(r=$e.md.sha1.create());for(var n="",i=Math.ceil(t/r.digestLength),a=0;a<i;++a){var s=String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255);r.start(),r.update(e+s),n+=r.digest().getBytes()}return n.substring(0,t)}});var io=C((hy,Oi)=>{var wt=$();se();Sn();mr();(function(){if(wt.prime){Oi.exports=wt.prime;return}var e=Oi.exports=wt.prime=wt.prime||{},t=wt.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new t(null);n.fromInt(30);var i=function(h,l){return h|l};e.generateProbablePrime=function(h,l,y){typeof l=="function"&&(y=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var g=l.prng||wt.random,v={nextBytes:function(b){for(var E=g.getBytesSync(b.length),A=0;A<b.length;++A)b[A]=E.charCodeAt(A)}};if(p.name==="PRIMEINC")return a(h,v,p.options,y);throw new Error("Invalid prime generation algorithm: "+p.name)};function a(h,l,y,p){return"workers"in y?u(h,l,y,p):s(h,l,y,p)}function s(h,l,y,p){var g=f(h,l),v=0,b=c(g.bitLength());"millerRabinTests"in y&&(b=y.millerRabinTests);var E=10;"maxBlockTime"in y&&(E=y.maxBlockTime),o(g,h,l,v,b,E,p)}function o(h,l,y,p,g,v,b){var E=+new Date;do{if(h.bitLength()>l&&(h=f(l,y)),h.isProbablePrime(g))return b(null,h);h.dAddOffset(r[p++%8],0)}while(v<0||+new Date-E<v);wt.util.setImmediate(function(){o(h,l,y,p,g,v,b)})}function u(h,l,y,p){if(typeof Worker=="undefined")return s(h,l,y,p);var g=f(h,l),v=y.workers,b=y.workLoad||100,E=b*30/8,A=y.workerScript||"forge/prime.worker.js";if(v===-1)return wt.util.estimateCores(function(_,R){_&&(R=2),v=R-1,N()});N();function N(){v=Math.max(1,v);for(var _=[],R=0;R<v;++R)_[R]=new Worker(A);for(var O=v,R=0;R<v;++R)_[R].addEventListener("message",de);var G=!1;function de(Ke){if(!G){--O;var Ae=Ke.data;if(Ae.found){for(var xe=0;xe<_.length;++xe)_[xe].terminate();return G=!0,p(null,new t(Ae.prime,16))}g.bitLength()>h&&(g=f(h,l));var Mt=g.toString(16);Ke.target.postMessage({hex:Mt,workLoad:b}),g.dAddOffset(E,0)}}}}function f(h,l){var y=new t(h,l),p=h-1;return y.testBit(p)||y.bitwiseTo(t.ONE.shiftLeft(p),i,y),y.dAddOffset(31-y.mod(n).byteValue(),0),y}function c(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var An=C((ly,ho)=>{var L=$();vr();Sn();pn();no();io();mr();se();typeof F=="undefined"&&(F=L.jsbn.BigInteger);var F,Fi=L.util.isNodejs?Qt():null,x=L.asn1,De=L.util;L.pki=L.pki||{};ho.exports=L.pki.rsa=L.rsa=L.rsa||{};var K=L.pki,kl=[6,4,2,4,2,4,6,2],Pl={name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Nl={name:"RSAPrivateKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Ll={name:"RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Kl=L.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Ul=function(e){var t;if(e.algorithm in K.oids)t=K.oids[e.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}var n=x.oidToDer(t).getBytes(),i=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]),a=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]);a.value.push(x.create(x.Class.UNIVERSAL,x.Type.OID,!1,n)),a.value.push(x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,""));var s=x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(a),i.value.push(s),x.toDer(i).getBytes()},ao=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(F.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(F.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var n;do n=new F(L.util.bytesToHex(L.random.getBytes(t.n.bitLength()/8)),16);while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(F.ONE));e=e.multiply(n.modPow(t.e,t.n)).mod(t.n);for(var i=e.mod(t.p).modPow(t.dP,t.p),a=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(a)<0;)i=i.add(t.p);var s=i.subtract(a).multiply(t.qInv).mod(t.p).multiply(t.q).add(a);return s=s.multiply(n.modInverse(t.n)).mod(t.n),s};K.rsa.encrypt=function(e,t,r){var n=r,i,a=Math.ceil(t.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=so(e,t,r)):(i=L.util.createBuffer(),i.putBytes(e));for(var s=new F(i.toHex(),16),o=ao(s,t,n),u=o.toString(16),f=L.util.createBuffer(),c=a-Math.ceil(u.length/2);c>0;)f.putByte(0),--c;return f.putBytes(L.util.hexToBytes(u)),f.getBytes()};K.rsa.decrypt=function(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var a=new Error("Encrypted message length is invalid.");throw a.length=e.length,a.expected=i,a}var s=new F(L.util.createBuffer(e).toHex(),16);if(s.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=ao(s,t,r),u=o.toString(16),f=L.util.createBuffer(),c=i-Math.ceil(u.length/2);c>0;)f.putByte(0),--c;return f.putBytes(L.util.hexToBytes(u)),n!==!1?Bn(f.getBytes(),t,r):f.getBytes()};K.rsa.createKeyPairGenerationState=function(e,t,r){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,r=r||{};var n=r.prng||L.random,i={nextBytes:function(o){for(var u=n.getBytesSync(o.length),f=0;f<o.length;++f)o[f]=u.charCodeAt(f)}},a=r.algorithm||"PRIMEINC",s;if(a==="PRIMEINC")s={algorithm:a,state:0,bits:e,rng:i,eInt:t||65537,e:new F(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+a);return s};K.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new F(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},a=+new Date,s,o=0;e.keys===null&&(t<=0||o<t);){if(e.state===0){var u=e.p===null?e.pBits:e.qBits,f=u-1;e.pqState===0?(e.num=new F(u,e.rng),e.num.testBit(f)||e.num.bitwiseTo(F.ONE.shiftLeft(f),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),n=0,++e.pqState):e.pqState===1?e.num.bitLength()>u?e.pqState=0:e.num.isProbablePrime(Ol(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(kl[n++%8],0):e.pqState===2?e.pqState=e.num.subtract(F.ONE).gcd(e.e).compareTo(F.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(F.ONE),e.q1=e.q.subtract(F.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(F.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var c=e.e.modInverse(e.phi);e.keys={privateKey:K.rsa.setPrivateKey(e.n,e.e,c,e.p,e.q,c.mod(e.p1),c.mod(e.q1),e.q.modInverse(e.p)),publicKey:K.rsa.setPublicKey(e.n,e.e)}}s=+new Date,o+=s-a,a=s}return e.keys!==null};K.rsa.generateKeyPair=function(e,t,r,n){if(arguments.length===1?typeof e=="object"?(r=e,e=void 0):typeof e=="function"&&(n=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(n=t,t=void 0):typeof t!="number"&&(r=t,t=void 0):(r=e,n=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=t,t=void 0)),r=r||{},e===void 0&&(e=r.bits||2048),t===void 0&&(t=r.e||65537),!L.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(n){if(oo("generateKeyPair"))return Fi.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,u,f){if(o)return n(o);n(null,{privateKey:K.privateKeyFromPem(f),publicKey:K.publicKeyFromPem(u)})});if(fo("generateKey")&&fo("exportKey"))return De.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:co(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return De.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var u=K.privateKeyFromAsn1(x.fromDer(L.util.createBuffer(o)));n(null,{privateKey:u,publicKey:K.setRsaPublicKey(u.n,u.e)})}});if(uo("generateKey")&&uo("exportKey")){var i=De.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:co(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var u=o.target.result,f=De.globalScope.msCrypto.subtle.exportKey("pkcs8",u.privateKey);f.oncomplete=function(c){var h=c.target.result,l=K.privateKeyFromAsn1(x.fromDer(L.util.createBuffer(h)));n(null,{privateKey:l,publicKey:K.setRsaPublicKey(l.n,l.e)})},f.onerror=function(c){n(c)}},i.onerror=function(o){n(o)};return}}else if(oo("generateKeyPairSync")){var a=Fi.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:K.privateKeyFromPem(a.privateKey),publicKey:K.publicKeyFromPem(a.publicKey)}}}var s=K.rsa.createKeyPairGenerationState(e,t,r);if(!n)return K.rsa.stepKeyPairGenerationState(s,0),s.keys;ql(s,r,n)};K.setRsaPublicKey=K.rsa.setPublicKey=function(e,t){var r={n:e,e:t};return r.encrypt=function(n,i,a){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,u,f){return so(o,u,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,u){return L.pkcs1.encode_rsa_oaep(u,o,a)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return K.rsa.encrypt(s,r,!0)},r.verify=function(n,i,a){typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSASSA-PKCS1-V1_5"),a==="RSASSA-PKCS1-V1_5"?a={verify:function(o,u){u=Bn(u,r,!0);var f=x.fromDer(u);return o===f.value[1].value}}:(a==="NONE"||a==="NULL"||a===null)&&(a={verify:function(o,u){return u=Bn(u,r,!0),o===u}});var s=K.rsa.decrypt(i,r,!0,!1);return a.verify(n,s,r.n.bitLength())},r};K.setRsaPrivateKey=K.rsa.setPrivateKey=function(e,t,r,n,i,a,s,o){var u={n:e,e:t,d:r,p:n,q:i,dP:a,dQ:s,qInv:o};return u.decrypt=function(f,c,h){typeof c=="string"?c=c.toUpperCase():c===void 0&&(c="RSAES-PKCS1-V1_5");var l=K.rsa.decrypt(f,u,!1,!1);if(c==="RSAES-PKCS1-V1_5")c={decode:Bn};else if(c==="RSA-OAEP"||c==="RSAES-OAEP")c={decode:function(y,p){return L.pkcs1.decode_rsa_oaep(p,y,h)}};else if(["RAW","NONE","NULL",null].indexOf(c)!==-1)c={decode:function(y){return y}};else throw new Error('Unsupported encryption scheme: "'+c+'".');return c.decode(l,u,!1)},u.sign=function(f,c){var h=!1;typeof c=="string"&&(c=c.toUpperCase()),c===void 0||c==="RSASSA-PKCS1-V1_5"?(c={encode:Ul},h=1):(c==="NONE"||c==="NULL"||c===null)&&(c={encode:function(){return f}},h=1);var l=c.encode(f,u.n.bitLength());return K.rsa.encrypt(l,u,h)},u};K.wrapRsaPrivateKey=function(e){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(K.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,x.toDer(e).getBytes())])};K.privateKeyFromAsn1=function(e){var t={},r=[];if(x.validate(e,Pl,t,r)&&(e=x.fromDer(L.util.createBuffer(t.privateKey))),t={},r=[],!x.validate(e,Nl,t,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,a,s,o,u,f,c,h;return i=L.util.createBuffer(t.privateKeyModulus).toHex(),a=L.util.createBuffer(t.privateKeyPublicExponent).toHex(),s=L.util.createBuffer(t.privateKeyPrivateExponent).toHex(),o=L.util.createBuffer(t.privateKeyPrime1).toHex(),u=L.util.createBuffer(t.privateKeyPrime2).toHex(),f=L.util.createBuffer(t.privateKeyExponent1).toHex(),c=L.util.createBuffer(t.privateKeyExponent2).toHex(),h=L.util.createBuffer(t.privateKeyCoefficient).toHex(),K.setRsaPrivateKey(new F(i,16),new F(a,16),new F(s,16),new F(o,16),new F(u,16),new F(f,16),new F(c,16),new F(h,16))};K.privateKeyToAsn1=K.privateKeyToRSAPrivateKey=function(e){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Qe(e.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Qe(e.e)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Qe(e.d)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Qe(e.p)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Qe(e.q)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Qe(e.dP)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Qe(e.dQ)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Qe(e.qInv))])};K.publicKeyFromAsn1=function(e){var t={},r=[];if(x.validate(e,Kl,t,r)){var n=x.derToOid(t.publicKeyOid);if(n!==K.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}e=t.rsaPublicKey}if(r=[],!x.validate(e,Ll,t,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var a=L.util.createBuffer(t.publicKeyModulus).toHex(),s=L.util.createBuffer(t.publicKeyExponent).toHex();return K.setRsaPublicKey(new F(a,16),new F(s,16))};K.publicKeyToAsn1=K.publicKeyToSubjectPublicKeyInfo=function(e){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(K.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.BITSTRING,!1,[K.publicKeyToRSAPublicKey(e)])])};K.publicKeyToRSAPublicKey=function(e){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Qe(e.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Qe(e.e))])};function so(e,t,r){var n=L.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var a=new Error("Message is too long for PKCS#1 v1.5 padding.");throw a.length=e.length,a.max=i-11,a}n.putByte(0),n.putByte(r);var s=i-3-e.length,o;if(r===0||r===1){o=r===0?0:255;for(var u=0;u<s;++u)n.putByte(o)}else for(;s>0;){for(var f=0,c=L.random.getBytes(s),u=0;u<s;++u)o=c.charCodeAt(u),o===0?++f:n.putByte(o);s=f}return n.putByte(0),n.putBytes(e),n}function Bn(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8),a=L.util.createBuffer(e),s=a.getByte(),o=a.getByte();if(s!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n=="undefined")throw new Error("Encryption block is invalid.");var u=0;if(o===0){u=i-3-n;for(var f=0;f<u;++f)if(a.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(u=0;a.length()>1;){if(a.getByte()!==255){--a.read;break}++u}else if(o===2)for(u=0;a.length()>1;){if(a.getByte()===0){--a.read;break}++u}var c=a.getByte();if(c!==0||u!==i-3-a.length())throw new Error("Encryption block is invalid.");return a.getBytes()}function ql(e,t,r){typeof t=="function"&&(r=t,t={}),t=t||{};var n={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(n.prng=t.prng),i();function i(){a(e.pBits,function(o,u){if(o)return r(o);if(e.p=u,e.q!==null)return s(o,e.q);a(e.qBits,s)})}function a(o,u){L.prime.generateProbablePrime(o,n,u)}function s(o,u){if(o)return r(o);if(e.q=u,e.p.compareTo(e.q)<0){var f=e.p;e.p=e.q,e.q=f}if(e.p.subtract(F.ONE).gcd(e.e).compareTo(F.ONE)!==0){e.p=null,i();return}if(e.q.subtract(F.ONE).gcd(e.e).compareTo(F.ONE)!==0){e.q=null,a(e.qBits,s);return}if(e.p1=e.p.subtract(F.ONE),e.q1=e.q.subtract(F.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(F.ONE)!==0){e.p=e.q=null,i();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,a(e.qBits,s);return}var c=e.e.modInverse(e.phi);e.keys={privateKey:K.rsa.setPrivateKey(e.n,e.e,c,e.p,e.q,c.mod(e.p1),c.mod(e.q1),e.q.modInverse(e.p)),publicKey:K.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}}function Qe(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=L.util.hexToBytes(t);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)==0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)==128)?r.substr(1):r}function Ol(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function oo(e){return L.util.isNodejs&&typeof Fi[e]=="function"}function fo(e){return typeof De.globalScope!="undefined"&&typeof De.globalScope.crypto=="object"&&typeof De.globalScope.crypto.subtle=="object"&&typeof De.globalScope.crypto.subtle[e]=="function"}function uo(e){return typeof De.globalScope!="undefined"&&typeof De.globalScope.msCrypto=="object"&&typeof De.globalScope.msCrypto.subtle=="object"&&typeof De.globalScope.msCrypto.subtle[e]=="function"}function co(e){for(var t=L.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}});var vo=C((py,xo)=>{var I=$();Wr();vr();S0();Lt();pn();Di();_0();mr();M0();An();se();typeof lo=="undefined"&&(lo=I.jsbn.BigInteger);var lo,m=I.asn1,U=I.pki=I.pki||{};xo.exports=U.pbe=I.pbe=I.pbe||{};var qt=U.oids,Fl={name:"EncryptedPrivateKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Ml={name:"PBES2Algorithms",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Vl={name:"pkcs-12PbeParams",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"iterations"}]};U.encryptPrivateKeyInfo=function(e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=I.random.getBytesSync(r.saltSize),i=r.count,a=m.integerToDer(i),s,o,u;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var f,c,h;switch(r.algorithm){case"aes128":s=16,f=16,c=qt["aes128-CBC"],h=I.aes.createEncryptionCipher;break;case"aes192":s=24,f=16,c=qt["aes192-CBC"],h=I.aes.createEncryptionCipher;break;case"aes256":s=32,f=16,c=qt["aes256-CBC"],h=I.aes.createEncryptionCipher;break;case"des":s=8,f=8,c=qt.desCBC,h=I.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var y="hmacWith"+r.prfAlgorithm.toUpperCase(),p=go(y),g=I.pkcs5.pbkdf2(t,n,i,s,p),v=I.random.getBytesSync(f),b=h(g);b.start(v),b.update(m.toDer(e)),b.finish(),u=b.output.getBytes();var E=zl(n,a,s,y);o=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(qt.pkcs5PBES2).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(qt.pkcs5PBKDF2).getBytes()),E]),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(c).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,!1,v)])])])}else if(r.algorithm==="3des"){s=24;var A=new I.util.ByteBuffer(n),g=U.pbe.generatePkcs12Key(t,A,1,i,s),v=U.pbe.generatePkcs12Key(t,A,2,i,s),b=I.des.createEncryptionCipher(g);b.start(v),b.update(m.toDer(e)),b.finish(),u=b.output.getBytes(),o=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(qt["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,!1,n),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,a.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var N=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[o,m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,!1,u)]);return N};U.decryptPrivateKeyInfo=function(e,t){var r=null,n={},i=[];if(!m.validate(e,Fl,n,i)){var a=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=m.derToOid(n.encryptionOid),o=U.pbe.getCipher(s,n.encryptionParams,t),u=I.util.createBuffer(n.encryptedData);return o.update(u),o.finish()&&(r=m.fromDer(o.output)),r};U.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:m.toDer(e).getBytes()};return I.pem.encode(r,{maxline:t})};U.encryptedPrivateKeyFromPem=function(e){var t=I.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return m.fromDer(t.body)};U.encryptRsaPrivateKey=function(e,t,r){if(r=r||{},!r.legacy){var n=U.wrapRsaPrivateKey(U.privateKeyToAsn1(e));return n=U.encryptPrivateKeyInfo(n,t,r),U.encryptedPrivateKeyToPem(n)}var i,a,s,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,a=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,a=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,a=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,a=I.random.getBytesSync(8),o=I.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,a=I.random.getBytesSync(8),o=I.des.createEncryptionCipher;break;default:var u=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw u.algorithm=r.algorithm,u}var f=I.pbe.opensslDeriveBytes(t,a.substr(0,8),s),c=o(f);c.start(a),c.update(m.toDer(U.privateKeyToAsn1(e))),c.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:I.util.bytesToHex(a).toUpperCase()},body:c.output.getBytes()};return I.pem.encode(h)};U.decryptRsaPrivateKey=function(e,t){var r=null,n=I.pem.decode(e)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var a,s;switch(n.dekInfo.algorithm){case"DES-CBC":a=8,s=I.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,s=I.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,s=I.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,s=I.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,s=I.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,s=function(h){return I.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":a=8,s=function(h){return I.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":a=16,s=function(h){return I.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=I.util.hexToBytes(n.dekInfo.parameters),u=I.pbe.opensslDeriveBytes(t,o.substr(0,8),a),f=s(u);if(f.start(o),f.update(I.util.createBuffer(n.body)),f.finish())r=f.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=U.decryptPrivateKeyInfo(m.fromDer(r),t):r=m.fromDer(r),r!==null&&(r=U.privateKeyFromAsn1(r)),r};U.pbe.generatePkcs12Key=function(e,t,r,n,i,a){var s,o;if(typeof a=="undefined"||a===null){if(!("sha1"in I.md))throw new Error('"sha1" hash algorithm unavailable.');a=I.md.sha1.create()}var u=a.digestLength,f=a.blockLength,c=new I.util.ByteBuffer,h=new I.util.ByteBuffer;if(e!=null){for(o=0;o<e.length;o++)h.putInt16(e.charCodeAt(o));h.putInt16(0)}var l=h.length(),y=t.length(),p=new I.util.ByteBuffer;p.fillWithByte(r,f);var g=f*Math.ceil(y/f),v=new I.util.ByteBuffer;for(o=0;o<g;o++)v.putByte(t.at(o%y));var b=f*Math.ceil(l/f),E=new I.util.ByteBuffer;for(o=0;o<b;o++)E.putByte(h.at(o%l));var A=v;A.putBuffer(E);for(var N=Math.ceil(i/u),_=1;_<=N;_++){var R=new I.util.ByteBuffer;R.putBytes(p.bytes()),R.putBytes(A.bytes());for(var O=0;O<n;O++)a.start(),a.update(R.getBytes()),R=a.digest();var G=new I.util.ByteBuffer;for(o=0;o<f;o++)G.putByte(R.at(o%u));var de=Math.ceil(y/f)+Math.ceil(l/f),Ke=new I.util.ByteBuffer;for(s=0;s<de;s++){var Ae=new I.util.ByteBuffer(A.getBytes(f)),xe=511;for(o=G.length()-1;o>=0;o--)xe=xe>>8,xe+=G.at(o)+Ae.at(o),Ae.setAt(o,xe&255);Ke.putBuffer(Ae)}A=Ke,c.putBuffer(R)}return c.truncate(c.length()-i),c};U.pbe.getCipher=function(e,t,r){switch(e){case U.oids.pkcs5PBES2:return U.pbe.getCipherForPBES2(e,t,r);case U.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case U.oids["pbewithSHAAnd40BitRC2-CBC"]:return U.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};U.pbe.getCipherForPBES2=function(e,t,r){var n={},i=[];if(!m.validate(t,Ml,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}if(e=m.derToOid(n.kdfOid),e!==U.oids.pkcs5PBKDF2){var a=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw a.oid=e,a.supportedOids=["pkcs5PBKDF2"],a}if(e=m.derToOid(n.encOid),e!==U.oids["aes128-CBC"]&&e!==U.oids["aes192-CBC"]&&e!==U.oids["aes256-CBC"]&&e!==U.oids["des-EDE3-CBC"]&&e!==U.oids.desCBC){var a=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw a.oid=e,a.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],a}var s=n.kdfSalt,o=I.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var u,f;switch(U.oids[e]){case"aes128-CBC":u=16,f=I.aes.createDecryptionCipher;break;case"aes192-CBC":u=24,f=I.aes.createDecryptionCipher;break;case"aes256-CBC":u=32,f=I.aes.createDecryptionCipher;break;case"des-EDE3-CBC":u=24,f=I.des.createDecryptionCipher;break;case"desCBC":u=8,f=I.des.createDecryptionCipher;break}var c=yo(n.prfOid),h=I.pkcs5.pbkdf2(r,s,o,u,c),l=n.encIv,y=f(h);return y.start(l),y};U.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},i=[];if(!m.validate(t,Vl,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=I.util.createBuffer(n.salt),o=I.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var u,f,c;switch(e){case U.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:u=24,f=8,c=I.des.startDecrypting;break;case U.oids["pbewithSHAAnd40BitRC2-CBC"]:u=5,f=8,c=function(g,v){var b=I.rc2.createDecryptionCipher(g,40);return b.start(v,null),b};break;default:var a=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw a.oid=e,a}var h=yo(n.prfOid),l=U.pbe.generatePkcs12Key(r,s,1,o,u,h);h.start();var y=U.pbe.generatePkcs12Key(r,s,2,o,f,h);return c(l,y)};U.pbe.opensslDeriveBytes=function(e,t,r,n){if(typeof n=="undefined"||n===null){if(!("md5"in I.md))throw new Error('"md5" hash algorithm unavailable.');n=I.md.md5.create()}t===null&&(t="");for(var i=[po(n,e+t)],a=16,s=1;a<r;++s,a+=16)i.push(po(n,i[s-1]+e+t));return i.join("").substr(0,r)};function po(e,t){return e.start().update(t).digest().getBytes()}function yo(e){var t;if(!e)t="hmacWithSHA1";else if(t=U.oids[m.derToOid(e)],!t){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return go(t)}function go(e){var t=I.md;switch(e){case"hmacWithSHA224":t=I.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function zl(e,t,r,n){var i=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,!1,e),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,t.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,I.util.hexToBytes(r.toString(16))),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(U.oids[n]).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.NULL,!1,"")])),i}});var wr={};ve(wr,{concat:()=>Hl});function Hl(e,t){t||(t=e.reduce((i,a)=>i+a.length,0));let r=new Uint8Array(t),n=0;for(let i of e)r.set(i,n),n+=i.length;return r}var Sr=Q(()=>{});var Mi=C((dy,bo)=>{"use strict";var{concat:Gl}=(Sr(),wr),{fromString:mo}=(gt(),yt),Wl=ar();function jl({algorithm:e="AES-GCM",nonceLength:t=12,keyLength:r=16,digest:n="SHA-256",saltLength:i=16,iterations:a=32767}={}){let s=Wl.get();r*=8;async function o(f,c){let h=s.getRandomValues(new Uint8Array(i)),l=s.getRandomValues(new Uint8Array(t)),y={name:e,iv:l},p={name:"PBKDF2",salt:h,iterations:a,hash:{name:n}},g=await s.subtle.importKey("raw",mo(c),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),v=await s.subtle.deriveKey(p,g,{name:e,length:r},!0,["encrypt"]),b=await s.subtle.encrypt(y,v,f);return Gl([h,y.iv,new Uint8Array(b)])}async function u(f,c){let h=f.slice(0,i),l=f.slice(i,i+t),y=f.slice(i+t),p={name:e,iv:l},g={name:"PBKDF2",salt:h,iterations:a,hash:{name:n}},v=await s.subtle.importKey("raw",mo(c),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),b=await s.subtle.deriveKey(g,v,{name:e,length:r},!0,["decrypt"]),E=await s.subtle.decrypt(p,b,y);return new Uint8Array(E)}return{encrypt:o,decrypt:u}}bo.exports={create:jl}});var So=C((yy,wo)=>{"use strict";var{base64:Yl}=(Qr(),or),$l=Mi();wo.exports={import:async function(e,t){let r=Yl.decode(e);return await $l.create().decrypt(r,t)}}});var Er={};ve(Er,{equals:()=>Ql});function Ql(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var Br=Q(()=>{});var To=C((gy,Co)=>{var J=$();Lt();se();var Ar=Co.exports=J.sha512=J.sha512||{};J.md.sha512=J.md.algorithms.sha512=Ar;var Eo=J.sha384=J.sha512.sha384=J.sha512.sha384||{};Eo.create=function(){return Ar.create("SHA-384")};J.md.sha384=J.md.algorithms.sha384=Eo;J.sha512.sha256=J.sha512.sha256||{create:function(){return Ar.create("SHA-512/256")}};J.md["sha512/256"]=J.md.algorithms["sha512/256"]=J.sha512.sha256;J.sha512.sha224=J.sha512.sha224||{create:function(){return Ar.create("SHA-512/224")}};J.md["sha512/224"]=J.md.algorithms["sha512/224"]=J.sha512.sha224;Ar.create=function(e){if(Bo||Zl(),typeof e=="undefined"&&(e="SHA-512"),!(e in Ot))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=Ot[e],r=null,n=J.util.createBuffer(),i=new Array(80),a=0;a<80;++a)i[a]=new Array(2);var s=64;switch(e){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var o={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var u=o.messageLengthSize/4,f=0;f<u;++f)o.fullMessageLength.push(0);n=J.util.createBuffer(),r=new Array(t.length);for(var f=0;f<t.length;++f)r[f]=t[f].slice(0);return o},o.start(),o.update=function(u,f){f==="utf8"&&(u=J.util.encodeUtf8(u));var c=u.length;o.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var h=o.fullMessageLength.length-1;h>=0;--h)o.fullMessageLength[h]+=c[1],c[1]=c[0]+(o.fullMessageLength[h]/4294967296>>>0),o.fullMessageLength[h]=o.fullMessageLength[h]>>>0,c[0]=c[1]/4294967296>>>0;return n.putBytes(u),Ao(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),o},o.digest=function(){var u=J.util.createBuffer();u.putBytes(n.bytes());var f=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,c=f&o.blockLength-1;u.putBytes(Vi.substr(0,o.blockLength-c));for(var h,l,y=o.fullMessageLength[0]*8,p=0;p<o.fullMessageLength.length-1;++p)h=o.fullMessageLength[p+1]*8,l=h/4294967296>>>0,y+=l,u.putInt32(y>>>0),y=h>>>0;u.putInt32(y);for(var g=new Array(r.length),p=0;p<r.length;++p)g[p]=r[p].slice(0);Ao(g,i,u);var v=J.util.createBuffer(),b;e==="SHA-512"?b=g.length:e==="SHA-384"?b=g.length-2:b=g.length-4;for(var p=0;p<b;++p)v.putInt32(g[p][0]),(p!==b-1||e!=="SHA-512/224")&&v.putInt32(g[p][1]);return v},o};var Vi=null,Bo=!1,zi=null,Ot=null;function Zl(){Vi=String.fromCharCode(128),Vi+=J.util.fillString(String.fromCharCode(0),128),zi=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Ot={},Ot["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Ot["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Ot["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Ot["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Bo=!0}function Ao(e,t,r){for(var n,i,a,s,o,u,f,c,h,l,y,p,g,v,b,E,A,N,_,R,O,G,de,Ke,Ae,xe,Mt,Or,fe,Se,P,Vn,zn,Hn,Gn,na=r.length();na>=128;){for(fe=0;fe<16;++fe)t[fe][0]=r.getInt32()>>>0,t[fe][1]=r.getInt32()>>>0;for(;fe<80;++fe)Vn=t[fe-2],Se=Vn[0],P=Vn[1],n=((Se>>>19|P<<13)^(P>>>29|Se<<3)^Se>>>6)>>>0,i=((Se<<13|P>>>19)^(P<<3|Se>>>29)^(Se<<26|P>>>6))>>>0,Hn=t[fe-15],Se=Hn[0],P=Hn[1],a=((Se>>>1|P<<31)^(Se>>>8|P<<24)^Se>>>7)>>>0,s=((Se<<31|P>>>1)^(Se<<24|P>>>8)^(Se<<25|P>>>7))>>>0,zn=t[fe-7],Gn=t[fe-16],P=i+zn[1]+s+Gn[1],t[fe][0]=n+zn[0]+a+Gn[0]+(P/4294967296>>>0)>>>0,t[fe][1]=P>>>0;for(g=e[0][0],v=e[0][1],b=e[1][0],E=e[1][1],A=e[2][0],N=e[2][1],_=e[3][0],R=e[3][1],O=e[4][0],G=e[4][1],de=e[5][0],Ke=e[5][1],Ae=e[6][0],xe=e[6][1],Mt=e[7][0],Or=e[7][1],fe=0;fe<80;++fe)f=((O>>>14|G<<18)^(O>>>18|G<<14)^(G>>>9|O<<23))>>>0,c=((O<<18|G>>>14)^(O<<14|G>>>18)^(G<<23|O>>>9))>>>0,h=(Ae^O&(de^Ae))>>>0,l=(xe^G&(Ke^xe))>>>0,o=((g>>>28|v<<4)^(v>>>2|g<<30)^(v>>>7|g<<25))>>>0,u=((g<<4|v>>>28)^(v<<30|g>>>2)^(v<<25|g>>>7))>>>0,y=(g&b|A&(g^b))>>>0,p=(v&E|N&(v^E))>>>0,P=Or+c+l+zi[fe][1]+t[fe][1],n=Mt+f+h+zi[fe][0]+t[fe][0]+(P/4294967296>>>0)>>>0,i=P>>>0,P=u+p,a=o+y+(P/4294967296>>>0)>>>0,s=P>>>0,Mt=Ae,Or=xe,Ae=de,xe=Ke,de=O,Ke=G,P=R+i,O=_+n+(P/4294967296>>>0)>>>0,G=P>>>0,_=A,R=N,A=b,N=E,b=g,E=v,P=i+s,g=n+a+(P/4294967296>>>0)>>>0,v=P>>>0;P=e[0][1]+v,e[0][0]=e[0][0]+g+(P/4294967296>>>0)>>>0,e[0][1]=P>>>0,P=e[1][1]+E,e[1][0]=e[1][0]+b+(P/4294967296>>>0)>>>0,e[1][1]=P>>>0,P=e[2][1]+N,e[2][0]=e[2][0]+A+(P/4294967296>>>0)>>>0,e[2][1]=P>>>0,P=e[3][1]+R,e[3][0]=e[3][0]+_+(P/4294967296>>>0)>>>0,e[3][1]=P>>>0,P=e[4][1]+G,e[4][0]=e[4][0]+O+(P/4294967296>>>0)>>>0,e[4][1]=P>>>0,P=e[5][1]+Ke,e[5][0]=e[5][0]+de+(P/4294967296>>>0)>>>0,e[5][1]=P>>>0,P=e[6][1]+xe,e[6][0]=e[6][0]+Ae+(P/4294967296>>>0)>>>0,e[6][1]=P>>>0,P=e[7][1]+Or,e[7][0]=e[7][0]+Mt+(P/4294967296>>>0)>>>0,e[7][1]=P>>>0,na-=128}}});var _o=C((xy,Io)=>{"use strict";var Cn=65536;function Xl(e){let t=new Uint8Array(e),r=0;if(e>0)if(e>Cn)for(;r<e;)r+Cn>e?(crypto.getRandomValues(t.subarray(r,r+(e-r))),r+=e-r):(crypto.getRandomValues(t.subarray(r,r+Cn)),r+=Cn);else crypto.getRandomValues(t);return t}Io.exports=Xl});var Tn=C((vy,Ro)=>{"use strict";var Jl=_o(),ep=Te();Ro.exports=function(e){if(isNaN(e)||e<=0)throw ep(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return Jl(e)}});var In=C(Cr=>{"use strict";se();Sn();var tp=$(),{fromString:rp}=(gt(),yt),{toString:Do}=(dt(),pt),{concat:ko}=(Sr(),wr);Cr.bigIntegerToUintBase64url=(e,t)=>{let r=Uint8Array.from(e.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=ko([new Uint8Array(t-r.length),r])}return Do(r,"base64url")};Cr.base64urlToBigInteger=e=>{let t=Cr.base64urlToBuffer(e);return new tp.jsbn.BigInteger(Do(t,"base16"),16)};Cr.base64urlToBuffer=(e,t)=>{let r=rp(e,"base64urlpad");if(t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=ko([new Uint8Array(t-r.length),r])}return r}});var Lo=C(Tr=>{"use strict";vr();An();var St=$(),{bigIntegerToUintBase64url:Ze,base64urlToBigInteger:Xe}=In(),{fromString:Po}=(gt(),yt),{toString:No}=(dt(),pt);Tr.pkcs1ToJwk=function(e){let t=St.asn1.fromDer(No(e,"ascii")),r=St.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:Ze(r.n),e:Ze(r.e),d:Ze(r.d),p:Ze(r.p),q:Ze(r.q),dp:Ze(r.dP),dq:Ze(r.dQ),qi:Ze(r.qInv),alg:"RS256",kid:"2011-04-29"}};Tr.jwkToPkcs1=function(e){let t=St.pki.privateKeyToAsn1({n:Xe(e.n),e:Xe(e.e),d:Xe(e.d),p:Xe(e.p),q:Xe(e.q),dP:Xe(e.dp),dQ:Xe(e.dq),qInv:Xe(e.qi)});return Po(St.asn1.toDer(t).getBytes(),"ascii")};Tr.pkixToJwk=function(e){let t=St.asn1.fromDer(No(e,"ascii")),r=St.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:Ze(r.n),e:Ze(r.e),alg:"RS256",kid:"2011-04-29"}};Tr.jwkToPkix=function(e){let t=St.pki.publicKeyToAsn1({n:Xe(e.n),e:Xe(e.e)});return Po(St.asn1.toDer(t).getBytes(),"ascii")}});var Oo=C((wy,qo)=>{"use strict";An();var Ko=$(),{base64urlToBigInteger:np}=In();function Uo(e,t){return t.map(r=>np(e[r]))}function ip(e){return Ko.pki.setRsaPrivateKey(...Uo(e,["n","e","d","p","q","dp","dq","qi"]))}function ap(e){return Ko.pki.setRsaPublicKey(...Uo(e,["n","e"]))}qo.exports={jwk2pub:ap,jwk2priv:ip}});var Vo=C(st=>{"use strict";var at=ar(),sp=Tn(),{toString:op}=(dt(),pt),{fromString:fp}=(gt(),yt);st.utils=Lo();st.generateKey=async function(e){let t=await at.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Fo(t);return{privateKey:r[0],publicKey:r[1]}};st.unmarshalPrivateKey=async function(e){let r=[await at.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await up(e)],n=await Fo({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}};st.getRandomValues=sp;st.hashAndSign=async function(e,t){let r=await at.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await at.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,n.byteOffset,n.byteLength)};st.hashAndVerify=async function(e,t,r){let n=await at.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return at.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)};function Fo(e){return Promise.all([at.get().subtle.exportKey("jwk",e.privateKey),at.get().subtle.exportKey("jwk",e.publicKey)])}function up(e){return at.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:cp,jwk2priv:hp}=Oo();function Mo(e,t,r,n){let i=t?cp(e):hp(e),a=op(Uint8Array.from(r),"ascii"),s=n(a,i);return fp(s,"ascii")}st.encrypt=function(e,t){return Mo(e,!0,t,(r,n)=>n.encrypt(r))};st.decrypt=function(e,t){return Mo(e,!1,t,(r,n)=>n.decrypt(r))}});var _n=C((Ey,zo)=>{"use strict";var{base64:lp}=(Qr(),or),pp=Mi();zo.exports={export:async function(e,t){let n=await pp.create().encrypt(e,t);return lp.encode(n)}}});var Yo=C((By,jo)=>{"use strict";var{sha256:Ho}=(jt(),Dt),Go=Te(),{equals:Wo}=(Br(),Er),{toString:dp}=(dt(),pt);To();var Rn=$(),ke=Vo(),Dn=ln(),yp=_n(),kn=class{constructor(t){this._key=t}async verify(t,r){return ke.hashAndVerify(this._key,r,t)}marshal(){return ke.utils.jwkToPkix(this._key)}get bytes(){return Dn.PublicKey.encode({Type:Dn.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(t){return ke.encrypt(this._key,t)}equals(t){return Wo(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Ho.digest(this.bytes);return t}},Ir=class{constructor(t,r){this._key=t,this._publicKey=r}genSecret(){return ke.getRandomValues(16)}async sign(t){return ke.hashAndSign(this._key,t)}get public(){if(!this._publicKey)throw Go(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new kn(this._publicKey)}decrypt(t){return ke.decrypt(this._key,t)}marshal(){return ke.utils.jwkToPkcs1(this._key)}get bytes(){return Dn.PrivateKey.encode({Type:Dn.KeyType.RSA,Data:this.marshal()}).finish()}equals(t){return Wo(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Ho.digest(this.bytes);return t}async id(){let t=await this.public.hash();return dp(t,"base58btc")}async export(t,r="pkcs-8"){if(r==="pkcs-8"){let n=new Rn.util.ByteBuffer(this.marshal()),i=Rn.asn1.fromDer(n),a=Rn.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Rn.pki.encryptRsaPrivateKey(a,t,s)}else{if(r==="libp2p-key")return yp.export(this.bytes,t);throw Go(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function gp(e){let t=ke.utils.pkcs1ToJwk(e),r=await ke.unmarshalPrivateKey(t);return new Ir(r.privateKey,r.publicKey)}function xp(e){let t=ke.utils.pkixToJwk(e);return new kn(t)}async function vp(e){let t=await ke.unmarshalPrivateKey(e);return new Ir(t.privateKey,t.publicKey)}async function mp(e){let t=await ke.generateKey(e);return new Ir(t.privateKey,t.publicKey)}jo.exports={RsaPublicKey:kn,RsaPrivateKey:Ir,unmarshalRsaPublicKey:xp,unmarshalRsaPrivateKey:gp,generateKeyPair:mp,fromJwk:vp}});var rf=C((ne,tf)=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});ne.utils=ne.verify=ne.sign=ne.getPublicKey=ne.SignResult=ne.Signature=ne.Point=ne.ExtendedPoint=ne.CURVE=void 0;var ie={a:-1n,d:37095705934669439343138083508754565189542113879843219016388785533085940283555n,P:2n**255n-19n,n:2n**252n+27742317777372353535851937790883648493n,h:8n,Gx:15112221349535400772501151409588531511454012693041857206046113283949847762202n,Gy:46316835694926478169428394003475163141307993866256225615783033603165251855960n};ne.CURVE=ie;var we=32,_r=19681161376707505956807079304988542015446066515923890162744021073123829784752n,bp=25063068953384623474111414158702152701244531502492656460079210482610430750235n,wp=54469307008909316920995813868745141605393597292927456921205312896311721017578n,Sp=1159843021668779879193775521855586647937357759715417654439879720876111806838n,Ep=40440834346308536858101042469323190826248399146238708352240133220865137265952n,Z=class{constructor(t,r,n,i){this.x=t,this.y=r,this.z=n,this.t=i}static fromAffine(t){if(!(t instanceof re))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return t.equals(re.ZERO)?Z.ZERO:new Z(t.x,t.y,1n,S(t.x*t.y))}static toAffineBatch(t){let r=Ap(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return this.toAffineBatch(t).map(this.fromAffine)}static fromRistrettoHash(t){let r=Wi(t.slice(0,we)),n=this.calcElligatorRistrettoMap(r),i=Wi(t.slice(we,we*2)),a=this.calcElligatorRistrettoMap(i);return n.add(a)}static calcElligatorRistrettoMap(t){let{d:r}=ie,n=S(_r*t*t),i=S((n+1n)*Sp),a=-1n,s=S((a-r*n)*S(n+r)),{isValid:o,value:u}=Yi(i,s),f=S(u*t);Bt(f)||(f=S(-f)),o||(u=f),o||(a=n);let c=S(a*(n-1n)*Ep-s),h=u*u,l=S((u+u)*s),y=S(c*bp),p=S(1n-h),g=S(1n+h);return new Z(S(l*g),S(p*y),S(y*g),S(l*p))}static fromRistrettoBytes(t){let{a:r,d:n}=ie,i="ExtendedPoint.fromRistrettoBytes: Cannot convert bytes to Ristretto Point",a=Wi(t);if(!Ip(Qo(a,we),t)||Bt(a))throw new Error(i);let s=S(a*a),o=S(1n+r*s),u=S(1n-r*s),f=S(o*o),c=S(u*u),h=S(r*n*f-c),{isValid:l,value:y}=Xo(S(h*c)),p=S(y*u),g=S(y*p*h),v=S((a+a)*p);Bt(v)&&(v=S(-v));let b=S(o*g),E=S(v*b);if(!l||Bt(E)||b===0n)throw new Error(i);return new Z(v,b,1n,E)}toRistrettoBytes(){let{x:t,y:r,z:n,t:i}=this,a=S((n+r)*(n-r)),s=S(t*r),{value:o}=Xo(S(a*s**2n)),u=S(o*a),f=S(o*s),c=S(u*f*i),h;Bt(i*c)?([t,r]=[S(r*_r),S(t*_r)],h=S(u*wp)):h=f,Bt(t*c)&&(r=S(-r));let l=S((n-r)*h);return Bt(l)&&(l=S(-l)),Qo(l,we)}equals(t){let r=this,n=t,[i,a,s,o]=[r.t,n.t,r.z,n.z];return S(i*o)===S(a*s)}negate(){return new Z(S(-this.x),this.y,this.z,S(-this.t))}double(){let t=this.x,r=this.y,n=this.z,{a:i}=ie,a=S(t**2n),s=S(r**2n),o=S(2n*n**2n),u=S(i*a),f=S((t+r)**2n-a-s),c=S(u+s),h=S(c-o),l=S(u-s),y=S(f*h),p=S(c*l),g=S(f*l),v=S(h*c);return new Z(y,p,v,g)}add(t){let r=this.x,n=this.y,i=this.z,a=this.t,s=t.x,o=t.y,u=t.z,f=t.t,c=S((n-r)*(o+s)),h=S((n+r)*(o-s)),l=S(h-c);if(l===0n)return this.double();let y=S(i*2n*f),p=S(a*2n*u),g=S(p+y),v=S(h+c),b=S(p-y),E=S(g*l),A=S(v*b),N=S(g*b),_=S(l*v);return new Z(E,A,_,N)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){if(!Zo(t))throw new TypeError("Point#multiply: expected number or bigint");let r=S(BigInt(t),ie.n);if(r===1n)return this;let n=Z.ZERO,i=this;for(;r>0n;)r&1n&&(n=n.add(i)),i=i.double(),r>>=1n;return n}precomputeWindow(t){let r=256/t+1,n=[],i=this,a=i;for(let s=0;s<r;s++){a=i,n.push(a);for(let o=1;o<2**(t-1);o++)a=a.add(i),n.push(a);i=a.double()}return n}wNAF(t,r){!r&&this.equals(Z.BASE)&&(r=re.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Hi.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Z.normalizeZ(i),Hi.set(r,i)));let a=Z.ZERO,s=Z.ZERO,o=256/n+1,u=2**(n-1),f=BigInt(2**n-1),c=2**n,h=BigInt(n);for(let l=0;l<o;l++){let y=l*u,p=Number(t&f);if(t>>=h,p>u&&(p-=c,t+=1n),p===0)s=s.add(l%2?i[y].negate():i[y]);else{let g=i[y+Math.abs(p)-1];a=a.add(p<0?g.negate():g)}}return[a,s]}multiply(t,r){if(!Zo(t))throw new TypeError("Point#multiply: expected number or bigint");let n=S(BigInt(t),ie.n);return Z.normalizeZ(this.wNAF(n,r))[0]}toAffine(t=ji(this.z)){let r=S(this.x*t),n=S(this.y*t);return new re(r,n)}};ne.ExtendedPoint=Z;Z.BASE=new Z(ie.Gx,ie.Gy,1n,S(ie.Gx*ie.Gy));Z.ZERO=new Z(0n,1n,1n,0n);var Hi=new WeakMap,re=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,Hi.delete(this)}static fromHex(t){let{d:r,P:n}=ie,i=t instanceof Uint8Array?t:Rr(t);if(i.length!==32)throw new Error("Point.fromHex: expected 32 bytes");let a=i[31],s=a&~128,o=(a&128)!=0,u=Uint8Array.from(Array.from(i.slice(0,31)).concat(s)),f=Jt(u);if(f>=n)throw new Error("Point.fromHex expects hex <= Fp");let c=S(f*f),h=S(c-1n),l=S(r*c+1n),{isValid:y,value:p}=Yi(h,l);if(!y)throw new Error("Point.fromHex: invalid y coordinate");let g=(p&1n)===1n;return o!==g&&(p=S(-p)),new re(p,f)}static async fromPrivateKey(t){let r=await ne.utils.sha512(ef(t));return re.BASE.multiply(Jo(r))}toRawBytes(){let t=Gi(this.y),r=new Uint8Array(we);for(let i=t.length-2,a=0;a<we&&i>=0;i-=2,a++)r[a]=Number.parseInt(t[i]+t[i+1],16);let n=this.x&1n?128:0;return r[we-1]|=n,r}toHex(){return $o(this.toRawBytes())}toX25519(){return S((1n+this.y)*ji(1n-this.y))}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new re(S(-this.x),this.y)}add(t){return Z.fromAffine(this).add(Z.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return Z.fromAffine(this).multiply(t,this).toAffine()}};ne.Point=re;re.BASE=new re(ie.Gx,ie.Gy);re.ZERO=new re(0n,1n);var Et=class{constructor(t,r){this.r=t,this.s=r}static fromHex(t){t=Qi(t);let r=re.fromHex(t.slice(0,32)),n=Jt(t.slice(32));if(!_p(n))throw new Error("Signature.fromHex expects s <= CURVE.n");return new Et(r,n)}toRawBytes(){let t=Rr(Gi(this.s)).reverse(),r=new Uint8Array(we);r.set(t);let n=new Uint8Array(we*2);return n.set(this.r.toRawBytes()),n.set(r,32),n}toHex(){return $o(this.toRawBytes())}};ne.Signature=Et;ne.SignResult=Et;function Bp(...e){if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let a=e[n];r.set(a,i),i+=a.length}return r}function $o(e){let t="";for(let r=0;r<e.length;r++)t+=e[r].toString(16).padStart(2,"0");return t}function Rr(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2;t[r]=Number.parseInt(e.slice(n,n+2),16)}return t}function Gi(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function Qo(e,t=we){let r=Gi(e).padStart(t*2,"0");return Rr(r).reverse()}function Bt(e){return(S(e)&1n)===1n}function Zo(e){return!!(typeof e=="bigint"&&e>0n||typeof e=="number"&&e>0&&Number.isSafeInteger(e))}function Jt(e){let t=0n;for(let r=0;r<e.length;r++)t+=BigInt(e[r])<<8n*BigInt(r);return t}function Wi(e){return S(Jt(e)&2n**255n-1n)}function S(e,t=ie.P){let r=e%t;return r>=0n?r:t+r}function ji(e,t=ie.P){if(e===0n||t<=0n)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=S(e,t),n=t,[i,a,s,o]=[0n,1n,1n,0n];for(;r!==0n;){let f=n/r,c=n%r,h=i-s*f,l=a-o*f;[n,r]=[r,c],[i,a]=[s,o],[s,o]=[h,l]}if(n!==1n)throw new Error("invert: does not exist");return S(i,t)}function Ap(e,t=ie.P){let r=e.length,n=new Array(r),i=1n;for(let a=0;a<r;a++)e[a]!==0n&&(n[a]=i,i=S(i*e[a],t));i=ji(i,t);for(let a=r-1;a>=0;a--){if(e[a]===0n)continue;let s=S(i*e[a],t);e[a]=S(i*n[a],t),i=s}return e}function Je(e,t){let{P:r}=ie,n=e;for(;t-- >0n;)n*=n,n%=r;return n}function Cp(e){let{P:t}=ie,n=e*e%t*e%t,i=Je(n,2n)*n%t,a=Je(i,1n)*e%t,s=Je(a,5n)*a%t,o=Je(s,10n)*s%t,u=Je(o,20n)*o%t,f=Je(u,40n)*u%t,c=Je(f,80n)*f%t,h=Je(c,80n)*f%t,l=Je(h,10n)*s%t;return Je(l,2n)*e%t}function Yi(e,t){let r=S(t*t*t),n=S(r*r*t),i=S(e*r*Cp(e*n)),a=S(t*i*i),s=i,o=S(i*_r),u=a===e,f=a===S(-e),c=a===S(-e*_r);return u&&(i=s),(f||c)&&(i=o),Bt(i)&&(i=S(-i)),{isValid:u||f,value:i}}function Xo(e){return Yi(1n,e)}async function $i(...e){let t=Bp(...e),r=await ne.utils.sha512(t),n=Jt(r);return S(n,ie.n)}function Tp(e){return e.slice(we)}function Jo(e){let t=we-1,r=e.slice(0,we);return r[0]&=248,r[t]&=127,r[t]|=64,S(Jt(r),ie.n)}function Ip(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Qi(e){return e instanceof Uint8Array?e:Rr(e)}function _p(e){return 0<e&&e<ie.n}function ef(e){let t;if(typeof e=="bigint"||typeof e=="number"&&Number.isSafeInteger(e)){if(t=BigInt(e),t<0n||t>2n**256n)throw new Error("Expected 32 bytes of private key");e=t.toString(16).padStart(we*2,"0")}if(typeof e=="string"){if(e.length!==64)throw new Error("Expected 32 bytes of private key");return Rr(e)}else if(e instanceof Uint8Array){if(e.length!==32)throw new Error("Expected 32 bytes of private key");return e}else throw new TypeError("Expected valid private key")}async function Rp(e){let t=await re.fromPrivateKey(e);return typeof e=="string"?t.toHex():t.toRawBytes()}ne.getPublicKey=Rp;async function Dp(e,t){let r=await ne.utils.sha512(ef(t)),n=Jo(r),i=re.BASE.multiply(n),a=Qi(e),s=await $i(Tp(r),a),o=re.BASE.multiply(s),u=await $i(o.toRawBytes(),i.toRawBytes(),a),f=S(s+u*n,ie.n),c=new Et(o,f);return typeof e=="string"?c.toHex():c.toRawBytes()}ne.sign=Dp;async function kp(e,t,r){t=Qi(t),r instanceof re||(r=re.fromHex(r)),e instanceof Et||(e=Et.fromHex(e));let n=await $i(e.r.toRawBytes(),r.toRawBytes(),t),i=Z.fromAffine(r).multiplyUnsafe(n),a=Z.BASE.multiply(e.s);return Z.fromAffine(e.r).add(i).subtract(a).multiplyUnsafe(8n).equals(Z.ZERO)}ne.verify=kp;re.BASE._setWindowSize(8);var At=(()=>{let e=typeof self=="object"&&"crypto"in self?self.crypto:void 0;return{node:typeof tf!="undefined"&&typeof Fr=="function"&&!e?Qt():void 0,web:e}})();ne.utils={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],randomBytes:(e=32)=>{if(At.web)return At.web.getRandomValues(new Uint8Array(e));if(At.node){let{randomBytes:t}=At.node;return new Uint8Array(t(e).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let e=1024;for(;e--;){let t=ne.utils.randomBytes(32),r=Jt(t);if(r>1n&&r<ie.n)return t}throw new Error("Valid private key was not found in 1024 iterations. PRNG is broken")},sha512:async e=>{if(At.web){let t=await At.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(t)}else{if(At.node)return Uint8Array.from(At.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(e=8,t=re.BASE){let r=t.equals(re.BASE)?t:new re(t.x,t.y);return r._setWindowSize(e),r.multiply(1n),r}}});var af=C(Ct=>{"use strict";var Dr=rf(),Pp=32,Np=64,Pn=32;Ct.publicKeyLength=Pp;Ct.privateKeyLength=Np;Ct.generateKey=async function(){let e=Dr.utils.randomPrivateKey(),t=await Dr.getPublicKey(e);return{privateKey:nf(e,t),publicKey:t}};Ct.generateKeyFromSeed=async function(e){if(e.length!==Pn)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let t=e,r=await Dr.getPublicKey(t);return{privateKey:nf(t,r),publicKey:r}};Ct.hashAndSign=function(e,t){let r=e.slice(0,Pn);return Dr.sign(t,r)};Ct.hashAndVerify=function(e,t,r){return Dr.verify(t,r,e)};function nf(e,t){let r=new Uint8Array(Ct.privateKeyLength);for(let n=0;n<Pn;n++)r[n]=e[n],r[Pn+n]=t[n];return r}});var cf=C((Cy,uf)=>{"use strict";var sf=Te(),{equals:of}=(Br(),Er),{sha256:ff}=(jt(),Dt),{base58btc:Lp}=($r(),Yr),{identity:Kp}=(pi(),tn),ge=af(),Nn=ln(),Up=_n(),Ln=class{constructor(t){this._key=tr(t,ge.publicKeyLength)}async verify(t,r){return ge.hashAndVerify(this._key,r,t)}marshal(){return this._key}get bytes(){return Nn.PublicKey.encode({Type:Nn.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(t){return of(this.bytes,t.bytes)}async hash(){let{bytes:t}=await ff.digest(this.bytes);return t}},er=class{constructor(t,r){this._key=tr(t,ge.privateKeyLength),this._publicKey=tr(r,ge.publicKeyLength)}async sign(t){return ge.hashAndSign(this._key,t)}get public(){return new Ln(this._publicKey)}marshal(){return this._key}get bytes(){return Nn.PrivateKey.encode({Type:Nn.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(t){return of(this.bytes,t.bytes)}async hash(){let{bytes:t}=await ff.digest(this.bytes);return t}async id(){let t=await Kp.digest(this.public.bytes);return Lp.encode(t.bytes).substring(1)}async export(t,r="libp2p-key"){if(r==="libp2p-key")return Up.export(this.bytes,t);throw sf(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function qp(e){if(e.length>ge.privateKeyLength){e=tr(e,ge.privateKeyLength+ge.publicKeyLength);let n=e.slice(0,ge.privateKeyLength),i=e.slice(ge.privateKeyLength,e.length);return new er(n,i)}e=tr(e,ge.privateKeyLength);let t=e.slice(0,ge.privateKeyLength),r=e.slice(ge.publicKeyLength);return new er(t,r)}function Op(e){return e=tr(e,ge.publicKeyLength),new Ln(e)}async function Fp(){let{privateKey:e,publicKey:t}=await ge.generateKey();return new er(e,t)}async function Mp(e){let{privateKey:t,publicKey:r}=await ge.generateKeyFromSeed(e);return new er(t,r)}function tr(e,t){if(e=Uint8Array.from(e||[]),e.length!==t)throw sf(new Error(`Key must be a Uint8Array of length ${t}, got ${e.length}`),"ERR_INVALID_KEY_TYPE");return e}uf.exports={Ed25519PublicKey:Ln,Ed25519PrivateKey:er,unmarshalEd25519PrivateKey:qp,unmarshalEd25519PublicKey:Op,generateKeyPair:Fp,generateKeyPairFromSeed:Mp}});var Af=C((H,Bf)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});H.utils=H.schnorr=H.verify=H.signSync=H.sign=H.getSharedSecret=H.recoverPublicKey=H.getPublicKey=H.SignResult=H.Signature=H.Point=H.CURVE=void 0;var j={a:0n,b:7n,P:2n**256n-2n**32n-977n,n:2n**256n-432420386565659656852420866394968145599n,h:1n,Gx:55066263022277343669578718895168534326250603453777594175500187360389116729240n,Gy:32670510020758816978083085130507043184471273380659243275938904335757337482424n,beta:0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501een};H.CURVE=j;function hf(e){let{a:t,b:r}=j;return D(e**3n+t*e+r)}var Kn=j.a===0n,z=class{constructor(t,r,n){this.x=t,this.y=r,this.z=n}static fromAffine(t){if(!(t instanceof Y))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new z(t.x,t.y,1n)}static toAffineBatch(t){let r=zp(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return z.toAffineBatch(t).map(z.fromAffine)}equals(t){let r=this,n=t,i=D(r.z*r.z),a=D(r.z*i),s=D(n.z*n.z),o=D(n.z*s);return D(r.x*s)===D(i*n.x)&&D(r.y*o)===D(a*n.y)}negate(){return new z(this.x,D(-this.y),this.z)}double(){let t=this.x,r=this.y,n=this.z,i=D(t**2n),a=D(r**2n),s=D(a**2n),o=D(2n*(D(D((t+a)**2n))-i-s)),u=D(3n*i),f=D(u**2n),c=D(f-2n*o),h=D(u*(o-c)-8n*s),l=D(2n*r*n);return new z(c,h,l)}add(t){if(!(t instanceof z))throw new TypeError("JacobianPoint#add: expected JacobianPoint");let r=this.x,n=this.y,i=this.z,a=t.x,s=t.y,o=t.z;if(a===0n||s===0n)return this;if(r===0n||n===0n)return t;let u=D(i**2n),f=D(o**2n),c=D(r*f),h=D(a*u),l=D(n*o*f),y=D(D(s*i)*u),p=D(h-c),g=D(y-l);if(p===0n)return g===0n?this.double():z.ZERO;let v=D(p**2n),b=D(p*v),E=D(c*v),A=D(g**2n-b-2n*E),N=D(g*(E-A)-l*b),_=D(i*o*p);return new z(A,N,_)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){if(!df(t))throw new TypeError("Point#multiply: expected valid scalar");let r=D(BigInt(t),j.n);if(!Kn){let c=z.ZERO,h=this;for(;r>0n;)r&1n&&(c=c.add(h)),h=h.double(),r>>=1n;return c}let[n,i,a,s]=gf(r),o=z.ZERO,u=z.ZERO,f=this;for(;i>0n||s>0n;)i&1n&&(o=o.add(f)),s&1n&&(u=u.add(f)),f=f.double(),i>>=1n,s>>=1n;return n&&(o=o.negate()),a&&(u=u.negate()),u=new z(D(u.x*j.beta),u.y,u.z),o.add(u)}precomputeWindow(t){let r=Kn?128/t+1:256/t+1,n=[],i=this,a=i;for(let s=0;s<r;s++){a=i,n.push(a);for(let o=1;o<2**(t-1);o++)a=a.add(i),n.push(a);i=a.double()}return n}wNAF(t,r){!r&&this.equals(z.BASE)&&(r=Y.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Zi.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=z.normalizeZ(i),Zi.set(r,i)));let a=z.ZERO,s=z.ZERO,o=Kn?128/n+1:256/n+1,u=2**(n-1),f=BigInt(2**n-1),c=2**n,h=BigInt(n);for(let l=0;l<o;l++){let y=l*u,p=Number(t&f);if(t>>=h,p>u&&(p-=c,t+=1n),p===0)s=s.add(l%2?i[y].negate():i[y]);else{let g=i[y+Math.abs(p)-1];a=a.add(p<0?g.negate():g)}}return[a,s]}multiply(t,r){if(!df(t))throw new TypeError("Point#multiply: expected valid scalar");let n=D(BigInt(t),j.n),i,a;if(Kn){let[s,o,u,f]=gf(n),c,h,l,y;[c,l]=this.wNAF(o,r),[h,y]=this.wNAF(f,r),s&&(c=c.negate()),u&&(h=h.negate()),h=new z(D(h.x*j.beta),h.y,h.z),[i,a]=[c.add(h),l.add(y)]}else[i,a]=this.wNAF(n,r);return z.normalizeZ([i,a])[0]}toAffine(t=Nr(this.z)){let r=t**2n,n=D(this.x*r),i=D(this.y*r*t);return new Y(n,i)}};z.BASE=new z(j.Gx,j.Gy,1n);z.ZERO=new z(0n,1n,0n);var Zi=new WeakMap,Y=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,Zi.delete(this)}static fromCompressedHex(t){let r=t.length===32,n=Pe(r?t:t.slice(1)),i=hf(n),a=Vp(i),s=(a&1n)===1n;r?s&&(a=D(-a)):(t[0]&1)==1!==s&&(a=D(-a));let o=new Y(n,a);return o.assertValidity(),o}static fromUncompressedHex(t){let r=Pe(t.slice(1,33)),n=Pe(t.slice(33)),i=new Y(r,n);return i.assertValidity(),i}static fromHex(t){let r=On(t),n=r[0];if(r.length===32||r.length===33&&(n===2||n===3))return this.fromCompressedHex(r);if(r.length===65&&n===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${r.length}`)}static fromPrivateKey(t){return Y.BASE.multiply(rr(t))}static fromSignature(t,r,n){let i=t instanceof Uint8Array?Pe(t):ft(t),a=mf(r),{r:s,s:o}=a;if(n!==0&&n!==1)throw new Error("Cannot recover signature: invalid yParity bit");let u=2+(n&1),f=Y.fromHex(`0${u}${Tt(s)}`),c=z.fromAffine(f).multiplyUnsafe(o),h=z.BASE.multiply(i),l=Nr(s,j.n),p=c.subtract(h).multiplyUnsafe(l).toAffine();return p.assertValidity(),p}toRawBytes(t=!1){return It(this.toHex(t))}toHex(t=!1){let r=Tt(this.x);return t?`${this.y&1n?"03":"02"}${r}`:`04${r}${Tt(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let t="Point is not on elliptic curve",{P:r}=j,{x:n,y:i}=this;if(n===0n||i===0n||n>=r||i>=r)throw new Error(t);let a=D(i*i),s=hf(n);if((a-s)%r!==0n)throw new Error(t)}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new Y(this.x,D(-this.y))}double(){return z.fromAffine(this).double().toAffine()}add(t){return z.fromAffine(this).add(z.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return z.fromAffine(this).multiply(t,this).toAffine()}};H.Point=Y;Y.BASE=new Y(j.Gx,j.Gy);Y.ZERO=new Y(0n,0n);function lf(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}var ot=class{constructor(t,r){this.r=t,this.s=r}static fromCompact(t){if(typeof t!="string"&&!(t instanceof Uint8Array))throw new TypeError("Signature.fromCompact: Expected string or Uint8Array");let r=t instanceof Uint8Array?Un(t):t;if(r.length!==128)throw new Error("Signature.fromCompact: Expected 64-byte hex");let n=new ot(ft(r.slice(0,64)),ft(r.slice(64,128)));return n.assertValidity(),n}static fromDER(t){let r="Signature.fromDER";if(typeof t!="string"&&!(t instanceof Uint8Array))throw new TypeError(`${r}: Expected string or Uint8Array`);let n=t instanceof Uint8Array?Un(t):t,i=Pr(n.slice(2,4));if(n.slice(0,2)!=="30"||i!==n.length-4||n.slice(4,6)!=="02")throw new Error(`${r}: Invalid signature ${n}`);let a=Pr(n.slice(6,8)),s=8+a,o=n.slice(8,s);if(o.startsWith("00")&&Pr(o.slice(2,4))<=127)throw new Error(`${r}: Invalid r with trailing length`);let u=ft(o);if(n.slice(s,s+2)!=="02")throw new Error(`${r}: Invalid r-s separator`);let c=Pr(n.slice(s+2,s+4)),h=i-c-a-10;if(h>0||h===-4)throw new Error(`${r}: Invalid total length`);if(c>i-a-4)throw new Error(`${r}: Invalid s`);let l=s+4,y=n.slice(l,l+c);if(y.startsWith("00")&&Pr(y.slice(2,4))<=127)throw new Error(`${r}: Invalid s with trailing length`);let p=ft(y),g=new ot(u,p);return g.assertValidity(),g}static fromHex(t){return this.fromDER(t)}assertValidity(){let{r:t,s:r}=this;if(!Lr(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Lr(r))throw new Error("Invalid Signature: s must be 0 < s < n")}toDERRawBytes(t=!1){return It(this.toDERHex(t))}toDERHex(t=!1){let r=lf(kr(this.s));if(t)return r;let n=lf(kr(this.r)),i=kr(n.length/2),a=kr(r.length/2);return`30${kr(n.length/2+r.length/2+4)}02${i}${n}02${a}${r}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return It(this.toCompactHex())}toCompactHex(){return Tt(this.r)+Tt(this.s)}};H.Signature=ot;H.SignResult=ot;function pf(...e){if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let a=e[n];r.set(a,i),i+=a.length}return r}function Un(e){let t="";for(let r=0;r<e.length;r++)t+=e[r].toString(16).padStart(2,"0");return t}function Tt(e){return e.toString(16).padStart(64,"0")}function qn(e){return It(Tt(e))}function kr(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function ft(e){if(typeof e!="string")throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function It(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2;t[r]=Number.parseInt(e.slice(n,n+2),16)}return t}function On(e){return e instanceof Uint8Array?e:It(e)}function Pe(e){return ft(Un(e))}function Pr(e){return Number.parseInt(e,16)*2}function df(e){return!!(typeof e=="bigint"&&e>0n||typeof e=="number"&&e>0&&Number.isSafeInteger(e))}function D(e,t=j.P){let r=e%t;return r>=0?r:t+r}function Ne(e,t){let{P:r}=j,n=e;for(;t-- >0n;)n*=n,n%=r;return n}function Vp(e){let{P:t}=j,r=e*e*e%t,n=r*r*e%t,i=Ne(n,3n)*n%t,a=Ne(i,3n)*n%t,s=Ne(a,2n)*r%t,o=Ne(s,11n)*s%t,u=Ne(o,22n)*o%t,f=Ne(u,44n)*u%t,c=Ne(f,88n)*f%t,h=Ne(c,44n)*u%t,l=Ne(h,3n)*n%t,y=Ne(l,23n)*o%t,p=Ne(y,6n)*r%t;return Ne(p,2n)}function Nr(e,t=j.P){if(e===0n||t<=0n)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=D(e,t),n=t,[i,a,s,o]=[0n,1n,1n,0n];for(;r!==0n;){let f=n/r,c=n%r,h=i-s*f,l=a-o*f;[n,r]=[r,c],[i,a]=[s,o],[s,o]=[h,l]}if(n!==1n)throw new Error("invert: does not exist");return D(i,t)}function zp(e,t=j.P){let r=e.length,n=new Array(r),i=1n;for(let a=0;a<r;a++)e[a]!==0n&&(n[a]=i,i=D(i*e[a],t));i=Nr(i,t);for(let a=r-1;a>=0;a--){if(e[a]===0n)continue;let s=D(i*e[a],t);e[a]=D(i*n[a],t),i=s}return e}var yf=(e,t)=>(e+t/2n)/t,Fn=2n**128n;function gf(e){let{n:t}=j,r=0x3086d221a7d46bcde86c90e49284eb15n,n=-0xe4437ed6010e88286f547fa90abfe4c3n,i=0x114ca50f7a8e2f3f657c1108d9d44cfd8n,a=r,s=yf(a*e,t),o=yf(-n*e,t),u=D(e-s*r-o*i,t),f=D(-s*n-o*a,t),c=u>Fn,h=f>Fn;if(c&&(u=t-u),h&&(f=t-f),u>Fn||f>Fn)throw new Error("splitScalarEndo: Endomorphism failed");return[c,u,h,f]}function Hp(e){typeof e!="string"&&(e=Un(e));let t=ft(e||"0"),n=e.length/2*8-256;return n>0&&(t=t>>BigInt(n)),t>=j.n&&(t-=j.n),t}function xf(e,t){if(e==null)throw new Error(`sign: expected valid msgHash, not "${e}"`);let r=typeof e=="string"?ft(e):Pe(e),n=qn(r),i=Pe(n),a=qn(t),s=new Uint8Array(32).fill(1),o=new Uint8Array(32).fill(0),u=Uint8Array.from([0]),f=Uint8Array.from([1]);return[n,i,a,s,o,u,f]}async function Gp(e,t){let r=rr(t),[n,i,a,s,o,u,f]=xf(e,r),c=H.utils.hmacSha256;o=await c(o,s,u,a,n),s=await c(o,s),o=await c(o,s,f,a,n),s=await c(o,s);for(let h=0;h<1e3;h++){s=await c(o,s);let l=vf(s,i,r);if(l)return l;o=await c(o,s,u),s=await c(o,s)}throw new TypeError("secp256k1: Tried 1,000 k values for sign(), all were invalid")}function Wp(e,t){let r=rr(t),[n,i,a,s,o,u,f]=xf(e,r),c=H.utils.hmacSha256Sync;if(!c)throw new Error("utils.hmacSha256Sync is undefined, you need to set it");if(o=c(o,s,u,a,n),o instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");s=c(o,s),o=c(o,s,f,a,n),s=c(o,s);for(let h=0;h<1e3;h++){s=c(o,s);let l=vf(s,i,r);if(l)return l;o=c(o,s,u),s=c(o,s)}throw new TypeError("secp256k1: Tried 1,000 k values for sign(), all were invalid")}function Lr(e){return 0<e&&e<j.n}function vf(e,t,r){let n=Pe(e);if(!Lr(n))return;let i=j.n,a=Y.BASE.multiply(n),s=D(a.x,i),o=D(Nr(n,i)*(t+s*r),i);if(!(s===0n||o===0n))return[a,s,o]}function rr(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if(typeof e=="string"){if(e.length!==64)throw new Error("Expected 32 bytes of private key");t=ft(e)}else if(e instanceof Uint8Array){if(e.length!==32)throw new Error("Expected 32 bytes of private key");t=Pe(e)}else throw new TypeError("Expected valid private key");if(!Lr(t))throw new Error("Expected private key: 0 < key < n");return t}function Xi(e){return e instanceof Y?(e.assertValidity(),e):Y.fromHex(e)}function mf(e){return e instanceof ot?(e.assertValidity(),e):ot.fromDER(e)}function jp(e,t=!1){let r=Y.fromPrivateKey(e);return typeof e=="string"?r.toHex(t):r.toRawBytes(t)}H.getPublicKey=jp;function Yp(e,t,r){let n=Y.fromSignature(e,t,r);return typeof e=="string"?n.toHex():n.toRawBytes()}H.recoverPublicKey=Yp;function bf(e){let t=e instanceof Uint8Array,r=typeof e=="string",n=(t||r)&&e.length;return t?n===33||n===65:r?n===66||n===130:e instanceof Y}function $p(e,t,r=!1){if(bf(e))throw new TypeError("getSharedSecret: first arg must be private key");if(!bf(t))throw new TypeError("getSharedSecret: second arg must be public key");let n=Xi(t);n.assertValidity();let i=n.multiply(rr(e));return typeof e=="string"?i.toHex(r):i.toRawBytes(r)}H.getSharedSecret=$p;function wf(e,t,r=!1){let[n,i,a]=e,{canonical:s,der:o,recovered:u}=t,f=(n.x===i?0:2)|Number(n.y&1n),c=a,h=j.n>>1n;a>h&&s&&(c=j.n-a,f^=1);let l=new ot(i,c);l.assertValidity();let y=o===!1?l.toCompactHex():l.toDERHex(),p=r?y:It(y);return u?[p,f]:p}async function Qp(e,t,r={}){return wf(await Gp(e,t),r,typeof e=="string")}H.sign=Qp;function Zp(e,t,r={}){return wf(Wp(e,t),r,typeof e=="string")}H.signSync=Zp;function Xp(e,t,r){let{n}=j,i;try{i=mf(e)}catch(v){return!1}let{r:a,s}=i,o=Hp(t);if(o===0n)return!1;let u=z.fromAffine(Xi(r)),f=Nr(s,n),c=D(o*f,n),h=D(a*f,n),l=z.BASE.multiply(c),y=u.multiplyUnsafe(h),p=l.add(y).toAffine();return D(p.x,n)===a}H.verify=Xp;async function Ji(e,...t){let r=new Uint8Array(e.split("").map(a=>a.charCodeAt(0))),n=await H.utils.sha256(r),i=await H.utils.sha256(pf(n,n,...t));return Pe(i)}async function Sf(e,t,r){let n=qn(e),i=await Ji("BIP0340/challenge",n,t.toRawX(),r);return D(i,j.n)}function ea(e){return D(e.y,2n)===0n}var Ft=class{constructor(t,r){if(this.r=t,this.s=r,t<=0n||r<=0n||t>=j.P||r>=j.n)throw new Error("Invalid signature")}static fromHex(t){let r=On(t);if(r.length!==64)throw new TypeError(`SchnorrSignature.fromHex: expected 64 bytes, not ${r.length}`);let n=Pe(r.slice(0,32)),i=Pe(r.slice(32));return new Ft(n,i)}toHex(){return Tt(this.r)+Tt(this.s)}toRawBytes(){return It(this.toHex())}};function Jp(e){let t=Y.fromPrivateKey(e);return typeof e=="string"?t.toHexX():t.toRawX()}async function ed(e,t,r=H.utils.randomBytes()){if(e==null)throw new TypeError(`sign: Expected valid message, not "${e}"`);t||(t=0n);let{n}=j,i=On(e),a=rr(t),s=On(r);if(s.length!==32)throw new TypeError("sign: Expected 32 bytes of aux randomness");let o=Y.fromPrivateKey(a),u=ea(o)?a:n-a,f=await Ji("BIP0340/aux",s),c=u^f,h=await Ji("BIP0340/nonce",qn(c),o.toRawX(),i),l=D(h,n);if(l===0n)throw new Error("sign: Creation of signature failed. k is zero");let y=Y.fromPrivateKey(l),p=ea(y)?l:n-l,g=await Sf(y.x,o,i),v=new Ft(y.x,D(p+g*u,n));if(!await Ef(v.toRawBytes(),i,o.toRawX()))throw new Error("sign: Invalid signature produced");return typeof e=="string"?v.toHex():v.toRawBytes()}async function Ef(e,t,r){let n=e instanceof Ft?e:Ft.fromHex(e),i=typeof t=="string"?It(t):t,a=Xi(r),s=await Sf(n.r,a,i),o=Y.fromPrivateKey(n.s),u=a.multiply(s),f=o.subtract(u);return!(f.equals(Y.BASE)||!ea(f)||f.x!==n.r)}H.schnorr={Signature:Ft,getPublicKey:Jp,sign:ed,verify:Ef};Y.BASE._setWindowSize(8);var Ce=(()=>{let e=typeof self=="object"&&"crypto"in self?self.crypto:void 0;return{node:typeof Bf!="undefined"&&typeof Fr=="function"&&!e?Qt():void 0,web:e}})();H.utils={isValidPrivateKey(e){try{return rr(e),!0}catch(t){return!1}},randomBytes:(e=32)=>{if(Ce.web)return Ce.web.getRandomValues(new Uint8Array(e));if(Ce.node){let{randomBytes:t}=Ce.node;return new Uint8Array(t(e).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let e=8;for(;e--;){let t=H.utils.randomBytes(32),r=Pe(t);if(Lr(r)&&r!==1n)return t}throw new Error("Valid private key was not found in 8 iterations. PRNG is broken")},sha256:async e=>{if(Ce.web){let t=await Ce.web.subtle.digest("SHA-256",e.buffer);return new Uint8Array(t)}else if(Ce.node){let{createHash:t}=Ce.node;return Uint8Array.from(t("sha256").update(e).digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(Ce.web){let r=await Ce.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=pf(...t),i=await Ce.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(Ce.node){let{createHmac:r}=Ce.node,n=r("sha256",e);for(let i of t)n.update(i);return Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,precompute(e=8,t=Y.BASE){let r=t===Y.BASE?t:new Y(t.x,t.y);return r._setWindowSize(e),r.multiply(3n),r}}});var If=C((Ty,Tf)=>{"use strict";var Kr=Te(),_t=Af(),{sha256:Cf}=(jt(),Dt);Tf.exports=()=>{let e=32;function t(){return _t.utils.randomPrivateKey()}async function r(f,c){let{digest:h}=await Cf.digest(c);try{return await _t.sign(h,f)}catch(l){throw Kr(l,"ERR_INVALID_INPUT")}}async function n(f,c,h){try{let{digest:l}=await Cf.digest(h);return _t.verify(c,l,f)}catch(l){throw Kr(l,"ERR_INVALID_INPUT")}}function i(f){return _t.Point.fromHex(f).toRawBytes(!0)}function a(f){return _t.Point.fromHex(f).toRawBytes(!1)}function s(f){try{_t.getPublicKey(f,!0)}catch(c){throw Kr(c,"ERR_INVALID_PRIVATE_KEY")}}function o(f){try{_t.Point.fromHex(f)}catch(c){throw Kr(c,"ERR_INVALID_PUBLIC_KEY")}}function u(f){try{return _t.getPublicKey(f,!0)}catch(c){throw Kr(c,"ERR_INVALID_PRIVATE_KEY")}}return{generateKey:t,privateKeyLength:e,hashAndSign:r,hashAndVerify:n,compressPublicKey:i,decompressPublicKey:a,validatePrivateKey:s,validatePublicKey:o,computePublicKey:u}}});var kf=C((Iy,Df)=>{"use strict";var{sha256:_f}=(jt(),Dt),td=Te(),{equals:Rf}=(Br(),Er),{toString:rd}=(dt(),pt),nd=_n();Df.exports=(e,t,r)=>{r=r||If()();class n{constructor(f){r.validatePublicKey(f),this._key=f}verify(f,c){return r.hashAndVerify(this._key,c,f)}marshal(){return r.compressPublicKey(this._key)}get bytes(){return e.PublicKey.encode({Type:e.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(f){return Rf(this.bytes,f.bytes)}async hash(){let{bytes:f}=await _f.digest(this.bytes);return f}}class i{constructor(f,c){this._key=f,this._publicKey=c||r.computePublicKey(f),r.validatePrivateKey(this._key),r.validatePublicKey(this._publicKey)}sign(f){return r.hashAndSign(this._key,f)}get public(){return new n(this._publicKey)}marshal(){return this._key}get bytes(){return e.PrivateKey.encode({Type:e.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(f){return Rf(this.bytes,f.bytes)}async hash(){let{bytes:f}=await _f.digest(this.bytes);return f}async id(){let f=await this.public.hash();return rd(f,"base58btc")}async export(f,c="libp2p-key"){if(c==="libp2p-key")return nd.export(this.bytes,f);throw td(new Error(`export format '${c}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function a(u){return new i(u)}function s(u){return new n(u)}async function o(){let u=await r.generateKey();return new i(u)}return{Secp256k1PublicKey:n,Secp256k1PrivateKey:i,unmarshalSecp256k1PrivateKey:a,unmarshalSecp256k1PublicKey:s,generateKeyPair:o}}});var Uf=C((_y,Kf)=>{"use strict";var Pf=Te(),{concat:Nf}=(Sr(),wr),{fromString:id}=(gt(),yt),ad=Wn(),Lf={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};Kf.exports=async(e,t,r)=>{let n=Lf[e];if(!n){let E=Object.keys(Lf).join(" / ");throw Pf(new Error(`unknown cipher type '${e}'. Must be ${E}`),"ERR_INVALID_CIPHER_TYPE")}if(!t)throw Pf(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let i=n.keySize,a=n.ivSize,s=20,o=id("key expansion"),u=2*(a+i+s),f=await ad.create(t,r),c=await f.digest(o),h=[],l=0;for(;l<u;){let E=await f.digest(Nf([c,o])),A=E.length;l+A>u&&(A=u-l),h.push(E),l+=A,c=await f.digest(c)}let y=u/2,p=Nf(h),g=p.slice(0,y),v=p.slice(y,u),b=E=>({iv:E.slice(0,a),cipherKey:E.slice(a,a+i),macKey:E.slice(a+i)});return{k1:b(g),k2:b(v)}}});var Of=C((Ry,qf)=>{"use strict";var sd=Te();qf.exports=function(e,t){if(!e.includes(t)){let r=e.join(" / ");throw sd(new Error(`Unknown curve: ${t}. Must be ${r}`),"ERR_INVALID_CURVE")}}});var Gf=C(Hf=>{"use strict";var od=Te(),Ur=ar(),{base64urlToBuffer:Ff}=In(),fd=Of(),{toString:ta}=(dt(),pt),{concat:ud}=(Sr(),wr),{equals:cd}=(Br(),Er),Mf={"P-256":256,"P-384":384,"P-521":521};Hf.generateEphmeralKeyPair=async function(e){fd(Object.keys(Mf),e);let t=await Ur.get().subtle.generateKey({name:"ECDH",namedCurve:e},!0,["deriveBits"]),r=async(i,a)=>{let s;a?s=await Ur.get().subtle.importKey("jwk",ld(e,a),{name:"ECDH",namedCurve:e},!1,["deriveBits"]):s=t.privateKey;let o=[await Ur.get().subtle.importKey("jwk",zf(e,i),{name:"ECDH",namedCurve:e},!1,[]),s],u=await Ur.get().subtle.deriveBits({name:"ECDH",namedCurve:e,public:o[0]},o[1],Mf[e]);return new Uint8Array(u,u.byteOffset,u.byteLength)},n=await Ur.get().subtle.exportKey("jwk",t.publicKey);return{key:hd(n),genSharedKey:r}};var Vf={"P-256":32,"P-384":48,"P-521":66};function hd(e){let t=Vf[e.crv];return ud([Uint8Array.from([4]),Ff(e.x,t),Ff(e.y,t)],1+t*2)}function zf(e,t){let r=Vf[e];if(cd(!t.slice(0,1),Uint8Array.from([4])))throw od(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:e,x:ta(t.slice(1,r+1),"base64url"),y:ta(t.slice(1+r),"base64url"),ext:!0}}var ld=(e,t)=>({...zf(e,t.public),d:ta(t.private,"base64url")})});var jf=C((ky,Wf)=>{"use strict";var pd=Gf();Wf.exports=async e=>pd.generateEphmeralKeyPair(e)});var Qf=C((Py,$f)=>{"use strict";var et=ln();vr();vo();var ra=$(),qr=Te(),{fromString:dd}=(gt(),yt),yd=So(),Le={rsa:Yo(),ed25519:cf(),secp256k1:kf()(et,Tn())},Mn={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function nr(e){let t=Le[e.toLowerCase()];if(!t){let r=Object.keys(Le).join(" / ");throw qr(new Error(`invalid or unsupported key type ${e}. Must be ${r}`),"ERR_UNSUPPORTED_KEY_TYPE")}return t}var gd=async(e,t)=>nr(e).generateKeyPair(t),xd=async(e,t,r)=>{let n=nr(e);if(e.toLowerCase()!=="ed25519")throw qr(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return n.generateKeyPairFromSeed(t,r)},vd=e=>{let t=et.PublicKey.decode(e),r=t.Data;switch(t.Type){case et.KeyType.RSA:return Le.rsa.unmarshalRsaPublicKey(r);case et.KeyType.Ed25519:return Le.ed25519.unmarshalEd25519PublicKey(r);case et.KeyType.Secp256k1:if(Le.secp256k1)return Le.secp256k1.unmarshalSecp256k1PublicKey(r);throw qr(new Error(Mn.message),Mn.code);default:nr(t.Type)}},md=(e,t)=>(t=(t||"rsa").toLowerCase(),nr(t),e.bytes),Yf=async e=>{let t=et.PrivateKey.decode(e),r=t.Data;switch(t.Type){case et.KeyType.RSA:return Le.rsa.unmarshalRsaPrivateKey(r);case et.KeyType.Ed25519:return Le.ed25519.unmarshalEd25519PrivateKey(r);case et.KeyType.Secp256k1:if(Le.secp256k1)return Le.secp256k1.unmarshalSecp256k1PrivateKey(r);throw qr(new Error(Mn.message),Mn.code);default:nr(t.Type)}},bd=(e,t)=>(t=(t||"rsa").toLowerCase(),nr(t),e.bytes),wd=async(e,t)=>{try{let i=await yd.import(e,t);return Yf(i)}catch(i){}let r=ra.pki.decryptRsaPrivateKey(e,t);if(r===null)throw qr(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let n=ra.asn1.toDer(ra.pki.privateKeyToAsn1(r));return n=dd(n.getBytes(),"ascii"),Le.rsa.unmarshalRsaPrivateKey(n)};$f.exports={supportedKeys:Le,keysPBM:et,keyStretcher:Uf(),generateEphemeralKeyPair:jf(),generateKeyPair:gd,generateKeyPairFromSeed:xd,unmarshalPublicKey:vd,marshalPublicKey:md,unmarshalPrivateKey:Yf,marshalPrivateKey:bd,import:wd}});var Jf=C((Ny,Xf)=>{"use strict";var Sd=Di(),Ed=se(),Bd=Te(),Zf={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function Ad(e,t,r,n,i){let a=Zf[i];if(!a){let o=Object.keys(Zf).join(" / ");throw Bd(new Error(`Hash '${i}' is unknown or not supported. Must be ${o}`),"ERR_UNSUPPORTED_HASH_TYPE")}let s=Sd(e,t,r,n,a);return Ed.encode64(s)}Xf.exports=Ad});var _d=C(ir=>{"use strict";var Cd=Wn(),Td=xs(),Id=Qf();ir.aes=Td;ir.hmac=Cd;ir.keys=Id;ir.randomBytes=Tn();ir.pbkdf2=Jf()});return _d();})();
/*! noble-ed25519 - MIT License (c) Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) Paul Miller (paulmillr.com) */
return Libp2pCrypto}));
